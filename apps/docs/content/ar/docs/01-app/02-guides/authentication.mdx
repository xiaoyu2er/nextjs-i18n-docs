---
source-updated-at: 2025-06-08T05:18:05.000Z
translation-updated-at: 2025-06-08T22:19:26.550Z
title: ÙƒÙŠÙÙŠØ© ØªÙ†ÙÙŠØ° Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙÙŠ Next.js
nav_title: Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
description: ØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© ØªÙ†ÙÙŠØ° Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Next.js Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.
---

ÙÙ‡Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø£Ù…Ø± Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ù‡Ù…ÙŠØ© Ù„Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ·Ø¨ÙŠÙ‚Ùƒ. Ø³ÙŠØ±Ø´Ø¯Ùƒ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø¥Ù„Ù‰ Ù…ÙŠØ²Ø§Øª React ÙˆNext.js Ø§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©.

Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡ØŒ Ù…Ù† Ø§Ù„Ù…ÙÙŠØ¯ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¥Ù„Ù‰ Ø«Ù„Ø§Ø«Ø© Ù…ÙØ§Ù‡ÙŠÙ…:

1. **[Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©](#authentication)**: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ùˆ Ù…Ù† ÙŠØ¯Ø¹ÙŠ Ø£Ù†Ù‡ Ù‡Ùˆ. ÙŠØªØ·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø«Ø¨Ø§Øª Ù‡ÙˆÙŠØªÙ‡ Ø¨Ø´ÙŠØ¡ ÙŠÙ…ØªÙ„ÙƒÙ‡ØŒ Ù…Ø«Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.
2. **[Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø©](#session-management)**: ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø¨Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª.
3. **[Ø§Ù„ØªØ±Ø®ÙŠØµ](#authorization)**: ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§.

ÙŠØ¸Ù‡Ø± Ù‡Ø°Ø§ Ø§Ù„Ø±Ø³Ù… Ø§Ù„ØªØ®Ø·ÙŠØ·ÙŠ ØªØ¯ÙÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙŠØ²Ø§Øª React ÙˆNext.js:

<Image
  alt="Ø±Ø³Ù… ØªØ®Ø·ÙŠØ·ÙŠ ÙŠØ¸Ù‡Ø± ØªØ¯ÙÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ù…ÙŠØ²Ø§Øª React ÙˆNext.js"
  srcLight="/docs/light/authentication-overview.png"
  srcDark="/docs/dark/authentication-overview.png"
  width="1600"
  height="1383"
/>

ØªÙ‚Ø¯Ù… Ø§Ù„Ø£Ù…Ø«Ù„Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø´Ø±Ø­Ù‹Ø§ Ø£Ø³Ø§Ø³ÙŠÙ‹Ø§ Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø£ØºØ±Ø§Ø¶ ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ø¨ÙŠÙ†Ù…Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†ÙÙŠØ° Ø­Ù„ Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ø®ØµØµØŒ Ù†ÙˆØµÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© Ù…ØµØ§Ø¯Ù‚Ø© Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø¨Ø³Ø§Ø·Ø©. ØªÙˆÙØ± Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø­Ù„ÙˆÙ„Ù‹Ø§ Ù…Ø¯Ù…Ø¬Ø© Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª ÙˆØ§Ù„ØªØ±Ø®ÙŠØµØŒ Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ø«Ù„ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© ÙˆØ§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ ÙˆØ§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ù‚Ø³Ù… [Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©](#auth-libraries).

## Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

<AppOnly>

### ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„

ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ù†ØµØ± [`<form>`](https://react.dev/reference/react-dom/components/form) Ù…Ø¹ [Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) ÙÙŠ React Ùˆ`useActionState` Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø£Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø²ÙˆØ¯ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©.

Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù… ØªÙ†ÙØ° Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ ÙØ¥Ù†Ù‡Ø§ ØªÙˆÙØ± Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©.

Ø¥Ù„ÙŠÙƒ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ù„ØªÙ†ÙÙŠØ° ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„/ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:

#### 1. Ø§Ù„ØªÙ‚Ø§Ø· Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

Ù„Ù„ØªÙ‚Ø§Ø· Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ø£Ù†Ø´Ø¦ Ù†Ù…ÙˆØ°Ø¬Ù‹Ø§ ÙŠØ³ØªØ¯Ø¹ÙŠ Ø¥Ø¬Ø±Ø§Ø¡ Ø®Ø§Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ ÙŠÙ‚Ø¨Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:

```tsx filename="app/ui/signup-form.tsx" switcher
import { signup } from '@/app/actions/auth'

export function SignupForm() {
  return (
    <form action={signup}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="Name" />
      </div>
      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" type="email" placeholder="Email" />
      </div>
      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      <button type="submit">Sign Up</button>
    </form>
  )
}
```

```jsx filename="app/ui/signup-form.js" switcher
import { signup } from '@/app/actions/auth'

export function SignupForm() {
  return (
    <form action={signup}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="Name" />
      </div>
      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" type="email" placeholder="Email" />
      </div>
      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      <button type="submit">Sign Up</button>
    </form>
  )
}
```

```tsx filename="app/actions/auth.ts" switcher
export async function signup(formData: FormData) {}
```

```jsx filename="app/actions/auth.js" switcher
export async function signup(formData) {}
```

#### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…

Ø§Ø³ØªØ®Ø¯Ù… Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…. Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø²ÙˆØ¯ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù„Ø§ ÙŠÙˆÙØ± Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø®Ø·Ø· Ù…Ø«Ù„ [Zod](https://zod.dev/) Ø£Ùˆ [Yup](https://github.com/jquense/yup).

Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Zod ÙƒÙ…Ø«Ø§Ù„ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø¯ÙŠØ¯ Ù…Ø®Ø·Ø· Ù†Ù…ÙˆØ°Ø¬ Ù…Ø¹ Ø±Ø³Ø§Ø¦Ù„ Ø®Ø·Ø£ Ù…Ù†Ø§Ø³Ø¨Ø©:

```ts filename="app/lib/definitions.ts" switcher
import { z } from 'zod'

export const SignupFormSchema = z.object({
  name: z
    .string()
    .min(2, { message: 'Name must be at least 2 characters long.' })
    .trim(),
  email: z.string().email({ message: 'Please enter a valid email.' }).trim(),
  password: z
    .string()
    .min(8, { message: 'Be at least 8 characters long' })
    .regex(/[a-zA-Z]/, { message: 'Contain at least one letter.' })
    .regex(/[0-9]/, { message: 'Contain at least one number.' })
    .regex(/[^a-zA-Z0-9]/, {
      message: 'Contain at least one special character.',
    })
    .trim(),
})

export type FormState =
  | {
      errors?: {
        name?: string[]
        email?: string[]
        password?: string[]
      }
      message?: string
    }
  | undefined
```

```js filename="app/lib/definitions.js" switcher
import { z } from 'zod'

export const SignupFormSchema = z.object({
  name: z
    .string()
    .min(2, { message: 'Name must be at least 2 characters long.' })
    .trim(),
  email: z.string().email({ message: 'Please enter a valid email.' }).trim(),
  password: z
    .string()
    .min(8, { message: 'Be at least 8 characters long' })
    .regex(/[a-zA-Z]/, { message: 'Contain at least one letter.' })
    .regex(/[0-9]/, { message: 'Contain at least one number.' })
    .regex(/[^a-zA-Z0-9]/, {
      message: 'Contain at least one special character.',
    })
    .trim(),
})
```

Ù„Ù…Ù†Ø¹ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª ØºÙŠØ± Ø¶Ø±ÙˆØ±ÙŠØ© Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø£Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø²ÙˆØ¯ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ `Ø¥Ø±Ø¬Ø§Ø¹` Ù…Ø¨ÙƒØ±Ù‹Ø§ ÙÙŠ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø®Ø§Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø£ÙŠ Ø­Ù‚ÙˆÙ„ Ù†Ù…ÙˆØ°Ø¬ Ù„Ø§ ØªØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ù…Ø­Ø¯Ø¯.

```ts filename="app/actions/auth.ts" switcher
import { SignupFormSchema, FormState } from '@/app/lib/definitions'

export async function signup(state: FormState, formData: FormData) {
  // Validate form fields
  const validatedFields = SignupFormSchema.safeParse({
    name: formData.get('name'),
    email: formData.get('email'),
    password: formData.get('password'),
  })

  // If any form fields are invalid, return early
  if (!validatedFields.success) {
    return {
      errors: validatedFields.error.flatten().fieldErrors,
    }
  }

  // Call the provider or db to create a user...
}
```

```js filename="app/actions/auth.js" switcher
import { SignupFormSchema } from '@/app/lib/definitions'

export async function signup(state, formData) {
  // Validate form fields
  const validatedFields = SignupFormSchema.safeParse({
    name: formData.get('name'),
    email: formData.get('email'),
    password: formData.get('password'),
  })

  // If any form fields are invalid, return early
  if (!validatedFields.success) {
    return {
      errors: validatedFields.error.flatten().fieldErrors,
    }
  }

  // Call the provider or db to create a user...
}
```

ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ `<SignupForm />` Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø·Ø§Ù `useActionState` ÙÙŠ React Ù„Ø¹Ø±Ø¶ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:

```tsx filename="app/ui/signup-form.tsx" switcher highlight={7,15,21,27-36}
'use client'

import { signup } from '@/app/actions/auth'
import { useActionState } from 'react'

export default function SignupForm() {
  const [state, action, pending] = useActionState(signup, undefined)

  return (
    <form action={action}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="Name" />
      </div>
      {state?.errors?.name && <p>{state.errors.name}</p>}

      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" placeholder="Email" />
      </div>
      {state?.errors?.email && <p>{state.errors.email}</p>}

      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      {state?.errors?.password && (
        <div>
          <p>Password must:</p>
          <ul>
            {state.errors.password.map((error) => (
              <li key={error}>- {error}</li>
            ))}
          </ul>
        </div>
      )}
      <button disabled={pending} type="submit">
        Sign Up
      </button>
    </form>
  )
}
```

```jsx filename="app/ui/signup-form.js" switcher highlight={7,15,21,27-36}
'use client'

import { signup } from '@/app/actions/auth'
import { useActionState } from 'react'

export default function SignupForm() {
  const [state, action, pending] = useActionState(signup, undefined)

  return (
    <form action={action}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="Name" />
      </div>
      {state?.errors?.name && <p>{state.errors.name}</p>}

      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" placeholder="Email" />
      </div>
      {state?.errors?.email && <p>{state.errors.email}</p>}

      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      {state?.errors?.password && (
        <div>
          <p>Password must:</p>
          <ul>
            {state.errors.password.map((error) => (
              <li key={error}>- {error}</li>
            ))}
          </ul>
        </div>
      )}
      <button disabled={pending} type="submit">
        Sign Up
      </button>
    </form>
  )
}
```

> **Ø¬ÙŠØ¯ Ø£Ù† ØªØ¹Ø±Ù:**
>
> - ÙÙŠ React 19ØŒ ÙŠØªØ¶Ù…Ù† `useFormStatus` Ù…ÙØ§ØªÙŠØ­ Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ù…Ø¹Ø§Ø¯ØŒ Ù…Ø«Ù„ data Ùˆmethod Ùˆaction. Ø¥Ø°Ø§ ÙƒÙ†Øª Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… React 19ØŒ ÙØ¥Ù† Ø§Ù„Ù…ÙØªØ§Ø­ `pending` ÙÙ‚Ø· Ù…ØªØ§Ø­.
> - Ù‚Ø¨Ù„ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØµØ±Ø­ Ù„Ù‡ Ø£ÙŠØ¶Ù‹Ø§ Ø¨ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡. Ø±Ø§Ø¬Ø¹ [Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªØ±Ø®ÙŠØµ](#authorization).

#### Ù£. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯

Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (API) Ø£Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø²ÙˆØ¯ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©.

Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ù† Ø§Ù„Ù…Ø«Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚:

```tsx filename="app/actions/auth.tsx" switcher
export async function signup(state: FormState, formData: FormData) {
  // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  // ...

  // 2. ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  const { name, email, password } = validatedFields.data
  // Ù…Ø«Ù„Ø§Ù‹: ØªØ´ÙÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¨Ù„ ØªØ®Ø²ÙŠÙ†Ù‡Ø§
  const hashedPassword = await bcrypt.hash(password, 10)

  // 3. Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
  const data = await db
    .insert(users)
    .values({
      name,
      email,
      password: hashedPassword,
    })
    .returning({ id: users.id })

  const user = data[0]

  if (!user) {
    return {
      message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ.',
    }
  }

  // TODO:
  // 4. Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  // 5. ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
}
```

```jsx filename="app/actions/auth.js" switcher
export async function signup(state, formData) {
  // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  // ...

  // 2. ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  const { name, email, password } = validatedFields.data
  // Ù…Ø«Ù„Ø§Ù‹: ØªØ´ÙÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¨Ù„ ØªØ®Ø²ÙŠÙ†Ù‡Ø§
  const hashedPassword = await bcrypt.hash(password, 10)

  // 3. Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
  const data = await db
    .insert(users)
    .values({
      name,
      email,
      password: hashedPassword,
    })
    .returning({ id: users.id })

  const user = data[0]

  if (!user) {
    return {
      message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ.',
    }
  }

  // TODO:
  // 4. Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  // 5. ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
}
```

Ø¨Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­ Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…. Ø§Ø¹ØªÙ…Ø§Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ ÙŠÙ…ÙƒÙ† ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙŠ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (cookie) Ø£Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø£Ùˆ ÙƒÙ„ÙŠÙ‡Ù…Ø§. Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù‚Ø³Ù… [Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø©](#session-management) Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯.

> **Ù†ØµØ§Ø¦Ø­:**
>
> - Ø§Ù„Ù…Ø«Ø§Ù„ Ø£Ø¹Ù„Ø§Ù‡ Ù…ÙØµÙ„ Ù„Ø£Ù†Ù‡ ÙŠÙØµÙ„ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù„Ø£ØºØ±Ø§Ø¶ ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ù‡Ø°Ø§ ÙŠØ³Ù„Ø· Ø§Ù„Ø¶ÙˆØ¡ Ø¹Ù„Ù‰ Ø£Ù† ØªÙ†ÙÙŠØ° Ø­Ù„ Ø¢Ù…Ù† Ø®Ø§Øµ Ø¨Ùƒ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØµØ¨Ø­ Ù…Ø¹Ù‚Ø¯Ù‹Ø§ Ø¨Ø³Ø±Ø¹Ø©. ÙÙƒØ± ÙÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… [Ù…ÙƒØªØ¨Ø© Ù…ØµØ§Ø¯Ù‚Ø©](#auth-libraries) Ù„ØªØ¨Ø³ÙŠØ· Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.
> - Ù„ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ù‚Ø¯ ØªØ±ØºØ¨ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ ÙˆÙ‚Øª Ù…Ø¨ÙƒØ± Ù…Ù† Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„. Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ø£Ø«Ù†Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø¹Ù†Ø¯ ÙÙ‚Ø¯Ø§Ù† Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù„ØªØ±ÙƒÙŠØ². ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØ³Ø§Ø¹Ø¯ Ø°Ù„Ùƒ ÙÙŠ Ù…Ù†Ø¹ Ø¹Ù…Ù„ÙŠØ§Øª Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© ÙˆØªÙ‚Ø¯ÙŠÙ… Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙÙˆØ±ÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ ØªÙƒØ±Ø§Ø± Ù‡Ø°Ù‡ Ø§Ù„ÙØ­ÙˆØµØ§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø§Øª Ù…Ø«Ù„ [use-debounce](https://www.npmjs.com/package/use-debounce).

</AppOnly>

<PagesOnly>

Ø¥Ù„ÙŠÙƒ Ø®Ø·ÙˆØ§Øª ØªÙ†ÙÙŠØ° Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ùˆ/Ø£Ùˆ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:

Ù¡. ÙŠÙ‚Ø¯Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡ Ù…Ù† Ø®Ù„Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬.
Ù¢. ÙŠØ±Ø³Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨Ù‹Ø§ ÙŠØªÙ… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ø³Ø§Ø± API.
Ù£. Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù†Ø§Ø¬Ø­ØŒ ØªÙƒØªÙ…Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŒ Ù…Ù…Ø§ ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ Ù†Ø¬Ø§Ø­ Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….
Ù¤. Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ØŒ ÙŠØªÙ… Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£.

Ø¶Ø¹ ÙÙŠ Ø§Ø¹ØªØ¨Ø§Ø±Ùƒ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø­ÙŠØ« ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ù…:

```tsx filename="pages/login.tsx" switcher
import { FormEvent } from 'react'
import { useRouter } from 'next/router'

export default function LoginPage() {
  const router = useRouter()

  async function handleSubmit(event: FormEvent<HTMLFormElement>) {
    event.preventDefault()

    const formData = new FormData(event.currentTarget)
    const email = formData.get('email')
    const password = formData.get('password')

    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password }),
    })

    if (response.ok) {
      router.push('/profile')
    } else {
      // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type="email" name="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required />
      <input type="password" name="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />
      <button type="submit">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
    </form>
  )
}
```

```jsx filename="pages/login.jsx" switcher
import { FormEvent } from 'react'
import { useRouter } from 'next/router'

export default function LoginPage() {
  const router = useRouter()

  async function handleSubmit(event) {
    event.preventDefault()

    const formData = new FormData(event.currentTarget)
    const email = formData.get('email')
    const password = formData.get('password')

    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password }),
    })

    if (response.ok) {
      router.push('/profile')
    } else {
      // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type="email" name="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required />
      <input type="password" name="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />
      <button type="submit">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
    </form>
  )
}
```

ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø£Ø¹Ù„Ø§Ù‡ Ø¹Ù„Ù‰ Ø­Ù‚Ù„ÙŠÙ† Ø¥Ø¯Ø®Ø§Ù„ Ù„Ø¬Ù…Ø¹ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…. Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ ÙŠØªÙ… ØªØ´ØºÙŠÙ„ ÙˆØ¸ÙŠÙØ© ØªØ±Ø³Ù„ Ø·Ù„Ø¨ POST Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø± API (`/api/auth/login`).

ÙŠÙ…ÙƒÙ†Ùƒ Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø²ÙˆØ¯ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙÙŠ Ù…Ø³Ø§Ø± API Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©:

```ts filename="pages/api/auth/login.ts" switcher
import type { NextApiRequest, NextApiResponse } from 'next'
import { signIn } from '@/auth'

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  try {
    const { email, password } = req.body
    await signIn('credentials', { email, password })

    res.status(200).json({ success: true })
  } catch (error) {
    if (error.type === 'CredentialsSignin') {
      res.status(401).json({ error: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ ØºÙŠØ± ØµØ§Ù„Ø­Ø©.' })
    } else {
      res.status(500).json({ error: 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ù…Ø§.' })
    }
  }
}
```

```js filename="pages/api/auth/login.js" switcher
import { signIn } from '@/auth'

export default async function handler(req, res) {
  try {
    const { email, password } = req.body
    await signIn('credentials', { email, password })

    res.status(200).json({ success: true })
  } catch (error) {
    if (error.type === 'CredentialsSignin') {
      res.status(401).json({ error: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ ØºÙŠØ± ØµØ§Ù„Ø­Ø©.' })
    } else {
      res.status(500).json({ error: 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ù…Ø§.' })
    }
  }
}
```

</PagesOnly>

## Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø©

ØªØ¶Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø¨Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª. ÙˆÙ‡ÙŠ ØªØ´Ù…Ù„ Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ®Ø²ÙŠÙ† ÙˆØªØ­Ø¯ÙŠØ« ÙˆØ­Ø°Ù Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø£Ùˆ Ø§Ù„Ø±Ù…ÙˆØ² (tokens).

Ù‡Ù†Ø§Ùƒ Ù†ÙˆØ¹Ø§Ù† Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø§Øª:

Ù¡. [**Ø¨Ø¯ÙˆÙ† Ø­Ø§Ù„Ø© (Stateless)**](#stateless-sessions): ÙŠØªÙ… ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© (Ø£Ùˆ Ø§Ù„Ø±Ù…Ø²) ÙÙŠ Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (cookies) Ù„Ù„Ù…ØªØµÙØ­. ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù…Ø¹ ÙƒÙ„ Ø·Ù„Ø¨ØŒ Ù…Ù…Ø§ ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…. Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø£Ø¨Ø³Ø·ØŒ ÙˆÙ„ÙƒÙ† ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø£Ù‚Ù„ Ø£Ù…Ø§Ù†Ù‹Ø§ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.
Ù¢. [**Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Database)**](#database-sessions): ÙŠØªÙ… ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ù…Ø¹ ØªÙ„Ù‚ÙŠ Ù…ØªØµÙØ­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø´ÙØ±. Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ù‹Ø§ØŒ ÙˆÙ„ÙƒÙ† ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ù…Ø¹Ù‚Ø¯Ø© ÙˆØªØ³ØªØ®Ø¯Ù… Ù…ÙˆØ§Ø±Ø¯ Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù….

> **Ù…Ù† Ø§Ù„Ø¬ÙŠØ¯ Ù…Ø¹Ø±ÙØ©:** Ø¨ÙŠÙ†Ù…Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙŠ Ù…Ù† Ø§Ù„Ø·Ø±ÙŠÙ‚ØªÙŠÙ†ØŒ Ø£Ùˆ ÙƒÙ„ÙŠÙ‡Ù…Ø§ØŒ Ù†ÙˆØµÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù„Ø³Ø§Øª Ù…Ø«Ù„ [iron-session](https://github.com/vvo/iron-session) Ø£Ùˆ [Jose](https://github.com/panva/jose).

### Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø¨Ø¯ÙˆÙ† Ø­Ø§Ù„Ø© (Stateless)

<AppOnly>

Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø¨Ø¯ÙˆÙ† Ø­Ø§Ù„Ø©ØŒ Ù‡Ù†Ø§Ùƒ Ø¨Ø¹Ø¶ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§ØªØ¨Ø§Ø¹Ù‡Ø§:

Ù¡. Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ Ø³Ø±ÙŠØŒ ÙˆØ§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¬Ù„Ø³Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙƒØŒ ÙˆØªØ®Ø²ÙŠÙ†Ù‡ ÙƒÙ€ [Ù…ØªØºÙŠØ± Ø¨ÙŠØ¦ÙŠ](/docs/app/guides/environment-variables).
Ù¢. ÙƒØªØ§Ø¨Ø© Ù…Ù†Ø·Ù‚ Ù„ØªØ´ÙÙŠØ±/ÙÙƒ ØªØ´ÙÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª.
Ù£. Ø¥Ø¯Ø§Ø±Ø© Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª [`cookies`](/docs/app/api-reference/functions/cookies) Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ Next.js.

Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù…Ø§ Ø³Ø¨Ù‚ØŒ Ø¶Ø¹ ÙÙŠ Ø§Ø¹ØªØ¨Ø§Ø±Ùƒ Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© [Ù„ØªØ­Ø¯ÙŠØ« (Ø£Ùˆ ØªØ¬Ø¯ÙŠØ¯)](#updating-or-refreshing-sessions) Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ¹ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŒ Ùˆ[Ø­Ø°Ù](#deleting-the-session) Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬.

> **Ù…Ù† Ø§Ù„Ø¬ÙŠØ¯ Ù…Ø¹Ø±ÙØ©:** ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª [Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©](#auth-libraries) Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ ØªØªØ¶Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª.

#### Ù¡. Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ Ø³Ø±ÙŠ

Ù‡Ù†Ø§Ùƒ Ø¨Ø¹Ø¶ Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ù† Ø®Ù„Ø§Ù„Ù‡Ø§ Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ Ø³Ø±ÙŠ Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¬Ù„Ø³Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ. Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù…Ø± `openssl` ÙÙŠ Ø·Ø±ÙÙŠØªÙƒ:

```bash filename="terminal"
openssl rand -base64 32
```

ÙŠÙ†Ø´Ø¦ Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± Ø³Ù„Ø³Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù…ÙƒÙˆÙ†Ø© Ù…Ù† 32 Ø­Ø±ÙÙ‹Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙƒÙ…ÙØªØ§Ø­ Ø³Ø±ÙŠ ÙˆØªØ®Ø²ÙŠÙ†Ù‡Ø§ ÙÙŠ [Ù…Ù„Ù Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦ÙŠØ©](/docs/app/guides/environment-variables):

```bash filename=".env"
SESSION_SECRET=your_secret_key
```

ÙŠÙ…ÙƒÙ†Ùƒ Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ ÙÙŠ Ù…Ù†Ø·Ù‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø©:

```js filename="app/lib/session.js"
const secretKey = process.env.SESSION_SECRET
```

#### Ù¢. ØªØ´ÙÙŠØ± ÙˆÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø¬Ù„Ø³Ø§Øª

Ø¨Ø¹Ø¯ Ø°Ù„ÙƒØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… [Ù…ÙƒØªØ¨Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª](#session-management-libraries) Ø§Ù„Ù…ÙØ¶Ù„Ø© Ù„Ø¯ÙŠÙƒ Ù„ØªØ´ÙÙŠØ± ÙˆÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø¬Ù„Ø³Ø§Øª. Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ù† Ø§Ù„Ù…Ø«Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚ØŒ Ø³Ù†Ø³ØªØ®Ø¯Ù… [Jose](https://www.npmjs.com/package/jose) (Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ [Edge Runtime](/docs/app/api-reference/edge)) ÙˆØ­Ø²Ù…Ø© [`server-only`](https://www.npmjs.com/package/server-only) Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ React Ù„Ø¶Ù…Ø§Ù† ØªÙ†ÙÙŠØ° Ù…Ù†Ø·Ù‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù….

```tsx filename="app/lib/session.ts" switcher
import 'server-only'
import { SignJWT, jwtVerify } from 'jose'
import { SessionPayload } from '@/app/lib/definitions'

const secretKey = process.env.SESSION_SECRET
const encodedKey = new TextEncoder().encode(secretKey)

export async function encrypt(payload: SessionPayload) {
  return new SignJWT(payload)
    .setProtectedHeader({ alg: 'HS256' })
    .setIssuedAt()
    .setExpirationTime('7d')
    .sign(encodedKey)
}

export async function decrypt(session: string | undefined = '') {
  try {
    const { payload } = await jwtVerify(session, encodedKey, {
      algorithms: ['HS256'],
    })
    return payload
  } catch (error) {
    console.log('ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø©')
  }
}
```

```jsx filename="app/lib/session.js" switcher
import 'server-only'
import { SignJWT, jwtVerify } from 'jose'

const secretKey = process.env.SESSION_SECRET
const encodedKey = new TextEncoder().encode(secretKey)

export async function encrypt(payload) {
  return new SignJWT(payload)
    .setProtectedHeader({ alg: 'HS256' })
    .setIssuedAt()
    .setExpirationTime('7d')
    .sign(encodedKey)
}

export async function decrypt(session) {
  try {
    const { payload } = await jwtVerify(session, encodedKey, {
      algorithms: ['HS256'],
    })
    return payload
  } catch (error) {
    console.log('ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø©')
  }
}
```

> **Ù†ØµØ§Ø¦Ø­:**
>
> - ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© (payload) Ø¹Ù„Ù‰ **Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰** Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ±ÙŠØ¯Ø© Ø§Ù„ØªÙŠ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù„Ø§Ø­Ù‚Ø©ØŒ Ù…Ø«Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ø§Ù„Ø¯ÙˆØ±ØŒ Ø¥Ù„Ø®. Ù„Ø§ ÙŠÙ†Ø¨ØºÙŠ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªØ¹Ø±ÙŠÙ Ø´Ø®ØµÙŠØ© Ù…Ø«Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙØŒ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†ØŒ Ø¥Ù„Ø®ØŒ Ø£Ùˆ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© Ù…Ø«Ù„ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±.

#### Ù£. ØªØ¹ÙŠÙŠÙ† Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Ø®ÙŠØ§Ø±Ø§Øª Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§)

Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙŠ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ø±ØªØ¨Ø§Ø·ØŒ Ø§Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª [`cookies`](/docs/app/api-reference/functions/cookies) Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ Next.js. ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ ÙˆÙŠØªØ¶Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§:

- **HttpOnly**: ÙŠÙ…Ù†Ø¹ JavaScript Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù…Ù† Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„.
- **Secure**: Ø§Ø³ØªØ®Ø¯Ù… https Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·.
- **SameSite**: Ø­Ø¯Ø¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù…Ø¹ Ø·Ù„Ø¨Ø§Øª cross-site.
- **Max-Age Ø£Ùˆ Expires**: Ø§Ø­Ø°Ù Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ù…Ø¹ÙŠÙ†Ø©.
- **Path**: Ø­Ø¯Ø¯ Ù…Ø³Ø§Ø± URL Ù„Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·.

ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ [MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies) Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­ÙˆÙ„ ÙƒÙ„ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª.

```ts filename="app/lib/session.ts" switcher
import 'server-only'
import { cookies } from 'next/headers'

export async function createSession(userId: string) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)
  const session = await encrypt({ userId, expiresAt })
  const cookieStore = await cookies()

  cookieStore.set('session', session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: 'lax',
    path: '/',
  })
}
```

```js filename="app/lib/session.js" switcher
import 'server-only'
import { cookies } from 'next/headers'

export async function createSession(userId) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)
  const session = await encrypt({ userId, expiresAt })
  const cookieStore = await cookies()

  cookieStore.set('session', session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: 'lax',
    path: '/',
  })
}
```

Ø¨Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© `createSession()`ØŒ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª [`redirect()`](/docs/app/guides/redirecting) Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©:

```ts filename="app/actions/auth.ts" switcher
import { createSession } from '@/app/lib/session'

export async function signup(state: FormState, formData: FormData) {
  // Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©:
  // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  // 2. ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  // 3. Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

  // Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
  // 4. Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  await createSession(user.id)
  // 5. ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  redirect('/profile')
}
```

```js filename="app/actions/auth.js" switcher
import { createSession } from '@/app/lib/session'

export async function signup(state, formData) {
  // Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©:
  // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  // 2. ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  // 3. Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

  // Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
  // 4. Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  await createSession(user.id)
  // 5. ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  redirect('/profile')
}
```

> **Ù†ØµØ§Ø¦Ø­:**
>
> - **ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…** Ù„Ù…Ù†Ø¹ Ø§Ù„Ø¹Ø¨Ø« Ù…Ù† Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„.
> - ğŸ¥ Ø´Ø§Ù‡Ø¯: ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø²ÙŠØ¯ Ø­ÙˆÙ„ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø¨Ø¯ÙˆÙ† Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ø¹ Next.js â†’ [YouTube (11 Ø¯Ù‚ÙŠÙ‚Ø©)](https://www.youtube.com/watch?v=DJvM2lSPn6w).

#### ØªØ­Ø¯ÙŠØ« (Ø£Ùˆ ØªØ¬Ø¯ÙŠØ¯) Ø§Ù„Ø¬Ù„Ø³Ø§Øª

ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ ØªÙ…Ø¯ÙŠØ¯ ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø©. Ù‡Ø°Ø§ Ù…ÙÙŠØ¯ Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¹Ø¯ Ø¹ÙˆØ¯ØªÙ‡ Ø¥Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚. Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„:

```ts filename="app/lib/session.ts" switcher
import 'server-only'
import { cookies } from 'next/headers'
import { decrypt } from '@/app/lib/session'

export async function updateSession() {
  const session = (await cookies()).get('session')?.value
  const payload = await decrypt(session)

  if (!session || !payload) {
    return null
  }

  const expires = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)

  const cookieStore = await cookies()
  cookieStore.set('session', session, {
    httpOnly: true,
    secure: true,
    expires: expires,
    sameSite: 'lax',
    path: '/',
  })
}
```

```js filename="app/lib/session.js" switcher
import 'server-only'
import { cookies } from 'next/headers'
import { decrypt } from '@/app/lib/session'

export async function updateSession() {
  const session = (await cookies()).get('session')?.value
  const payload = await decrypt(session)

  if (!session || !payload) {
    return null
  }

  const expires = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)(
    await cookies()
  ).set('session', session, {
    httpOnly: true,
    secure: true,
    expires: expires,
    sameSite: 'lax',
    path: '/',
  })
}
```

> **Ù†ØµÙŠØ­Ø©:** ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ ØªØ¯Ø¹Ù… Ø±Ù…ÙˆØ² Ø§Ù„ØªØ­Ø¯ÙŠØ« (refresh tokens)ØŒ ÙˆØ§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ù„ØªÙ…Ø¯ÙŠØ¯ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….

#### Ø­Ø°Ù Ø§Ù„Ø¬Ù„Ø³Ø©

Ù„Ø­Ø°Ù Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø­Ø°Ù Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (cookie):

```ts filename="app/lib/session.ts" switcher
import 'server-only'
import { cookies } from 'next/headers'

export async function deleteSession() {
  const cookieStore = await cookies()
  cookieStore.delete('session')
}
```

```js filename="app/lib/session.js" switcher
import 'server-only'
import { cookies } from 'next/headers'

export async function deleteSession() {
  const cookieStore = await cookies()
  cookieStore.delete('session')
}
```

Ø«Ù… ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯Ø§Ù„Ø© `deleteSession()` ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ÙƒØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:

```ts filename="app/actions/auth.ts" switcher
import { cookies } from 'next/headers'
import { deleteSession } from '@/app/lib/session'

export async function logout() {
  await deleteSession()
  redirect('/login')
}
```

```js filename="app/actions/auth.js" switcher
import { cookies } from 'next/headers'
import { deleteSession } from '@/app/lib/session'

export async function logout() {
  await deleteSession()
  redirect('/login')
}
```

</AppOnly>

<PagesOnly>

#### ØªØ¹ÙŠÙŠÙ† ÙˆØ­Ø°Ù Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·

ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… [Ù…Ø³Ø§Ø±Ø§Øª API](/docs/pages/building-your-application/routing/api-routes) Ù„ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø© ÙƒÙ…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ø±ØªØ¨Ø§Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…:

```ts filename="pages/api/login.ts" switcher
import { serialize } from 'cookie'
import type { NextApiRequest, NextApiResponse } from 'next'
import { encrypt } from '@/app/lib/session'

export default function handler(req: NextApiRequest, res: NextApiResponse) {
  const sessionData = req.body
  const encryptedSessionData = encrypt(sessionData)

  const cookie = serialize('session', encryptedSessionData, {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    maxAge: 60 * 60 * 24 * 7, // Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯
    path: '/',
  })
  res.setHeader('Set-Cookie', cookie)
  res.status(200).json({ message: 'ØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ù†Ø¬Ø§Ø­!' })
}
```

```js filename="pages/api/login.js" switcher
import { serialize } from 'cookie'
import { encrypt } from '@/app/lib/session'

export default function handler(req, res) {
  const sessionData = req.body
  const encryptedSessionData = encrypt(sessionData)

  const cookie = serialize('session', encryptedSessionData, {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    maxAge: 60 * 60 * 24 * 7, // Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯
    path: '/',
  })
  res.setHeader('Set-Cookie', cookie)
  res.status(200).json({ message: 'ØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ù†Ø¬Ø§Ø­!' })
}
```

</PagesOnly>

### Ø¬Ù„Ø³Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø¬Ù„Ø³Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§ØªØ¨Ø§Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ§Øª:

1. Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© (Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ ØªØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù‡Ø°Ø§).
2. ØªÙ†ÙÙŠØ° ÙˆØ¸Ø§Ø¦Ù Ù„Ø¥Ø¯Ø±Ø§Ø¬ ÙˆØªØ­Ø¯ÙŠØ« ÙˆØ­Ø°Ù Ø§Ù„Ø¬Ù„Ø³Ø§Øª
3. ØªØ´ÙÙŠØ± Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø¬Ù„Ø³Ø© Ù‚Ø¨Ù„ ØªØ®Ø²ÙŠÙ†Ù‡ ÙÙŠ Ù…ØªØµÙØ­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ²Ø§Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Ù‡Ø°Ø§ Ø§Ø®ØªÙŠØ§Ø±ÙŠØŒ ÙˆÙ„ÙƒÙ†Ù‡ Ù…ÙˆØµÙ‰ Ø¨Ù‡ Ù„Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…ØªÙØ§Ø¦Ù„ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙÙŠ [Ø§Ù„ÙˆØ³ÙŠØ·](#optimistic-checks-with-middleware-optional)).

<AppOnly>

Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„:

```ts filename="app/lib/session.ts" switcher
import cookies from 'next/headers'
import { db } from '@/app/lib/db'
import { encrypt } from '@/app/lib/session'

export async function createSession(id: number) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)

  // 1. Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  const data = await db
    .insert(sessions)
    .values({
      userId: id,
      expiresAt,
    })
    // Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø¬Ù„Ø³Ø©
    .returning({ id: sessions.id })

  const sessionId = data[0].id

  // 2. ØªØ´ÙÙŠØ± Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø¬Ù„Ø³Ø©
  const session = await encrypt({ sessionId, expiresAt })

  // 3. ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙŠ Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù„Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…ØªÙØ§Ø¦Ù„ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
  const cookieStore = await cookies()
  cookieStore.set('session', session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: 'lax',
    path: '/',
  })
}
```

```js filename="app/lib/session.js" switcher
import cookies from 'next/headers'
import { db } from '@/app/lib/db'
import { encrypt } from '@/app/lib/session'

export async function createSession(id) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)

  // 1. Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  const data = await db
    .insert(sessions)
    .values({
      userId: id,
      expiresAt,
    })
    // Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø¬Ù„Ø³Ø©
    .returning({ id: sessions.id })

  const sessionId = data[0].id

  // 2. ØªØ´ÙÙŠØ± Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø¬Ù„Ø³Ø©
  const session = await encrypt({ sessionId, expiresAt })

  // 3. ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙŠ Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù„Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…ØªÙØ§Ø¦Ù„ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
  const cookieStore = await cookies()
  cookieStore.set('session', session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: 'lax',
    path: '/',
  })
}
```

> **Ù†ØµØ§Ø¦Ø­**:
>
> - Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø£Ø³Ø±Ø¹ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙÙƒÙŠØ± ÙÙŠ Ø¥Ø¶Ø§ÙØ© ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ ÙˆØ¬Ù…Ø¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªÙ‚Ù„ÙŠÙ„ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª.
> - ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¬Ù„Ø³Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø­Ø§Ù„Ø§Øª Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙƒØ«Ø± ØªÙ‚Ø¯Ù…Ù‹Ø§ØŒ Ù…Ø«Ù„ ØªØªØ¨Ø¹ Ø¢Ø®Ø± Ù…Ø±Ø© Ù‚Ø§Ù… ÙÙŠÙ‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø£Ùˆ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù†Ø´Ø·Ø©ØŒ Ø£Ùˆ Ù…Ù†Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©.

Ø¨Ø¹Ø¯ ØªÙ†ÙÙŠØ° Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§ØªØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø§Ù„ØªÙÙˆÙŠØ¶ Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠÙ…Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡ ÙˆØ§Ù„Ù‚ÙŠØ§Ù… Ø¨Ù‡ Ø¯Ø§Ø®Ù„ ØªØ·Ø¨ÙŠÙ‚Ùƒ. ØªØ§Ø¨Ø¹ Ø¥Ù„Ù‰ Ù‚Ø³Ù… [Ø§Ù„ØªÙÙˆÙŠØ¶](#authorization) Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯.

</AppOnly>

<PagesOnly>

**Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…**:

```ts filename="pages/api/create-session.ts" switcher
import db from '../../lib/db'
import type { NextApiRequest, NextApiResponse } from 'next'

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  try {
    const user = req.body
    const sessionId = generateSessionId()
    await db.insertSession({
      sessionId,
      userId: user.id,
      createdAt: new Date(),
    })

    res.status(200).json({ sessionId })
  } catch (error) {
    res.status(500).json({ error: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ' })
  }
}
```

```js filename="pages/api/create-session.js" switcher
import db from '../../lib/db'

export default async function handler(req, res) {
  try {
    const user = req.body
    const sessionId = generateSessionId()
    await db.insertSession({
      sessionId,
      userId: user.id,
      createdAt: new Date(),
    })

    res.status(200).json({ sessionId })
  } catch (error) {
    res.status(500).json({ error: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ' })
  }
}
```

</PagesOnly>

## Ø§Ù„ØªÙÙˆÙŠØ¶

Ø¨Ø¹Ø¯ Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†ÙÙŠØ° Ø§Ù„ØªÙÙˆÙŠØ¶ Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠÙ…Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡ ÙˆØ§Ù„Ù‚ÙŠØ§Ù… Ø¨Ù‡ Ø¯Ø§Ø®Ù„ ØªØ·Ø¨ÙŠÙ‚Ùƒ.

Ù‡Ù†Ø§Ùƒ Ù†ÙˆØ¹Ø§Ù† Ø±Ø¦ÙŠØ³ÙŠØ§Ù† Ù…Ù† Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙÙˆÙŠØ¶:

1. **Ø§Ù„Ù…ØªÙØ§Ø¦Ù„**: ÙŠØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø®ÙˆÙ„Ø§Ù‹ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø± Ø£Ùˆ ØªÙ†ÙÙŠØ° Ø¥Ø¬Ø±Ø§Ø¡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø®Ø²Ù†Ø© ÙÙŠ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·. Ù‡Ø°Ù‡ Ø§Ù„ÙØ­ÙˆØµØ§Øª Ù…ÙÙŠØ¯Ø© Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©ØŒ Ù…Ø«Ù„ Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø¹Ù†Ø§ØµØ± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø£Ùˆ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±.
2. **Ø§Ù„Ø¢Ù…Ù†**: ÙŠØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø®ÙˆÙ„Ø§Ù‹ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø± Ø£Ùˆ ØªÙ†ÙÙŠØ° Ø¥Ø¬Ø±Ø§Ø¡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø®Ø²Ù†Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ù‡Ø°Ù‡ Ø§Ù„ÙØ­ÙˆØµØ§Øª Ø£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ù‹Ø§ ÙˆØªØ³ØªØ®Ø¯Ù… Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙŠ ØªØªØ·Ù„Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© Ø£Ùˆ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª.

Ù„ÙƒÙ„Ø§ Ø§Ù„Ø­Ø§Ù„ØªÙŠÙ†ØŒ Ù†ÙˆØµÙŠ Ø¨Ù…Ø§ ÙŠÙ„ÙŠ:

- Ø¥Ù†Ø´Ø§Ø¡ [Ø·Ø¨Ù‚Ø© ÙˆØµÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#creating-a-data-access-layer-dal) Ù„Ù…Ø±ÙƒØ²ÙŠØ© Ù…Ù†Ø·Ù‚ Ø§Ù„ØªÙÙˆÙŠØ¶
- Ø§Ø³ØªØ®Ø¯Ø§Ù… [ÙƒØ§Ø¦Ù†Ø§Øª Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DTO)](#using-data-transfer-objects-dto) Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© ÙÙ‚Ø·
- Ø§Ø³ØªØ®Ø¯Ø§Ù… [Ø§Ù„ÙˆØ³ÙŠØ·](#optimistic-checks-with-middleware-optional) Ø§Ø®ØªÙŠØ§Ø±ÙŠÙ‹Ø§ Ù„Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­ÙˆØµØ§Øª Ù…ØªÙØ§Ø¦Ù„Ø©.

### ÙØ­ÙˆØµØ§Øª Ù…ØªÙØ§Ø¦Ù„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙˆØ³ÙŠØ· (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)

Ù‡Ù†Ø§Ùƒ Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªÙŠ Ù‚Ø¯ ØªØ±ØºØ¨ ÙÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… [Ø§Ù„ÙˆØ³ÙŠØ·](/docs/app/building-your-application/routing/middleware) ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª:

- Ù„Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­ÙˆØµØ§Øª Ù…ØªÙØ§Ø¦Ù„Ø©. Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ø§Ù„ÙˆØ³ÙŠØ· ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø³Ø§Ø±ØŒ ÙÙ‡Ùˆ Ø·Ø±ÙŠÙ‚Ø© Ø¬ÙŠØ¯Ø© Ù„Ù…Ø±ÙƒØ²ÙŠØ© Ù…Ù†Ø·Ù‚ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ ÙˆØªØµÙÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù… Ù…Ø³Ø¨Ù‚Ù‹Ø§.
- Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø§Ù„ØªÙŠ ØªØ´Ø§Ø±Ùƒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Ù…Ø«Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø®Ù„Ù Ø¬Ø¯Ø§Ø± Ø§Ù„Ø¯ÙØ¹).

ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ø§Ù„ÙˆØ³ÙŠØ· ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø³Ø§Ø±ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª [Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ù…Ø³Ø¨Ù‚Ù‹Ø§](/docs/app/getting-started/linking-and-navigating#prefetching)ØŒ ÙÙ…Ù† Ø§Ù„Ù…Ù‡Ù… Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙ‚Ø· Ù…Ù† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (ÙØ­ÙˆØµØ§Øª Ù…ØªÙØ§Ø¦Ù„Ø©)ØŒ ÙˆØªØ¬Ù†Ø¨ ÙØ­ÙˆØµØ§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…Ù†Ø¹ Ù…Ø´ÙƒÙ„Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡.

Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„:

```tsx filename="middleware.ts" switcher
import { NextRequest, NextResponse } from 'next/server'
import { decrypt } from '@/app/lib/session'
import { cookies } from 'next/headers'

// 1. ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©
const protectedRoutes = ['/dashboard']
const publicRoutes = ['/login', '/signup', '/']

export default async function middleware(req: NextRequest) {
  // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ø­Ù…ÙŠÙ‹Ø§ Ø£Ùˆ Ø¹Ø§Ù…Ù‹Ø§
  const path = req.nextUrl.pathname
  const isProtectedRoute = protectedRoutes.includes(path)
  const isPublicRoute = publicRoutes.includes(path)

  // 3. ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ù† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·
  const cookie = (await cookies()).get('session')?.value
  const session = await decrypt(cookie)

  // 4. Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ /login Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØµØ§Ø¯Ù‚Ù‹Ø§ Ø¹Ù„ÙŠÙ‡
  if (isProtectedRoute && !session?.userId) {
    return NextResponse.redirect(new URL('/login', req.nextUrl))
  }

  // 5. Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ /dashboard Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØµØ§Ø¯Ù‚Ù‹Ø§ Ø¹Ù„ÙŠÙ‡
  if (
    isPublicRoute &&
    session?.userId &&
    !req.nextUrl.pathname.startsWith('/dashboard')
  ) {
    return NextResponse.redirect(new URL('/dashboard', req.nextUrl))
  }

  return NextResponse.next()
}

// Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø§ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„ÙˆØ³ÙŠØ·
export const config = {
  matcher: ['/((?!api|_next/static|_next/image|.*\\.png$).*)'],
}
```

```js filename="middleware.js" switcher
import { NextResponse } from 'next/server'
import { decrypt } from '@/app/lib/session'
import { cookies } from 'next/headers'

// 1. ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©
const protectedRoutes = ['/dashboard']
const publicRoutes = ['/login', '/signup', '/']

export default async function middleware(req) {
  // 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ø­Ù…ÙŠÙ‹Ø§ Ø£Ùˆ Ø¹Ø§Ù…Ù‹Ø§
  const path = req.nextUrl.pathname
  const isProtectedRoute = protectedRoutes.includes(path)
  const isPublicRoute = publicRoutes.includes(path)

  // 3. ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ù† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·
  const cookie = (await cookies()).get('session')?.value
  const session = await decrypt(cookie)

  // 5. Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ /login Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØµØ§Ø¯Ù‚Ù‹Ø§ Ø¹Ù„ÙŠÙ‡
  if (isProtectedRoute && !session?.userId) {
    return NextResponse.redirect(new URL('/login', req.nextUrl))
  }

  // 6. Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ /dashboard Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØµØ§Ø¯Ù‚Ù‹Ø§ Ø¹Ù„ÙŠÙ‡
  if (
    isPublicRoute &&
    session?.userId &&
    !req.nextUrl.pathname.startsWith('/dashboard')
  ) {
    return NextResponse.redirect(new URL('/dashboard', req.nextUrl))
  }

  return NextResponse.next()
}

// Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø§ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„ÙˆØ³ÙŠØ·
export const config = {
  matcher: ['/((?!api|_next/static|_next/image|.*\\.png$).*)'],
}
```

Ø¨ÙŠÙ†Ù…Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ÙˆØ³ÙŠØ· Ù…ÙÙŠØ¯Ù‹Ø§ Ù„Ù„ÙØ­ÙˆØµØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©ØŒ Ù„Ø§ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø®Ø· Ø¯ÙØ§Ø¹Ùƒ Ø§Ù„ÙˆØ­ÙŠØ¯ ÙÙŠ Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ. ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ØºØ§Ù„Ø¨ÙŠØ© ÙØ­ÙˆØµØ§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ø¨Ø§Ù„Ù‚Ø±Ø¨ Ù…Ù† Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¯Ø± Ø§Ù„Ø¥Ù…ÙƒØ§Ù†ØŒ Ø±Ø§Ø¬Ø¹ [Ø·Ø¨Ù‚Ø© ÙˆØµÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#creating-a-data-access-layer-dal) Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª.

> **Ù†ØµØ§Ø¦Ø­**:
>
> - ÙÙŠ Ø§Ù„ÙˆØ³ÙŠØ·ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… `req.cookies.get('session').value`.
> - ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„ÙˆØ³ÙŠØ· [ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙØ©](/docs/app/api-reference/edge)ØŒ ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆÙ…ÙƒØªØ¨Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ù…ØªÙˆØ§ÙÙ‚Ø©.
> - ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø§ØµÙŠØ© `matcher` ÙÙŠ Ø§Ù„ÙˆØ³ÙŠØ· Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„ÙˆØ³ÙŠØ·. ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©ØŒ ÙŠÙˆØµÙ‰ Ø¨Ø£Ù† ÙŠØ¹Ù…Ù„ Ø§Ù„ÙˆØ³ÙŠØ· Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª.

<AppOnly>

### Ø¥Ù†Ø´Ø§Ø¡ Ø·Ø¨Ù‚Ø© ÙˆØµÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DAL)

Ù†ÙˆØµÙŠ Ø¨Ø¥Ù†Ø´Ø§Ø¡ DAL Ù„Ù…Ø±ÙƒØ²ÙŠØ© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ…Ù†Ø·Ù‚ Ø§Ù„ØªÙÙˆÙŠØ¶.

ÙŠØ¬Ø¨ Ø£Ù† ØªØªØ¶Ù…Ù† DAL Ø¯Ø§Ù„Ø© ØªØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø«Ù†Ø§Ø¡ ØªÙØ§Ø¹Ù„Ù‡ Ù…Ø¹ ØªØ·Ø¨ÙŠÙ‚Ùƒ. Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªØªØ­Ù‚Ù‚ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¬Ù„Ø³Ø© ØµØ§Ù„Ø­Ø©ØŒ Ø«Ù… ØªÙ‚ÙˆÙ… Ø¨Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø£Ùˆ Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø·Ù„Ø¨Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©.

Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ù†ÙØµÙ„ Ù„Ù€ DAL ÙŠØªØ¶Ù…Ù† Ø¯Ø§Ù„Ø© `verifySession()`. Ø«Ù… Ø§Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª [cache](https://react.dev/reference/react/cache) Ù…Ù† React Ù„Ø­ÙØ¸ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ù„Ù„Ø¯Ø§Ù„Ø© Ø£Ø«Ù†Ø§Ø¡ ØªÙ…Ø±ÙŠØ± Ø¹Ø±Ø¶ React:

```tsx filename="app/lib/dal.ts" switcher
import 'server-only'

import { cookies } from 'next/headers'
import { decrypt } from '@/app/lib/session'

export const verifySession = cache(async () => {
  const cookie = (await cookies()).get('session')?.value
  const session = await decrypt(cookie)

  if (!session?.userId) {
    redirect('/login')
  }

  return { isAuth: true, userId: session.userId }
})
```

```js filename="app/lib/dal.js" switcher
import 'server-only'

import { cookies } from 'next/headers'
import { decrypt } from '@/app/lib/session'

export const verifySession = cache(async () => {
  const cookie = (await cookies()).get('session')?.value
  const session = await decrypt(cookie)

  if (!session.userId) {
    redirect('/login')
  }

  return { isAuth: true, userId: session.userId }
})
```

ÙŠÙ…ÙƒÙ†Ùƒ Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© `verifySession()` ÙÙŠ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙˆØ¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø±:

```tsx filename="app/lib/dal.ts" switcher
export const getUser = cache(async () => {
  const session = await verifySession()
  if (!session) return null

  try {
    const data = await db.query.users.findMany({
      where: eq(users.id, session.userId),
      // Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬Ù‡Ø§ ØµØ±Ø§Ø­Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ÙƒØ§Ø¦Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
      columns: {
        id: true,
        name: true,
        email: true,
      },
    })

    const user = data[0]

    return user
  } catch (error) {
    console.log('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…')
    return null
  }
})
```

```jsx filename="app/lib/dal.js" switcher
export const getUser = cache(async () => {
  const session = await verifySession()
  if (!session) return null

  try {
    const data = await db.query.users.findMany({
      where: eq(users.id, session.userId),
      // Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬Ù‡Ø§ ØµØ±Ø§Ø­Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ÙƒØ§Ø¦Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
      columns: {
        id: true,
        name: true,
        email: true,
      },
    })

    const user = data[0]

    return user
  } catch (error) {
    console.log('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…')
    return null
  }
})
```

> **Ù†ØµÙŠØ­Ø©**:
>
> - ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… DAL Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ ÙŠØªÙ… Ø¬Ù„Ø¨Ù‡Ø§ ÙÙŠ ÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨. ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø§Ù„ØªÙŠ ØªØ´Ø§Ø±Ùƒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ø³ÙŠØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ ÙˆÙ‚Øª Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙˆÙ„ÙŠØ³ ÙÙŠ ÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨. Ø§Ø³ØªØ®Ø¯Ù… [Ø§Ù„ÙˆØ³ÙŠØ·](#optimistic-checks-with-middleware-optional) Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©.
> - Ù„Ù„ÙØ­ÙˆØµØ§Øª Ø§Ù„Ø¢Ù…Ù†Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¬Ù„Ø³Ø© ØµØ§Ù„Ø­Ø© Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ. Ø§Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ù„Ø© [cache](https://react.dev/reference/react/cache) Ù…Ù† React Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø«Ù†Ø§Ø¡ ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶.
> - Ù‚Ø¯ ØªØ±ØºØ¨ ÙÙŠ ØªÙˆØ­ÙŠØ¯ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø°Ø§Øª Ø§Ù„ØµÙ„Ø© ÙÙŠ ÙØ¦Ø© JavaScript ØªÙ‚ÙˆÙ… Ø¨ØªØ´ØºÙŠÙ„ `verifySession()` Ù‚Ø¨Ù„ Ø£ÙŠ Ø·Ø±Ù‚.

### Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒØ§Ø¦Ù†Ø§Øª Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DTO)

Ø¹Ù†Ø¯ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠÙÙ†ØµØ­ Ø¨Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© ÙÙ‚Ø· Ø§Ù„ØªÙŠ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ÙƒØŒ ÙˆÙ„ÙŠØ³ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©. Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ±Ø¬Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ ÙÙ‚Ø¯ ØªØ±Ø¬Ø¹ ÙÙ‚Ø· Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø³Ù…Ù‡ØŒ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ÙƒØ§Ø¦Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ø§Ù„Ø°ÙŠ Ù‚Ø¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‡ÙˆØ§ØªÙØŒ Ø¥Ù„Ø®.

ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù„Ø¯ÙŠÙƒ ØªØ­ÙƒÙ… ÙÙŠ Ø¨Ù†ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØ±Ø¬Ø¹Ø©ØŒ Ø£Ùˆ ÙƒÙ†Øª ØªØ¹Ù…Ù„ Ø¶Ù…Ù† ÙØ±ÙŠÙ‚ Ø­ÙŠØ« ØªØ±ÙŠØ¯ ØªØ¬Ù†Ø¨ ØªÙ…Ø±ÙŠØ± ÙƒØ§Ø¦Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ù…Ø«Ù„ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¢Ù…Ù†Ø© Ù„Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„.

```tsx filename="app/lib/dto.ts" switcher
import 'server-only'
import { getUser } from '@/app/lib/dal'

function canSeeUsername(viewer: User) {
  return true
}

function canSeePhoneNumber(viewer: User, team: string) {
  return viewer.isAdmin || team === viewer.team
}

export async function getProfileDTO(slug: string) {
  const data = await db.query.users.findMany({
    where: eq(users.slug, slug),
    // Return specific columns here
  })
  const user = data[0]

  const currentUser = await getUser(user.id)

  // Or return only what's specific to the query here
  return {
    username: canSeeUsername(currentUser) ? user.username : null,
    phonenumber: canSeePhoneNumber(currentUser, user.team)
      ? user.phonenumber
      : null,
  }
}
```

```js filename="app/lib/dto.js" switcher
import 'server-only'
import { getUser } from '@/app/lib/dal'

function canSeeUsername(viewer) {
  return true
}

function canSeePhoneNumber(viewer, team) {
  return viewer.isAdmin || team === viewer.team
}

export async function getProfileDTO(slug) {
  const data = await db.query.users.findMany({
    where: eq(users.slug, slug),
    // Return specific columns here
  })
  const user = data[0]

  const currentUser = await getUser(user.id)

  // Or return only what's specific to the query here
  return {
    username: canSeeUsername(currentUser) ? user.username : null,
    phonenumber: canSeePhoneNumber(currentUser, user.team)
      ? user.phonenumber
      : null,
  }
}
```

Ù…Ù† Ø®Ù„Ø§Ù„ ØªØ±ÙƒÙŠØ² Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ…Ù†Ø·Ù‚ Ø§Ù„ØªÙÙˆÙŠØ¶ ÙÙŠ Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DAL) ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù… ÙƒØ§Ø¦Ù†Ø§Øª Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DTOs)ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¶Ù…Ø§Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¢Ù…Ù†Ø© ÙˆÙ…ØªØ³Ù‚Ø©ØŒ Ù…Ù…Ø§ ÙŠØ³Ù‡Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„ØªØ¯Ù‚ÙŠÙ‚ ÙˆØ§Ù„ØªØµØ­ÙŠØ­ Ù…Ø¹ ØªÙˆØ³Ø¹ ØªØ·Ø¨ÙŠÙ‚Ùƒ.

> **Ù…Ø¹Ù„ÙˆÙ…Ø© Ù…ÙÙŠØ¯Ø©**:
>
> - Ù‡Ù†Ø§Ùƒ Ø¹Ø¯Ø© Ø·Ø±Ù‚ Ù…Ø®ØªÙ„ÙØ© Ù„ØªØ­Ø¯ÙŠØ¯ ÙƒØ§Ø¦Ù† Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DTO)ØŒ Ø¨Ø¯Ø¡Ù‹Ø§ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… `toJSON()`ØŒ Ø¥Ù„Ù‰ Ø¯ÙˆØ§Ù„ ÙØ±Ø¯ÙŠØ© Ù…Ø«Ù„ Ø§Ù„Ù…Ø«Ø§Ù„ Ø£Ø¹Ù„Ø§Ù‡ØŒ Ø£Ùˆ ÙØ¦Ø§Øª Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª. Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ù‡Ø°Ù‡ Ø£Ù†Ù…Ø§Ø· Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª ÙˆÙ„ÙŠØ³Øª Ù…ÙŠØ²Ø© ÙÙŠ React Ø£Ùˆ Next.jsØŒ Ù†Ù†ØµØ­ Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø¨Ø¹Ø¶ Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ø£Ù†Ø³Ø¨ Ù„ØªØ·Ø¨ÙŠÙ‚Ùƒ.
> - ØªØ¹Ù„Ù… Ø§Ù„Ù…Ø²ÙŠØ¯ Ø¹Ù† Ø£ÙØ¶Ù„ Ù…Ù…Ø§Ø±Ø³Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† ÙÙŠ [Ù…Ù‚Ø§Ù„ Ø§Ù„Ø£Ù…Ø§Ù† ÙÙŠ Next.js](/blog/security-nextjs-server-components-actions).

### Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù… (Server Components)

ÙØ­Øµ Ø§Ù„ØªÙÙˆÙŠØ¶ ÙÙŠ [Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…](/docs/app/getting-started/server-and-client-components) Ù…ÙÙŠØ¯ Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±. Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…Ø´Ø±ÙˆØ· Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:

```tsx filename="app/dashboard/page.tsx" switcher
import { verifySession } from '@/app/lib/dal'

export default function Dashboard() {
  const session = await verifySession()
  const userRole = session?.user?.role // Assuming 'role' is part of the session object

  if (userRole === 'admin') {
    return <AdminDashboard />
  } else if (userRole === 'user') {
    return <UserDashboard />
  } else {
    redirect('/login')
  }
}
```

```jsx filename="app/dashboard/page.jsx" switcher
import { verifySession } from '@/app/lib/dal'

export default function Dashboard() {
  const session = await verifySession()
  const userRole = session.role // Assuming 'role' is part of the session object

  if (userRole === 'admin') {
    return <AdminDashboard />
  } else if (userRole === 'user') {
    return <UserDashboard />
  } else {
    redirect('/login')
  }
}
```

ÙÙŠ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¯Ø§Ù„Ø© `verifySession()` Ù…Ù† Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DAL) Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ø¯ÙˆØ§Ø± 'admin' Ùˆ'user' ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø± ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§. ÙŠØ¶Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…Ø· ØªÙØ§Ø¹Ù„ ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù…Ø¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø¯ÙˆØ±Ù‡.

### Ø§Ù„ØªØ®Ø·ÙŠØ·Ø§Øª ÙˆÙØ­ÙˆØµØ§Øª Ø§Ù„ØªÙÙˆÙŠØ¶

Ø¨Ø³Ø¨Ø¨ [Ø§Ù„ØªØµÙŠÙŠØ± Ø§Ù„Ø¬Ø²Ø¦ÙŠ (Partial Rendering)](/docs/app/getting-started/linking-and-navigating#client-side-transitions)ØŒ ÙƒÙ† Ø­Ø°Ø±Ù‹Ø§ Ø¹Ù†Ø¯ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ÙØ­ÙˆØµØ§Øª ÙÙŠ [Ø§Ù„ØªØ®Ø·ÙŠØ·Ø§Øª (Layouts)](/docs/app/api-reference/file-conventions/layout) Ù„Ø£Ù†Ù‡Ø§ Ù„Ø§ ØªÙØ¹ÙŠØ¯ Ø§Ù„ØªØµÙŠÙŠØ± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†Ù‚Ù„ØŒ Ù…Ù…Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù† ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§ ÙÙŠ ÙƒÙ„ ØªØºÙŠÙŠØ± Ù„Ù„Ù…Ø³Ø§Ø±.

Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„ÙƒØŒ ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ÙØ­ÙˆØµØ§Øª Ø¨Ø§Ù„Ù‚Ø±Ø¨ Ù…Ù† Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø§Ù„Ù…ÙƒÙˆÙ† Ø§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… Ø¹Ø±Ø¶Ù‡ Ø¨Ø´ÙƒÙ„ Ù…Ø´Ø±ÙˆØ·.

Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ø¶Ø¹ ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± ØªØ®Ø·ÙŠØ·Ù‹Ø§ Ù…Ø´ØªØ±ÙƒÙ‹Ø§ ÙŠØ³ØªØ±Ø¬Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙŠØ¹Ø±Ø¶ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„. Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­Øµ Ø§Ù„ØªÙÙˆÙŠØ¶ ÙÙŠ Ø§Ù„ØªØ®Ø·ÙŠØ·ØŒ ÙŠØ¬Ø¨ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (`getUser()`) ÙÙŠ Ø§Ù„ØªØ®Ø·ÙŠØ· ÙˆØ¥Ø¬Ø±Ø§Ø¡ ÙØ­Øµ Ø§Ù„ØªÙÙˆÙŠØ¶ ÙÙŠ Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DAL).

Ù‡Ø°Ø§ ÙŠØ¶Ù…Ù† Ø£Ù†Ù‡ ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† ÙŠØªÙ… ÙÙŠÙ‡ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ `getUser()` Ø¯Ø§Ø®Ù„ ØªØ·Ø¨ÙŠÙ‚ÙƒØŒ ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­Øµ Ø§Ù„ØªÙÙˆÙŠØ¶ØŒ ÙˆÙŠÙ…Ù†Ø¹ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† Ù…Ù† Ù†Ø³ÙŠØ§Ù† Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØµØ±Ø­ Ù„Ù‡ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.

```tsx filename="app/layout.tsx" switcher
export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  const user = await getUser();

  return (
    // ...
  )
}
```

```jsx filename="app/layout.js" switcher
export default async function Layout({ children }) {
  const user = await getUser();

  return (
    // ...
  )
}
```

```ts filename="app/lib/dal.ts" switcher
export const getUser = cache(async () => {
  const session = await verifySession()
  if (!session) return null

  // Get user ID from session and fetch data
})
```

```js filename="app/lib/dal.js" switcher
export const getUser = cache(async () => {
  const session = await verifySession()
  if (!session) return null

  // Get user ID from session and fetch data
})
```

> **Ù…Ø¹Ù„ÙˆÙ…Ø© Ù…ÙÙŠØ¯Ø©:**
>
> - Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ø´Ø§Ø¦Ø¹ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø°Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© (SPAs) Ù‡Ùˆ Ø¥Ø±Ø¬Ø§Ø¹ `null` ÙÙŠ ØªØ®Ø·ÙŠØ· Ø£Ùˆ Ù…ÙƒÙˆÙ† Ø±Ø¦ÙŠØ³ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØµØ±Ø­Ù‹Ø§ Ù„Ù‡. **Ù„Ø§ ÙŠÙÙ†ØµØ­ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…Ø·** Ù„Ø£Ù† ØªØ·Ø¨ÙŠÙ‚Ø§Øª Next.js Ù„Ø¯ÙŠÙ‡Ø§ Ù†Ù‚Ø§Ø· Ø¯Ø®ÙˆÙ„ Ù…ØªØ¹Ø¯Ø¯Ø©ØŒ Ù…Ù…Ø§ Ù„Ù† ÙŠÙ…Ù†Ø¹ Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…ØªØ¯Ø§Ø®Ù„Ø© ÙˆØ¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù… (Server Actions) Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„.

### Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù… (Server Actions)

Ø¹Ø§Ù…Ù„ [Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) Ø¨Ù†ÙØ³ Ø§Ø¹ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ù…Ø«Ù„ Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (API) Ø§Ù„Ù…ÙˆØ¬Ù‡Ø© Ù„Ù„Ø¬Ù…Ù‡ÙˆØ±ØŒ ÙˆØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ù…ÙˆØ­Ù‹Ø§ Ù„Ù‡ Ø¨ØªÙ†ÙÙŠØ° Ø§Ù„ØªØºÙŠÙŠØ±.

ÙÙŠ Ø§Ù„Ù…Ø«Ø§Ù„ Ø£Ø¯Ù†Ø§Ù‡ØŒ Ù†ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¨Ù„ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡:

```ts filename="app/lib/actions.ts" switcher
'use server'
import { verifySession } from '@/app/lib/dal'

export async function serverAction(formData: FormData) {
  const session = await verifySession()
  const userRole = session?.user?.role

  // Return early if user is not authorized to perform the action
  if (userRole !== 'admin') {
    return null
  }

  // Proceed with the action for authorized users
}
```

```js filename="app/lib/actions.js" switcher
'use server'
import { verifySession } from '@/app/lib/dal'

export async function serverAction() {
  const session = await verifySession()
  const userRole = session.user.role

  // Return early if user is not authorized to perform the action
  if (userRole !== 'admin') {
    return null
  }

  // Proceed with the action for authorized users
}
```

### Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø± (Route Handlers)

Ø¹Ø§Ù…Ù„ [Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø±](/docs/app/building-your-application/routing/route-handlers) Ø¨Ù†ÙØ³ Ø§Ø¹ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ù…Ø«Ù„ Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (API) Ø§Ù„Ù…ÙˆØ¬Ù‡Ø© Ù„Ù„Ø¬Ù…Ù‡ÙˆØ±ØŒ ÙˆØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ù…ÙˆØ­Ù‹Ø§ Ù„Ù‡ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù…Ø³Ø§Ø±.

Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„:

```ts filename="app/api/route.ts" switcher
import { verifySession } from '@/app/lib/dal'

export async function GET() {
  // User authentication and role verification
  const session = await verifySession()

  // Check if the user is authenticated
  if (!session) {
    // User is not authenticated
    return new Response(null, { status: 401 })
  }

  // Check if the user has the 'admin' role
  if (session.user.role !== 'admin') {
    // User is authenticated but does not have the right permissions
    return new Response(null, { status: 403 })
  }

  // Continue for authorized users
}
```

```js filename="app/api/route.js" switcher
import { verifySession } from '@/app/lib/dal'

export async function GET() {
  // User authentication and role verification
  const session = await verifySession()

  // Check if the user is authenticated
  if (!session) {
    // User is not authenticated
    return new Response(null, { status: 401 })
  }

  // Check if the user has the 'admin' role
  if (session.user.role !== 'admin') {
    // User is authenticated but does not have the right permissions
    return new Response(null, { status: 403 })
  }

  // Continue for authorized users
}
```

ÙŠÙˆØ¶Ø­ Ø§Ù„Ù…Ø«Ø§Ù„ Ø£Ø¹Ù„Ø§Ù‡ Ù…Ø¹Ø§Ù„Ø¬ Ù…Ø³Ø§Ø± Ø¨ÙØ­Øµ Ø£Ù…Ø§Ù† Ù…Ù† Ù…Ø³ØªÙˆÙŠÙŠÙ†. Ø£ÙˆÙ„Ø§Ù‹ ÙŠØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø©ØŒ Ø«Ù… ÙŠØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ù‡ Ù‡Ùˆ 'admin'.

## Ù…ÙˆÙØ±Ùˆ Ø§Ù„Ø³ÙŠØ§Ù‚ (Context Providers)

Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆÙØ±ÙŠ Ø§Ù„Ø³ÙŠØ§Ù‚ Ù„Ù„ØªÙÙˆÙŠØ¶ ÙŠØ¹Ù…Ù„ Ø¨Ø³Ø¨Ø¨ [Ø§Ù„ØªØ¯Ø§Ø®Ù„ (interleaving)](/docs/app/getting-started/server-and-client-components#examples#interleaving-server-and-client-components). ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ ÙØ¥Ù† `context` ÙÙŠ React ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ Ù…Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù‡Ø§ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„.

Ù‡Ø°Ø§ ÙŠØ¹Ù…Ù„ØŒ ÙˆÙ„ÙƒÙ† Ø£ÙŠ Ù…ÙƒÙˆÙ†Ø§Øª Ø®Ø§Ø¯Ù… ÙØ±Ø¹ÙŠØ© Ø³ÙŠØªÙ… ØªØµÙŠÙŠØ±Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹ØŒ ÙˆÙ„Ù† ÙŠÙƒÙˆÙ† Ù„Ø¯ÙŠÙ‡Ø§ ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ù† Ù…ÙˆÙØ± Ø§Ù„Ø³ÙŠØ§Ù‚:

```tsx filename="app/layout.ts" switcher
import { ContextProvider } from 'auth-lib'

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <ContextProvider>{children}</ContextProvider>
      </body>
    </html>
  )
}
```

```tsx filename="app/ui/profile.ts switcher
'use client';

import { useSession } from "auth-lib";

export default function Profile() {
  const { userId } = useSession();
  const { data } = useSWR(`/api/user/${userId}`, fetcher)

  return (
    // ...
  );
}
```

```jsx filename="app/ui/profile.js switcher
'use client';

import { useSession } from "auth-lib";

export default function Profile() {
  const { userId } = useSession();
  const { data } = useSWR(`/api/user/${userId}`, fetcher)

  return (
    // ...
  );
}
```

Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙŠ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ù…Ø«Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„)ØŒ Ø§Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª [`taintUniqueValue`](https://react.dev/reference/react/experimental_taintUniqueValue) ÙÙŠ React Ù„Ù…Ù†Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ù…Ù† Ø§Ù„ØªØ¹Ø±Ø¶ Ù„Ù„Ø¹Ù…ÙŠÙ„.

</AppOnly>

<PagesOnly>

### Ø¥Ù†Ø´Ø§Ø¡ Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (DAL)

#### Ø­Ù…Ø§ÙŠØ© Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (API Routes)

Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙÙŠ Next.js Ø¶Ø±ÙˆØ±ÙŠØ© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ù…Ù† Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ ØªØ£Ù…ÙŠÙ† Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ù„Ø¶Ù…Ø§Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù… ÙÙ‚Ø· ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ¸Ø§Ø¦Ù Ù…Ø­Ø¯Ø¯Ø©. ÙŠØªØ¶Ù…Ù† Ù‡Ø°Ø§ Ø¹Ø§Ø¯Ø©Ù‹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ£Ø°ÙˆÙ†Ø§ØªÙ‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±.

Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ù‹Ø§ Ù„ØªØ£Ù…ÙŠÙ† Ù…Ø³Ø§Ø± ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª:

```ts filename="pages/api/route.ts" switcher
import { NextApiRequest, NextApiResponse } from 'next'

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  const session = await getSession(req)

  // Check if the user is authenticated
  if (!session) {
    res.status(401).json({
      error: 'User is not authenticated',
    })
    return
  }

  // Check if the user has the 'admin' role
  if (session.user.role !== 'admin') {
    res.status(401).json({
      error: 'Unauthorized access: User does not have admin privileges.',
    })
    return
  }

  // Proceed with the route for authorized users
  // ... implementation of the API Route
}
```

```js filename="pages/api/route.js" switcher
export default async function handler(req, res) {
  const session = await getSession(req)

  // Check if the user is authenticated
  if (!session) {
    res.status(401).json({
      error: 'User is not authenticated',
    })
    return
  }

  // Check if the user has the 'admin' role
  if (session.user.role !== 'admin') {
    res.status(401).json({
      error: 'Unauthorized access: User does not have admin privileges.',
    })
    return
  }

  // Proceed with the route for authorized users
  // ... implementation of the API Route
}
```

ÙŠÙˆØ¶Ø­ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø«Ø§Ù„ Ù…Ø³Ø§Ø± ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¨ÙØ­Øµ Ø£Ù…Ø§Ù† Ù…Ù† Ù…Ø³ØªÙˆÙŠÙŠÙ† Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªÙÙˆÙŠØ¶. Ø£ÙˆÙ„Ø§Ù‹ ÙŠØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø©ØŒ Ø«Ù… ÙŠØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ù‡ Ù‡Ùˆ 'admin'. ÙŠØ¶Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù†Ù‡Ø¬ ÙˆØµÙˆÙ„Ø§Ù‹ Ø¢Ù…Ù†Ù‹Ø§ØŒ Ù…Ù‚ØµÙˆØ±Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØµØ§Ø¯Ù‚ Ø¹Ù„ÙŠÙ‡Ù… ÙˆØ§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…ØŒ Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø£Ù…Ø§Ù† Ù‚ÙˆÙŠ Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª.

</PagesOnly>

## Ù…ÙˆØ§Ø±Ø¯

Ø§Ù„Ø¢Ù† Ø¨Ø¹Ø¯ Ø£Ù† ØªØ¹Ù„Ù…Øª Ø¹Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙÙŠ Next.jsØŒ Ø¥Ù„ÙŠÙƒ Ù…ÙƒØªØ¨Ø§Øª ÙˆÙ…ÙˆØ§Ø±Ø¯ Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Next.js Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ØªÙ†ÙÙŠØ° Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø¢Ù…Ù†Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª:

### Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

- [Auth0](https://auth0.com/docs/quickstart/webapp/nextjs/01-login)
- [Better Auth](https://www.better-auth.com/docs/integrations/next)
- [Clerk](https://clerk.com/docs/quickstarts/nextjs)
- [Kinde](https://kinde.com/docs/developer-tools/nextjs-sdk)
- [Logto](https://docs.logto.io/quick-starts/next-app-router)
- [NextAuth.js](https://authjs.dev/getting-started/installation?framework=next.js)
- [Ory](https://www.ory.sh/docs/getting-started/integrate-auth/nextjs)
- [Stack Auth](https://docs.stack-auth.com/getting-started/setup)
- [Supabase](https://supabase.com/docs/guides/getting-started/quickstarts/nextjs)
- [Stytch](https://stytch.com/docs/guides/quickstarts/nextjs)
- [WorkOS](https://workos.com/docs/user-management/nextjs)

### Ù…ÙƒØªØ¨Ø§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª

- [Iron Session](https://github.com/vvo/iron-session)
- [Jose](https://github.com/panva/jose)

## Ù‚Ø±Ø§Ø¡Ø© Ø¥Ø¶Ø§ÙÙŠØ©

Ù„Ù…ÙˆØ§ØµÙ„Ø© Ø§Ù„ØªØ¹Ù„Ù… Ø¹Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„ØªØ§Ù„ÙŠØ©:

- [ÙƒÙŠÙ ØªÙÙƒØ± ÙÙŠ Ø§Ù„Ø£Ù…Ø§Ù† ÙÙŠ Next.js](/blog/security-nextjs-server-components-actions)
- [ÙÙ‡Ù… Ù‡Ø¬Ù…Ø§Øª XSS](https://vercel.com/guides/understanding-xss-attacks)
- [ÙÙ‡Ù… Ù‡Ø¬Ù…Ø§Øª CSRF](https://vercel.com/guides/understanding-csrf-attacks)
- [ÙƒØªØ§Ø¨ ÙƒÙˆØ¨Ù†Ù‡Ø§Ø¬Ù†](https://thecopenhagenbook.com/)
