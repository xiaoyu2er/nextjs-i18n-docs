---
source-updated-at: 2025-05-16T04:52:11.000Z
translation-updated-at: 2025-06-06T17:42:29.388Z
title: ุงููุตุงุฏูุฉ
description: ุชุนูู ููููุฉ ุชูููุฐ ุงููุตุงุฏูุฉ ูู Next.jsุ ุจูุง ูู ุฐูู ุฃูุถู ุงูููุงุฑุณุงุชุ ุชุฃููู ุงููุณุงุฑุงุชุ ุชูููุงุช ุงูุชูููุถุ ูุฅุฏุงุฑุฉ ุงูุฌูุณุงุช.
---

ูุชูููุฐ ุงููุตุงุฏูุฉ ูู Next.jsุ ูุฌุจ ุฃู ุชุชุนุฑู ุนูู ุซูุงุซุฉ ููุงููู ุฃุณุงุณูุฉ:

- **[ุงููุตุงุฏูุฉ](#authentication)** ุชุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูู ูู ูุฏุนู ุฃูู ูู. ุชุชุทูุจ ูู ุงููุณุชุฎุฏู ุฅุซุจุงุช ูููุชู ุจุดูุก ููุชูููุ ูุซู ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ.
- **[ุฅุฏุงุฑุฉ ุงูุฌูุณุฉ](#session-management)** ุชุชุงุจุน ุญุงูุฉ ุงููุณุชุฎุฏู (ูุซู ุชุณุฌูู ุงูุฏุฎูู) ุนุจุฑ ุทูุจุงุช ูุชุนุฏุฏุฉ.
- **[ุงูุชูููุถ](#authorization)** ูุญุฏุฏ ุฃุฌุฒุงุก ุงูุชุทุจูู ุงููุณููุญ ูููุณุชุฎุฏู ุจุงููุตูู ุฅูููุง.

ุชูุถุญ ูุฐู ุงูุตูุญุฉ ููููุฉ ุงุณุชุฎุฏุงู ููุฒุงุช Next.js ูุชูููุฐ ุฃููุงุท ุดุงุฆุนุฉ ูููุตุงุฏูุฉ ูุงูุชูููุถ ูุฅุฏุงุฑุฉ ุงูุฌูุณุงุชุ ุจุญูุซ ููููู ุงุฎุชูุงุฑ ุฃูุถู ุงูุญููู ุจูุงุกู ุนูู ุงุญุชูุงุฌุงุช ุชุทุจููู.

## ุงููุตุงุฏูุฉ

ุงููุตุงุฏูุฉ ุชุชุญูู ูู ูููุฉ ุงููุณุชุฎุฏู. ุชุญุฏุซ ุนูุฏูุง ูููู ุงููุณุชุฎุฏู ุจุชุณุฌูู ุงูุฏุฎููุ ุฅูุง ุจุงุณุชุฎุฏุงู ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ ุฃู ูู ุฎูุงู ุฎุฏูุฉ ูุซู ุฌูุฌู. ุงููุฏู ูู ุงูุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏููู ูู ุจุงููุนู ูู ูุฏุนูู ุฃูููุ ููุง ูุญูู ุจูุงูุงุช ุงููุณุชุฎุฏู ูุงูุชุทุจูู ูู ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู ุฃู ุงูุฃูุดุทุฉ ุงูุงุญุชูุงููุฉ.

### ุงุณุชุฑุงุชูุฌูุงุช ุงููุตุงุฏูุฉ

ุชุณุชุฎุฏู ุชุทุจููุงุช ุงูููุจ ุงูุญุฏูุซุฉ ุนุฏุฉ ุงุณุชุฑุงุชูุฌูุงุช ูููุตุงุฏูุฉ:

1. **OAuth/OpenID Connect (OIDC)**: ุชุชูุญ ุงููุตูู ูู ุทุฑู ุซุงูุซ ุฏูู ูุดุงุฑูุฉ ุจูุงูุงุช ุงุนุชูุงุฏ ุงููุณุชุฎุฏู. ูุซุงููุฉ ูุชุณุฌููุงุช ุงูุฏุฎูู ุนุจุฑ ูุณุงุฆู ุงูุชูุงุตู ุงูุงุฌุชูุงุนู ูุญููู Single Sign-On (SSO). ุชุถูู ุทุจูุฉ ูููุฉ ูุน OpenID Connect.
2. **ุชุณุฌูู ุงูุฏุฎูู ุจุจูุงูุงุช ุงูุงุนุชูุงุฏ (ุงูุจุฑูุฏ ุงูุฅููุชุฑููู + ูููุฉ ุงููุฑูุฑ)**: ุฎูุงุฑ ููุงุณู ูุชุทุจููุงุช ุงูููุจุ ุญูุซ ูููู ุงููุณุชุฎุฏููู ุจุชุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููููุฉ ุงููุฑูุฑ. ูุฃููู ูุณูู ุงูุชูููุฐุ ููููู ูุชุทูุจ ุฅุฌุฑุงุกุงุช ุฃูููุฉ ูููุฉ ุถุฏ ุงูุชูุฏูุฏุงุช ูุซู ุงูุชุตูุฏ ุงูุงุญุชูุงูู.
3. **ุงููุตุงุฏูุฉ ุจุฏูู ูููุฉ ูุฑูุฑ/ูุงุฆูุฉ ุนูู ุงูุฑููุฒ**: ุชุณุชุฎุฏู ุฑูุงุจุท ุณุญุฑูุฉ ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ุฑููุฒ ููุฑุฉ ูุงุญุฏุฉ ุนุจุฑ ุงูุฑุณุงุฆู ุงููุตูุฑุฉ ูููุตูู ุงูุขูู ุจุฏูู ูููุฉ ูุฑูุฑ. ูุดููุฑ ูุฑุงุญุชู ูุฃูุงูู ุงููุนุฒุฒุ ูุณุงุนุฏ ูุฐุง ุงูุฃุณููุจ ูู ุชูููู ุฅุฑูุงู ูููุฉ ุงููุฑูุฑ. ููุฏู ูู ุงูุงุนุชูุงุฏ ุนูู ุชููุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ุงููุงุชู ูููุณุชุฎุฏู.
4. **ููุงุชูุญ ุงููุตูู/WebAuthn**: ุชุณุชุฎุฏู ุจูุงูุงุช ุงุนุชูุงุฏ ุชุดููุฑูุฉ ูุฑูุฏุฉ ููู ูููุนุ ููุง ูููุฑ ุฃูุงููุง ุนุงูููุง ุถุฏ ุงูุชุตูุฏ ุงูุงุญุชูุงูู. ุขูู ููููู ุฌุฏูุฏุ ูุฏ ูููู ุตุนุจ ุงูุชูููุฐ.

ูุฌุจ ุฃู ูุชู ุงุฎุชูุงุฑ ุงุณุชุฑุงุชูุฌูุฉ ุงููุตุงุฏูุฉ ุจูุง ูุชูุงูู ูุน ูุชุทูุจุงุช ุชุทุจููู ุงููุญุฏุฏุฉุ ูุงุนุชุจุงุฑุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏูุ ูุงูุฃูุฏุงู ุงูุฃูููุฉ.

### ุชูููุฐ ุงููุตุงุฏูุฉ

ูู ูุฐุง ุงููุณูุ ุณูุณุชูุดู ุนูููุฉ ุฅุถุงูุฉ ูุตุงุฏูุฉ ุฃุณุงุณูุฉ ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููููุฉ ุงููุฑูุฑ ุฅูู ุชุทุจูู ููุจ. ุจูููุง ุชููุฑ ูุฐู ุงูุทุฑููุฉ ูุณุชูู ุฃุณุงุณููุง ูู ุงูุฃูุงูุ ูุฌุฏุฑ ุงููุธุฑ ูู ุฎูุงุฑุงุช ุฃูุซุฑ ุชูุฏููุง ูุซู OAuth ุฃู ุชุณุฌููุงุช ุงูุฏุฎูู ุจุฏูู ูููุฉ ูุฑูุฑ ููุฒูุฏ ูู ุงูุญูุงูุฉ ุถุฏ ุงูุชูุฏูุฏุงุช ุงูุฃูููุฉ ุงูุดุงุฆุนุฉ. ุชุฏูู ุงููุตุงุฏูุฉ ุงูุฐู ุณููุงูุดู ูู ููุง ููู:

<PagesOnly>

1. ูููู ุงููุณุชุฎุฏู ุจุฅุฑุณุงู ุจูุงูุงุช ุงุนุชูุงุฏู ุนุจุฑ ูููุฐุฌ ุชุณุฌูู ุงูุฏุฎูู.
2. ูุฑุณู ุงููููุฐุฌ ุทูุจูุง ูุชู ูุนุงูุฌุชู ุจูุงุณุทุฉ ูุณุงุฑ API.
3. ุนูุฏ ุงูุชุญูู ุงููุงุฌุญุ ุชูุชูู ุงูุนูููุฉุ ููุง ูุดูุฑ ุฅูู ูุฌุงุญ ูุตุงุฏูุฉ ุงููุณุชุฎุฏู.
4. ุฅุฐุง ูุดู ุงูุชุญููุ ูุชู ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ.

ุถุน ูู ุงุนุชุจุงุฑู ูููุฐุฌ ุชุณุฌูู ุฏุฎูู ุญูุซ ูููู ูููุณุชุฎุฏููู ุฅุฏุฎุงู ุจูุงูุงุช ุงุนุชูุงุฏูู:

```tsx filename="pages/login.tsx" switcher
import { FormEvent } from 'react'
import { useRouter } from 'next/router'

export default function LoginPage() {
  const router = useRouter()

  async function handleSubmit(event: FormEvent<HTMLFormElement>) {
    event.preventDefault()

    const formData = new FormData(event.currentTarget)
    const email = formData.get('email')
    const password = formData.get('password')

    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password }),
    })

    if (response.ok) {
      router.push('/profile')
    } else {
      // Handle errors
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type="email" name="email" placeholder="Email" required />
      <input type="password" name="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
  )
}
```

```jsx filename="pages/login.jsx" switcher
import { FormEvent } from 'react'
import { useRouter } from 'next/router'

export default function LoginPage() {
  const router = useRouter()

  async function handleSubmit(event) {
    event.preventDefault()

    const formData = new FormData(event.currentTarget)
    const email = formData.get('email')
    const password = formData.get('password')

    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password }),
    })

    if (response.ok) {
      router.push('/profile')
    } else {
      // Handle errors
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type="email" name="email" placeholder="Email" required />
      <input type="password" name="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
  )
}
```

ูุญุชูู ุงููููุฐุฌ ุฃุนูุงู ุนูู ุญูููู ุฅุฏุฎุงู ูุฌูุน ุจุฑูุฏ ุงููุณุชุฎุฏู ุงูุฅููุชุฑููู ููููุฉ ุงููุฑูุฑ. ุนูุฏ ุงูุฅุฑุณุงูุ ูููู ุจุชุดุบูู ูุธููุฉ ุชุฑุณู ุทูุจ POST ุฅูู ูุณุงุฑ API (`/api/auth/login`).

ููููู ุจุนุฏ ุฐูู ุงุณุชุฏุนุงุก ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ููููุฑ ุงููุตุงุฏูุฉ ูู ูุณุงุฑ API ููุนุงูุฌุฉ ุงููุตุงุฏูุฉ:

```ts filename="pages/api/auth/login.ts" switcher
import { NextApiRequest, NextApiResponse } from 'next'
import { signIn } from '@/auth'

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  try {
    const { email, password } = req.body
    await signIn('credentials', { email, password })

    res.status(200).json({ success: true })
  } catch (error) {
    if (error.type === 'CredentialsSignin') {
      res.status(401).json({ error: 'Invalid credentials.' })
    } else {
      res.status(500).json({ error: 'Something went wrong.' })
    }
  }
}
```

```js filename="pages/api/auth/login.js" switcher
import { signIn } from '@/auth'

export default async function handler(req, res) {
  try {
    const { email, password } = req.body
    await signIn('credentials', { email, password })

    res.status(200).json({ success: true })
  } catch (error) {
    if (error.type === 'CredentialsSignin') {
      res.status(401).json({ error: 'Invalid credentials.' })
    } else {
      res.status(500).json({ error: 'Something went wrong.' })
    }
  }
}
```

</PagesOnly>

<AppOnly>

1. ูููู ุงููุณุชุฎุฏู ุจุฅุฑุณุงู ุจูุงูุงุช ุงุนุชูุงุฏู ุนุจุฑ ูููุฐุฌ ุชุณุฌูู ุงูุฏุฎูู.
2. ูุณุชุฏุนู ุงููููุฐุฌ ุฅุฌุฑุงุก ุฎุงุฏู (Server Action).
3. ุนูุฏ ุงูุชุญูู ุงููุงุฌุญุ ุชูุชูู ุงูุนูููุฉุ ููุง ูุดูุฑ ุฅูู ูุฌุงุญ ูุตุงุฏูุฉ ุงููุณุชุฎุฏู.
4. ุฅุฐุง ูุดู ุงูุชุญููุ ูุชู ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ.

ุถุน ูู ุงุนุชุจุงุฑู ูููุฐุฌ ุชุณุฌูู ุฏุฎูู ุญูุซ ูููู ูููุณุชุฎุฏููู ุฅุฏุฎุงู ุจูุงูุงุช ุงุนุชูุงุฏูู:

```tsx filename="app/login/page.tsx" switcher
import { authenticate } from '@/app/lib/actions'

export default function Page() {
  return (
    <form action={authenticate}>
      <input type="email" name="email" placeholder="Email" required />
      <input type="password" name="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
  )
}
```

```jsx filename="app/login/page.jsx" switcher
import { authenticate } from '@/app/lib/actions'

export default function Page() {
  return (
    <form action={authenticate}>
      <input type="email" name="email" placeholder="Email" required />
      <input type="password" name="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
  )
}
```

ูุญุชูู ุงููููุฐุฌ ุฃุนูุงู ุนูู ุญูููู ุฅุฏุฎุงู ูุฌูุน ุจุฑูุฏ ุงููุณุชุฎุฏู ุงูุฅููุชุฑููู ููููุฉ ุงููุฑูุฑ. ุนูุฏ ุงูุฅุฑุณุงูุ ูุณุชุฏุนู ุฅุฌุฑุงุก ุงูุฎุงุฏู `authenticate`.

ููููู ุจุนุฏ ุฐูู ุงุณุชุฏุนุงุก ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ููููุฑ ุงููุตุงุฏูุฉ ูู ุฅุฌุฑุงุก ุงูุฎุงุฏู ููุนุงูุฌุฉ ุงููุตุงุฏูุฉ:

```ts filename="app/lib/actions.ts" switcher
'use server'

import { signIn } from '@/auth'

export async function authenticate(_currentState: unknown, formData: FormData) {
  try {
    await signIn('credentials', formData)
  } catch (error) {
    if (error) {
      switch (error.type) {
        case 'CredentialsSignin':
          return 'Invalid credentials.'
        default:
          return 'Something went wrong.'
      }
    }
    throw error
  }
}
```

```js filename="app/lib/actions.js" switcher
'use server'

import { signIn } from '@/auth'

export async function authenticate(_currentState, formData) {
  try {
    await signIn('credentials', formData)
  } catch (error) {
    if (error) {
      switch (error.type) {
        case 'CredentialsSignin':
          return 'Invalid credentials.'
        default:
          return 'Something went wrong.'
      }
    }
    throw error
  }
}
```

</AppOnly>

ูู ูุฐุง ุงูููุฏุ ุชุชุญูู ุทุฑููุฉ `signIn` ูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ ููุงุจู ุจูุงูุงุช ุงููุณุชุฎุฏู ุงููุฎุฒูุฉ.
ุจุนุฏ ูุนุงูุฌุฉ ูููุฑ ุงููุตุงุฏูุฉ ูุจูุงูุงุช ุงูุงุนุชูุงุฏุ ููุงู ูุชูุฌุชุงู ูุญุชููุชุงู:

- **ุงููุตุงุฏูุฉ ุงููุงุฌุญุฉ**: ุชุนูู ูุฐู ุงููุชูุฌุฉ ุฃู ุชุณุฌูู ุงูุฏุฎูู ูุงู ูุงุฌุญูุง. ูููู ุจุนุฏ ุฐูู ุจุฏุก ุฅุฌุฑุงุกุงุช ุฅุถุงููุฉุ ูุซู ุงููุตูู ุฅูู ุงููุณุงุฑุงุช ุงููุญููุฉ ูุฌูุจ ูุนูููุงุช ุงููุณุชุฎุฏู.
- **ุงููุตุงุฏูุฉ ุงููุงุดูุฉ**: ูู ุงูุญุงูุงุช ุงูุชู ุชููู ูููุง ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุบูุฑ ุตุญูุญุฉ ุฃู ูุชู ููุงุฌูุฉ ุฎุทุฃุ ุชููู ุงููุธููุฉ ุจุฅุฑุฌุงุน ุฑุณุงูุฉ ุฎุทุฃ ููุงุจูุฉ ููุฅุดุงุฑุฉ ุฅูู ูุดู ุงููุตุงุฏูุฉ.

<AppOnly>

ุฃุฎูุฑูุงุ ูู ูููู `login-form.tsx` ุงูุฎุงุต ุจูุ ููููู ุงุณุชุฎุฏุงู `useFormState` ูู React ูุงุณุชุฏุนุงุก ุฅุฌุฑุงุก ุงูุฎุงุฏู ูุงูุชุนุงูู ูุน ุฃุฎุทุงุก ุงููููุฐุฌุ ูุงุณุชุฎุฏุงู `useFormStatus` ููุชุนุงูู ูุน ุญุงูุฉ ุงูุงูุชุธุงุฑ ูููููุฐุฌ:

```tsx filename="app/login/page.tsx" switcher
'use client'

import { authenticate } from '@/app/lib/actions'
import { useFormState, useFormStatus } from 'react-dom'

export default function Page() {
  const [errorMessage, dispatch] = useFormState(authenticate, undefined)

  return (
    <form action={dispatch}>
      <input type="email" name="email" placeholder="Email" required />
      <input type="password" name="password" placeholder="Password" required />
      <div>{errorMessage && <p>{errorMessage}</p>}</div>
      <LoginButton />
    </form>
  )
}

function LoginButton() {
  const { pending } = useFormStatus()

  const handleClick = (event) => {
    if (pending) {
      event.preventDefault()
    }
  }

  return (
    <button aria-disabled={pending} type="submit" onClick={handleClick}>
      Login
    </button>
  )
}
```

```jsx filename="app/login/page.jsx" switcher
'use client'

import { authenticate } from '@/app/lib/actions'
import { useFormState, useFormStatus } from 'react-dom'

export default function Page() {
  const [errorMessage, dispatch] = useFormState(authenticate, undefined)

  return (
    <form action={dispatch}>
      <input type="email" name="email" placeholder="Email" required />
      <input type="password" name="password" placeholder="Password" required />
      <div>{errorMessage && <p>{errorMessage}</p>}</div>
      <LoginButton />
    </form>
  )
}

function LoginButton() {
  const { pending } = useFormStatus()

  const handleClick = (event) => {
    if (pending) {
      event.preventDefault()
    }
  }

  return (
    <button aria-disabled={pending} type="submit" onClick={handleClick}>
      Login
    </button>
  )
}
```

</AppOnly>

ูุฅุนุฏุงุฏ ูุตุงุฏูุฉ ูุจุณุทุฉ ูู ูุดุงุฑูุน Next.jsุ ุฎุงุตุฉ ุนูุฏ ุชูุฏูู ุทุฑู ูุชุนุฏุฏุฉ ูุชุณุฌูู ุงูุฏุฎููุ ููุฑ ูู ุงุณุชุฎุฏุงู [ุญู ูุตุงุฏูุฉ ุดุงูู](#examples).

## ุงูุชูููุถ

ุจูุฌุฑุฏ ูุตุงุฏูุฉ ุงููุณุชุฎุฏูุ ุณุชุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏู ูุณููุญ ูู ุจุฒูุงุฑุฉ ูุณุงุฑุงุช ูุนููุฉุ ูุฃุฏุงุก ุนูููุงุช ูุซู ุชุนุฏูู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุฅุฌุฑุงุกุงุช ุงูุฎุงุฏู ูุงุณุชุฏุนุงุก ูุนุงูุฌุงุช ุงููุณุงุฑ.

### ุญูุงูุฉ ุงููุณุงุฑุงุช ุจุงุณุชุฎุฏุงู Middleware

[ุงููุณูุท (Middleware)](/docs/app/building-your-application/routing/middleware) ูู Next.js ูุณุงุนุฏู ูู ุงูุชุญูู ูู ูู ููููู ุงููุตูู ุฅูู ุฃุฌุฒุงุก ูุฎุชููุฉ ูู ูููุนู. ูุฐุง ููู ููุญูุงุธ ุนูู ููุงุทู ูุซู ููุญุฉ ุชุญูู ุงููุณุชุฎุฏู ูุญููุฉ ุจูููุง ุชููู ุตูุญุงุช ุฃุฎุฑู ูุซู ุตูุญุงุช ุงูุชุณููู ุนุงูุฉ. ููุตู ุจุชุทุจูู Middleware ุนูู ุฌููุน ุงููุณุงุฑุงุช ูุชุญุฏูุฏ ุงุณุชุซูุงุกุงุช ูููุตูู ุงูุนุงู.

ุฅููู ููููุฉ ุชูููุฐ Middleware ูููุตุงุฏูุฉ ูู Next.js:

#### ุฅุนุฏุงุฏ Middleware:

- ุฃูุดุฆ ููู `middleware.ts` ุฃู `.js` ูู ุงูุฏููู ุงูุฌุฐุฑ ููุดุฑูุนู.
- ุฃุถู ููุทููุง ููุชุญูู ูู ุตูุงุญูุงุช ูุตูู ุงููุณุชุฎุฏูุ ูุซู ุงูุชุญูู ูู ูุฌูุฏ ุฑูุฒ ูุตุงุฏูุฉ.

#### ุชุญุฏูุฏ ุงููุณุงุฑุงุช ุงููุญููุฉ:

- ููุณ ูู ุงููุณุงุฑุงุช ุชุชุทูุจ ุชูููุถูุง. ุงุณุชุฎุฏู ุฎูุงุฑ `matcher` ูู Middleware ูุชุญุฏูุฏ ุฃู ูุณุงุฑุงุช ูุง ุชุชุทูุจ ูุญุต ุงูุชูููุถ.

#### ููุทู Middleware:

- ุงูุชุจ ููุทููุง ููุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุงุฏููุง ุนููู. ุชุญูู ูู ุฃุฏูุงุฑ ุงููุณุชุฎุฏููู ุฃู ุงูุตูุงุญูุงุช ูุชุฎููู ุงููุณุงุฑ.

#### ุงูุชุนุงูู ูุน ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู:

- ุฃุนุฏ ุชูุฌูู ุงููุณุชุฎุฏููู ุบูุฑ ุงููุตุฑุญ ููู ุฅูู ุตูุญุฉ ุชุณุฌูู ุฏุฎูู ุฃู ุตูุญุฉ ุฎุทุฃ ุญุณุจ ุงูุงูุชุถุงุก.

ูุซุงู ูููู Middleware:

```ts filename="middleware.ts" switcher
import type { NextRequest } from 'next/server'

export function middleware(request: NextRequest) {
  const currentUser = request.cookies.get('currentUser')?.value

  if (currentUser && !request.nextUrl.pathname.startsWith('/dashboard')) {
    return Response.redirect(new URL('/dashboard', request.url))
  }

  if (!currentUser && !request.nextUrl.pathname.startsWith('/login')) {
    return Response.redirect(new URL('/login', request.url))
  }
}

export const config = {
  matcher: ['/((?!api|_next/static|_next/image|.*\\.png$).*)'],
}
```

```js filename="middleware.js" switcher
export function middleware(request) {
  const currentUser = request.cookies.get('currentUser')?.value

  if (currentUser && !request.nextUrl.pathname.startsWith('/dashboard')) {
    return Response.redirect(new URL('/dashboard', request.url))
  }

  if (!currentUser && !request.nextUrl.pathname.startsWith('/login')) {
    return Response.redirect(new URL('/login', request.url))
  }
}

export const config = {
  matcher: ['/((?!api|_next/static|_next/image|.*\\.png$).*)'],
}
```

ูุณุชุฎุฏู ูุฐุง ุงููุซุงู [`Response.redirect`](https://developer.mozilla.org/en-US/docs/Web/API/Response/redirect_static) ููุชุนุงูู ูุน ุฅุนุงุฏุฉ ุงูุชูุฌูู ูุจูุฑูุง ูู ุฎุท ุงูุทูุจุ ููุง ูุฌุนูู ูุนุงููุง ููุฑูุฒููุง ููุชุญูู ูู ุงููุตูู.

<AppOnly>

ูุงุญุชูุงุฌุงุช ุฅุนุงุฏุฉ ุงูุชูุฌูู ุงููุญุฏุฏุฉุ ูููู ุงุณุชุฎุฏุงู ูุธููุฉ `redirect` ูู ููููุงุช ุงูุฎุงุฏู ููุนุงูุฌุงุช ุงููุณุงุฑ ูุฅุฌุฑุงุกุงุช ุงูุฎุงุฏู ูุชูููุฑ ุชุญูู ุฃูุจุฑ. ูุฐุง ูููุฏ ููุชููู ุงููุงุฆู ุนูู ุงูุฃุฏูุงุฑ ุฃู ุงูุณููุงุฑูููุงุช ุงูุญุณุงุณุฉ ููุณูุงู.

```ts filename="app/page.tsx" switcher
import { redirect } from 'next/navigation'

export default function Page() {
  // ููุทู ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชูุฌูู
  const accessDenied = true
  if (accessDenied) {
    redirect('/login')
  }

  // ุชุญุฏูุฏ ูุณุงุฑุงุช ุฃุฎุฑู ูููุทู
}
```

```js filename="app/page.jsx" switcher
import { redirect } from 'next/navigation'

export default function Page() {
  // ููุทู ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชูุฌูู
  const accessDenied = true
  if (accessDenied) {
    redirect('/login')
  }

  // ุชุญุฏูุฏ ูุณุงุฑุงุช ุฃุฎุฑู ูููุทู
}
```

</AppOnly>

ุจุนุฏ ุงููุตุงุฏูุฉ ุงููุงุฌุญุฉุ ูู ุงูููู ุฅุฏุงุฑุฉ ุชููู ุงููุณุชุฎุฏู ุจูุงุกู ุนูู ุฃุฏูุงุฑู. ุนูู ุณุจูู ุงููุซุงูุ ูุฏ ูุชู ุฅุนุงุฏุฉ ุชูุฌูู ูุณุชุฎุฏู ูุณุคูู ุฅูู ููุญุฉ ุชุญูู ุงููุณุคููุ ุจูููุง ูุชู ุฅุฑุณุงู ูุณุชุฎุฏู ุนุงุฏู ุฅูู ุตูุญุฉ ูุฎุชููุฉ. ูุฐุง ููู ููุชุฌุงุฑุจ ุงูุฎุงุตุฉ ุจุงูุฃุฏูุงุฑ ูุงูุชููู ุงููุดุฑูุทุ ูุซู ูุทุงูุจุฉ ุงููุณุชุฎุฏููู ุจุฅููุงู ููููู ุงูุดุฎุตู ุฅุฐุง ูุฒู ุงูุฃูุฑ.

ุนูุฏ ุฅุนุฏุงุฏ ุงูุชูููุถุ ูู ุงูููู ุงูุชุฃูุฏ ูู ุฃู ุงููุญูุตุงุช ุงูุฃูููุฉ ุงูุฑุฆูุณูุฉ ุชุญุฏุซ ุญูุซ ูุตู ุชุทุจููู ุฅูู ุงูุจูุงูุงุช ุฃู ูุบูุฑูุง. ุจูููุง ูููู ุฃู ูููู Middleware ูููุฏูุง ููุชุญูู ุงูุฃูููุ ูุง ูุฌุจ ุฃู ูููู ุฎุท ุงูุฏูุงุน ุงููุญูุฏ ูู ุญูุงูุฉ ุจูุงูุงุชู. ูุฌุจ ุชูููุฐ ุงูุฌุฒุก ุงูุฃูุจุฑ ูู ุงููุญูุตุงุช ุงูุฃูููุฉ ูู ุทุจูุฉ ุงููุตูู ุฅูู ุงูุจูุงูุงุช (DAL).

<PagesOnly>

### ุญูุงูุฉ ูุณุงุฑุงุช ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API Routes)

ุชูุนุฏ ูุณุงุฑุงุช ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API Routes) ูู Next.js ุถุฑูุฑูุฉ ููุชุนุงูู ูุน ุงูููุทู ูู ุฌุงูุจ ุงูุฎุงุฏู ูุฅุฏุงุฑุฉ ุงูุจูุงูุงุช. ูู ุงูุฃูููุฉ ุจููุงู ุชุฃููู ูุฐู ุงููุณุงุฑุงุช ูุถูุงู ุฃู ุงููุณุชุฎุฏููู ุงููุตุฑุญ ููู ููุท ูููููู ุงููุตูู ุฅูู ุงููุธุงุฆู ุงููุญุฏุฏุฉ. ูุชุถูู ุฐูู ุนุงุฏุฉู ุงูุชุญูู ูู ุญุงูุฉ ูุตุงุฏูุฉ ุงููุณุชุฎุฏู ูุฃุฐููุงุชู ุงููุณุชูุฏุฉ ุฅูู ุงูุฃุฏูุงุฑ.

ุฅููู ูุซุงููุง ูุชุฃููู ูุณุงุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช:

```ts filename="pages/api/route.ts" switcher
import { NextApiRequest, NextApiResponse } from 'next'

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  const session = await getSession(req)

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุงุฏููุง ุนููู
  if (!session) {
    res.status(401).json({
      error: 'User is not authenticated',
    })
    return
  }

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ูููุณุชุฎุฏู ุฏูุฑ 'admin'
  if (session.user.role !== 'admin') {
    res.status(401).json({
      error: 'Unauthorized access: User does not have admin privileges.',
    })
    return
  }

  // ุงููุชุงุจุนุฉ ูุน ุงููุณุงุฑ ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู
  // ... ุชูููุฐ ูุณุงุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช
}
```

```js filename="pages/api/route.js" switcher
export default async function handler(req, res) {
  const session = await getSession(req)

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุงุฏููุง ุนููู
  if (!session) {
    res.status(401).json({
      error: 'User is not authenticated',
    })
    return
  }

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ูููุณุชุฎุฏู ุฏูุฑ 'admin'
  if (session.user.role !== 'admin') {
    res.status(401).json({
      error: 'Unauthorized access: User does not have admin privileges.',
    })
    return
  }

  // ุงููุชุงุจุนุฉ ูุน ุงููุณุงุฑ ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู
  // ... ุชูููุฐ ูุณุงุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช
}
```

ููุธูุฑ ูุฐุง ูุซุงููุง ููุณุงุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุน ูุญุต ุฃููู ูู ูุณุชูููู ูููุตุงุฏูุฉ ูุงูุชูููุถ. ูููู ุฃููุงู ุจุงูุชุญูู ูู ูุฌูุฏ ุฌูุณุฉ ูุดุทุฉุ ุซู ูุชุฃูุฏ ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุงููุณุฌู ูุฏูู ุฏูุฑ 'admin'. ูุถูู ูุฐุง ุงูููุฌ ูุตููุงู ุขูููุงุ ูุญุฏูุฏูุง ุจุงููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู ูุงููุตุฑุญ ูููุ ููุง ูุญุงูุธ ุนูู ุฃูุงู ููู ููุนุงูุฌุฉ ุงูุทูุจุงุช.

</PagesOnly>

<AppOnly>

ูุฏุนู ูุฐุง ุงูููุฌุ ุงููุฐููุฑ ูู [ูุฐู ุงููุฏููุฉ ุงูุฃูููุฉ](/blog/security-nextjs-server-components-actions)ุ ุฅูู ุชูุญูุฏ ุฌููุน ุนูููุงุช ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุถูู ุทุจูุฉ ูุตูู ุฅูู ุงูุจูุงูุงุช (DAL) ูุฎุตุตุฉ. ุชุถูู ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉ ูุตููุงู ูุชุณููุง ุฅูู ุงูุจูุงูุงุชุ ูุชููู ูู ุงูุฃุฎุทุงุก ุงููุชุนููุฉ ุจุงูุชูููุถุ ูุชูุจุณุท ุงูุตูุงูุฉ. ูุถูุงู ุฃูุงู ุดุงููุ ุถุน ูู ุงูุงุนุชุจุงุฑ ุงููุฌุงูุงุช ุงูุฑุฆูุณูุฉ ุงูุชุงููุฉ:

- ุฅุฌุฑุงุกุงุช ุงูุฎุงุฏู (Server Actions): ูู ุจุชูููุฐ ูุญูุตุงุช ุฃูููุฉ ูู ุงูุนูููุงุช ูู ุฌุงูุจ ุงูุฎุงุฏูุ ุฎุงุตุฉ ููุนูููุงุช ุงูุญุณุงุณุฉ.
- ูุนุงูุฌุงุช ุงููุณุงุฑุงุช (Route Handlers): ุฅุฏุงุฑุฉ ุงูุทูุจุงุช ุงููุงุฑุฏุฉ ูุน ุชุฏุงุจูุฑ ุฃูููุฉ ูุถูุงู ุฃู ุงููุตูู ูุญุฏูุฏ ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู.
- ุทุจูุฉ ุงููุตูู ุฅูู ุงูุจูุงูุงุช (DAL): ุชุชูุงุนู ูุจุงุดุฑุฉ ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ููู ุถุฑูุฑูุฉ ููุชุญูู ูู ุตุญุฉ ุงููุนุงููุงุช ุงูุจูุงูุงุชูุฉ ูุงูุชุตุฑูุญ ุจูุง. ูู ุงูุญููู ุฅุฌุฑุงุก ูุญูุตุงุช ุญุฑุฌุฉ ุฏุงุฎู ุทุจูุฉ ุงููุตูู ุฅูู ุงูุจูุงูุงุช ูุชุฃููู ุงูุจูุงูุงุช ูู ููุทุฉ ุงูุชูุงุนู ุงูุฃูุซุฑ ุฃูููุฉ - ุงููุตูู ุฃู ุงูุชุนุฏูู.

ููุญุตูู ุนูู ุฏููู ููุตู ุญูู ุชุฃููู ุทุจูุฉ ุงููุตูู ุฅูู ุงูุจูุงูุงุชุ ุจูุง ูู ุฐูู ููุงุฐุฌ ุงูุฃููุงุฏ ูููุงุฑุณุงุช ุงูุฃูุงู ุงููุชูุฏูุฉุ ุฑุงุฌุน [ูุณู ุทุจูุฉ ุงููุตูู ุฅูู ุงูุจูุงูุงุช](/blog/security-nextjs-server-components-actions#data-access-layer) ูู ุฏููู ุงูุฃูุงู.

### ุญูุงูุฉ ุฅุฌุฑุงุกุงุช ุงูุฎุงุฏู (Server Actions)

ูู ุงูููู ุงูุชุนุงูู ูุน [ุฅุฌุฑุงุกุงุช ุงูุฎุงุฏู](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) ุจููุณ ุงุนุชุจุงุฑุงุช ุงูุฃูุงู ูุซู ููุงุท ููุงูุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูููุฌูุฉ ููุฌูููุฑ. ุงูุชุญูู ูู ุชูููุถ ุงููุณุชุฎุฏู ููู ุฅุฌุฑุงุก ุฃูุฑ ุจุงูุบ ุงูุฃูููุฉ. ูู ุจุชูููุฐ ูุญูุตุงุช ุฏุงุฎู ุฅุฌุฑุงุกุงุช ุงูุฎุงุฏู ูุชุญุฏูุฏ ุฃุฐููุงุช ุงููุณุชุฎุฏูุ ูุซู ุชูููุฏ ุจุนุถ ุงูุฅุฌุฑุงุกุงุช ููุณุชุฎุฏูู 'admin'.

ูู ุงููุซุงู ุฃุฏูุงูุ ูุชุญูู ูู ุฏูุฑ ุงููุณุชุฎุฏู ูุจู ุงูุณูุงุญ ุจุชูููุฐ ุงูุฅุฌุฑุงุก:

```ts filename="app/lib/actions.ts" switcher
'use server'

// ...

export async function serverAction() {
  const session = await getSession()
  const userRole = session?.user?.role

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุฑุญูุง ูู ุจุชูููุฐ ุงูุฅุฌุฑุงุก
  if (userRole !== 'admin') {
    throw new Error('Unauthorized access: User does not have admin privileges.')
  }

  // ุงููุชุงุจุนุฉ ูุน ุงูุฅุฌุฑุงุก ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู
  // ... ุชูููุฐ ุงูุฅุฌุฑุงุก
}
```

```js filename="app/lib/actions.js" switcher
'use server'

// ...

export async function serverAction() {
  const session = await getSession()
  const userRole = session?.user?.role

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุฑุญูุง ูู ุจุชูููุฐ ุงูุฅุฌุฑุงุก
  if (userRole !== 'admin') {
    throw new Error('Unauthorized access: User does not have admin privileges.')
  }

  // ุงููุชุงุจุนุฉ ูุน ุงูุฅุฌุฑุงุก ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู
  // ... ุชูููุฐ ุงูุฅุฌุฑุงุก
}
```

### ุญูุงูุฉ ูุนุงูุฌุงุช ุงููุณุงุฑุงุช (Route Handlers)

ุชูุนุจ ูุนุงูุฌุงุช ุงููุณุงุฑุงุช ูู Next.js ุฏูุฑูุง ุญููููุง ูู ุฅุฏุงุฑุฉ ุงูุทูุจุงุช ุงููุงุฑุฏุฉ. ุชูุงููุง ูุซู ุฅุฌุฑุงุกุงุช ุงูุฎุงุฏูุ ูุฌุจ ุชุฃููููุง ูุถูุงู ุฃู ุงููุณุชุฎุฏููู ุงููุตุฑุญ ููู ููุท ูููููู ุงููุตูู ุฅูู ูุธุงุฆู ูุนููุฉ. ูุชุถูู ุฐูู ุนุงุฏุฉู ุงูุชุญูู ูู ุญุงูุฉ ูุตุงุฏูุฉ ุงููุณุชุฎุฏู ูุฃุฐููุงุชู.

ุฅููู ูุซุงููุง ูุชุฃููู ูุนุงูุฌ ูุณุงุฑ:

```ts filename="app/api/route.ts" switcher
export async function GET() {
  // ูุตุงุฏูุฉ ุงููุณุชุฎุฏู ูุงูุชุญูู ูู ุงูุฏูุฑ
  const session = await getSession()

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุงุฏููุง ุนููู
  if (!session) {
    return new Response(null, { status: 401 }) // ุงููุณุชุฎุฏู ุบูุฑ ูุตุงุฏู ุนููู
  }

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ูููุณุชุฎุฏู ุฏูุฑ 'admin'
  if (session.user.role !== 'admin') {
    return new Response(null, { status: 403 }) // ุงููุณุชุฎุฏู ูุตุงุฏู ุนููู ูููู ููุณ ูุฏูู ุงูุฃุฐููุงุช ุงูุตุญูุญุฉ
  }

  // ุฌูุจ ุงูุจูุงูุงุช ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู
}
```

```js filename="app/api/route.js" switcher
export async function GET() {
  // ูุตุงุฏูุฉ ุงููุณุชุฎุฏู ูุงูุชุญูู ูู ุงูุฏูุฑ
  const session = await getSession()

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุงุฏููุง ุนููู
  if (!session) {
    return new Response(null, { status: 401 }) // ุงููุณุชุฎุฏู ุบูุฑ ูุตุงุฏู ุนููู
  }

  // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ูููุณุชุฎุฏู ุฏูุฑ 'admin'
  if (session.user.role !== 'admin') {
    return new Response(null, { status: 403 }) // ุงููุณุชุฎุฏู ูุตุงุฏู ุนููู ูููู ููุณ ูุฏูู ุงูุฃุฐููุงุช ุงูุตุญูุญุฉ
  }

  // ุฌูุจ ุงูุจูุงูุงุช ูููุณุชุฎุฏููู ุงููุตุฑุญ ููู
}
```

ููุธูุฑ ูุฐุง ูุซุงููุง ููุนุงูุฌ ูุณุงุฑ ูุน ูุญุต ุฃููู ูู ูุณุชูููู ูููุตุงุฏูุฉ ูุงูุชูููุถ. ูููู ุฃููุงู ุจุงูุชุญูู ูู ูุฌูุฏ ุฌูุณุฉ ูุดุทุฉุ ุซู ูุชุฃูุฏ ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุงููุณุฌู ูุฏูู ุฏูุฑ 'admin'. ูุถูู ูุฐุง ุงูููุฌ ูุตููุงู ุขูููุงุ ูุญุฏูุฏูุง ุจุงููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู ูุงููุตุฑุญ ูููุ ููุง ูุญุงูุธ ุนูู ุฃูุงู ููู ููุนุงูุฌุฉ ุงูุทูุจุงุช.

### ุงูุชูููุถ ุจุงุณุชุฎุฏุงู ููููุงุช ุงูุฎุงุฏู (Server Components)

ุชู ุชุตููู [ููููุงุช ุงูุฎุงุฏู](/docs/app/building-your-application/rendering/server-components) ูู Next.js ููุชูููุฐ ูู ุฌุงูุจ ุงูุฎุงุฏู ูุชููุฑ ุจูุฆุฉ ุขููุฉ ูุฏูุฌ ุงูููุทู ุงููุนูุฏ ูุซู ุงูุชูููุถ. ุชููู ูู ุงููุตูู ุงููุจุงุดุฑ ุฅูู ููุงุฑุฏ ุงูุฎูููุฉุ ููุง ูุญุณู ุงูุฃุฏุงุก ููููุงู ุงูุซูููุฉ ุงูุจูุงูุงุช ููุนุฒุฒ ุงูุฃูุงู ููุนูููุงุช ุงูุญุณุงุณุฉ.

ูู ููููุงุช ุงูุฎุงุฏูุ ูู ุงูููุงุฑุณุงุช ุงูุดุงุฆุนุฉ ุนุฑุถ ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจุดูู ูุดุฑูุท ุจูุงุกู ุนูู ุฏูุฑ ุงููุณุชุฎุฏู. ูุนุฒุฒ ูุฐุง ุงูููุฌ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ูุงูุฃูุงู ูู ุฎูุงู ุถูุงู ูุตูู ุงููุณุชุฎุฏููู ููุท ุฅูู ุงููุญุชูู ุงูุฐู ููุตุฑุญ ููู ุจูุดุงูุฏุชู.

**ูุซุงู:**

```tsx filename="app/dashboard/page.tsx" switcher
export default async function Dashboard() {
  const session = await getSession()
  const userRole = session?.user?.role // ุจุงูุชุฑุงุถ ุฃู 'role' ุฌุฒุก ูู ูุงุฆู ุงูุฌูุณุฉ

  if (userRole === 'admin') {
    return <AdminDashboard /> // ูููู ููุณุชุฎุฏูู 'admin'
  } else if (userRole === 'user') {
    return <UserDashboard /> // ูููู ูููุณุชุฎุฏููู ุงูุนุงุฏููู
  } else {
    return <AccessDenied /> // ูููู ููุธูุฑ ููุตูู ุบูุฑ ูุตุฑุญ ุจู
  }
}
```

```jsx filename="app/dashboard/page.jsx" switcher
export default function Dashboard() {
  const session = await getSession()
  const userRole = session?.user?.role // ุจุงูุชุฑุงุถ ุฃู 'role' ุฌุฒุก ูู ูุงุฆู ุงูุฌูุณุฉ

  if (userRole === 'admin') {
    return <AdminDashboard /> // ูููู ููุณุชุฎุฏูู 'admin'
  } else if (userRole === 'user') {
    return <UserDashboard /> // ูููู ูููุณุชุฎุฏููู ุงูุนุงุฏููู
  } else {
    return <AccessDenied /> // ูููู ููุธูุฑ ููุตูู ุบูุฑ ูุตุฑุญ ุจู
  }
}
```

ูู ูุฐุง ุงููุซุงูุ ููุธูุฑ ูููู ููุญุฉ ุงูุชุญูู ูุงุฌูุงุช ูุณุชุฎุฏู ูุฎุชููุฉ ููุณุชุฎุฏูู 'admin' ู'user' ูุงูุฃุฏูุงุฑ ุบูุฑ ุงููุตุฑุญ ุจูุง. ูุถูู ูุฐุง ุงูููุท ุชูุงุนู ูู ูุณุชุฎุฏู ููุท ูุน ุงูููููุงุช ุงูููุงุณุจุฉ ูุฏูุฑูุ ููุง ูุนุฒุฒ ูููุง ูู ุงูุฃูุงู ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู.

</AppOnly>

### ุฃูุถู ุงูููุงุฑุณุงุช

- **ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุงูุขููุฉ**: ุฃููููุฉ ูุฃูุงู ุจูุงูุงุช ุงูุฌูุณุฉ ูููุน ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู ูุฎุฑู ุงูุจูุงูุงุช. ุงุณุชุฎุฏู ุงูุชุดููุฑ ูููุงุฑุณุงุช ุงูุชุฎุฒูู ุงูุขูู.
- **ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ ุงูุฏููุงููููุฉ**: ุงุณุชุฎุฏู ูุธุงููุง ูุฑููุง ูุฃุฏูุงุฑ ุงููุณุชุฎุฏููู ูุชุณููู ุงูุชููู ูุน ุงูุชุบููุฑุงุช ูู ุงูุฃุฐููุงุช ูุงูุฃุฏูุงุฑุ ูุชุฌูุจ ุงูุฃุฏูุงุฑ ุงูุซุงุจุชุฉ.
- **ููุฌ ุงูุฃูุงู ุฃููุงู**: ูู ุฌููุน ุฌูุงูุจ ููุทู ุงูุชูููุถุ ุฃุนุท ุงูุฃููููุฉ ููุฃูุงู ูุญูุงูุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ูุงูุญูุงุธ ุนูู ุณูุงูุฉ ุชุทุจููู. ูุชุถูู ุฐูู ุงุฎุชุจุงุฑูุง ุดุงูููุง ูุงููุธุฑ ูู ููุงุท ุงูุถุนู ุงูุฃูููุฉ ุงููุญุชููุฉ.

## ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช

ุชุดูู ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุชุชุจุน ูุฅุฏุงุฑุฉ ุชูุงุนู ุงููุณุชุฎุฏู ูุน ุงูุชุทุจูู ุจูุฑูุฑ ุงูููุชุ ููุง ูุถูู ุงูุญูุงุธ ุนูู ุญุงูุชู ุงููุตุงุฏู ุนูููุง ุนุจุฑ ุฃุฌุฒุงุก ูุฎุชููุฉ ูู ุงูุชุทุจูู.

ูููุน ูุฐุง ุงูุญุงุฌุฉ ุฅูู ุชุณุฌููุงุช ุงูุฏุฎูู ุงููุชูุฑุฑุฉุ ููุง ูุนุฒุฒ ูููุง ูู ุงูุฃูุงู ูุฑุงุญุฉ ุงููุณุชุฎุฏู. ููุงู ุทุฑููุชุงู ุฑุฆูุณูุชุงู ุชูุณุชุฎุฏูุงู ูุฅุฏุงุฑุฉ ุงูุฌูุณุงุช: ุงูุฌูุณุงุช ุงููุนุชูุฏุฉ ุนูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท (Cookies) ูุฌูุณุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช.

### ุงูุฌูุณุงุช ุงููุนุชูุฏุฉ ุนูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท (Cookie-Based Sessions)

> **๐ฅ ุดุงูุฏ:** ุชุนูู ุงููุฒูุฏ ุนู ุงูุฌูุณุงุช ุงููุนุชูุฏุฉ ุนูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูุงููุตุงุฏูุฉ ูุน Next.js โ [YouTube (11 ุฏูููุฉ)](https://www.youtube.com/watch?v=DJvM2lSPn6w).

ุชุฏูุฑ ุงูุฌูุณุงุช ุงููุนุชูุฏุฉ ุนูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุจูุงูุงุช ุงููุณุชุฎุฏู ุนู ุทุฑูู ุชุฎุฒูู ูุนูููุงุช ุงูุฌูุณุฉ ุงููุดูุฑุฉ ูุจุงุดุฑุฉ ูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุจุงููุชุตูุญ. ุนูุฏ ุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏูุ ูุชู ุชุฎุฒูู ูุฐู ุงูุจูุงูุงุช ุงููุดูุฑุฉ ูู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท. ูุชุถูู ูู ุทูุจ ูุงุญู ููุฎุงุฏู ูุฐุง ุงููููุ ููุง ูููู ุงูุญุงุฌุฉ ุฅูู ุงุณุชุนูุงูุงุช ุงูุฎุงุฏู ุงููุชูุฑุฑุฉ ููุนุฒุฒ ููุงุกุฉ ุฌุงูุจ ุงูุนููู.

ููุน ุฐููุ ุชุชุทูุจ ูุฐู ุงูุทุฑููุฉ ุชุดููุฑูุง ุฏููููุง ูุญูุงูุฉ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉุ ุญูุซ ุฃู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุนุฑุถุฉ ููุฎุงุทุฑ ุงูุฃูุงู ูู ุฌุงูุจ ุงูุนููู. ูุนุฏ ุชุดููุฑ ุจูุงูุงุช ุงูุฌูุณุฉ ูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ููุชุงุญูุง ูุญูุงูุฉ ูุนูููุงุช ุงููุณุชุฎุฏู ูู ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู. ูุถูู ุฐูู ุฃูู ุญุชู ุฅุฐุง ุชู ุณุฑูุฉ ููู ุชุนุฑูู ุงูุงุฑุชุจุงุทุ ุชุธู ุงูุจูุงูุงุช ุจุฏุงุฎูู ุบูุฑ ูุงุจูุฉ ูููุฑุงุกุฉ.

ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ุจูููุง ุชููู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุงููุฑุฏูุฉ ูุญุฏูุฏุฉ ูู ุงูุญุฌู (ุนุงุฏุฉ ุญูุงูู 4 ููููุจุงูุช)ุ ูููู ูุชูููุงุช ูุซู ุชูุณูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท (cookie-chunking) ุงูุชุบูุจ ุนูู ูุฐุง ุงูููุฏ ุนู ุทุฑูู ุชูุณูู ุจูุงูุงุช ุงูุฌูุณุฉ ุงููุจูุฑุฉ ุฅูู ูููุงุช ุชุนุฑูู ุงุฑุชุจุงุท ูุชุนุฏุฏุฉ.

ูุฏ ูุจุฏู ุชุนููู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ูุดุฑูุน Next.js ููุง ููู:

**ุชุนููู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท ุนูู ุงูุฎุงุฏู:**

<PagesOnly>

```ts filename="pages/api/login.ts" switcher
import { serialize } from 'cookie'
import type { NextApiRequest, NextApiResponse } from 'next'

export default function handler(req: NextApiRequest, res: NextApiResponse) {
  const sessionData = req.body
  const encryptedSessionData = encrypt(sessionData)

  const cookie = serialize('session', encryptedSessionData, {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    maxAge: 60 * 60 * 24 * 7, // ุฃุณุจูุน ูุงุญุฏ
    path: '/',
  })
  res.setHeader('Set-Cookie', cookie)
  res.status(200).json({ message: 'Successfully set cookie!' })
}
```

```js filename="pages/api/login.js" switcher
import { serialize } from 'cookie'

export default function handler(req, res) {
  const sessionData = req.body
  const encryptedSessionData = encrypt(sessionData)

  const cookie = serialize('session', encryptedSessionData, {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    maxAge: 60 * 60 * 24 * 7, // ุฃุณุจูุน ูุงุญุฏ
    path: '/',
  })
  res.setHeader('Set-Cookie', cookie)
  res.status(200).json({ message: 'Successfully set cookie!' })
}
```

</PagesOnly>

<AppOnly>

```ts filename="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function handleLogin(sessionData) {
  const encryptedSessionData = encrypt(sessionData) // ุชุดููุฑ ุจูุงูุงุช ุฌูุณุฉ ุงููุณุชุฎุฏู
  cookies().set('session', encryptedSessionData, {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    maxAge: 60 * 60 * 24 * 7, // ุฃุณุจูุน ูุงุญุฏ
    path: '/',
  })
  // ุฅุนุงุฏุฉ ุงูุชูุฌูู ุฃู ุงูุชุนุงูู ูุน ุงูุงุณุชุฌุงุจุฉ ุจุนุฏ ุชุนููู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท
}
```

```js filename="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function handleLogin(sessionData) {
  const encryptedSessionData = encrypt(sessionData) // ุชุดููุฑ ุจูุงูุงุช ุฌูุณุฉ ุงููุณุชุฎุฏู
  cookies().set('session', encryptedSessionData, {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    maxAge: 60 * 60 * 24 * 7, // ุฃุณุจูุน ูุงุญุฏ
    path: '/',
  })
  // ุฅุนุงุฏุฉ ุงูุชูุฌูู ุฃู ุงูุชุนุงูู ูุน ุงูุงุณุชุฌุงุจุฉ ุจุนุฏ ุชุนููู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท
}
```

**ุงููุตูู ุฅูู ุจูุงูุงุช ุงูุฌูุณุฉ ุงููุฎุฒูุฉ ูู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ูููู ุฎุงุฏู:**

```tsx filename="app/page.tsx" switcher
import { cookies } from 'next/headers'

export async function getSessionData(req) {
  const encryptedSessionData = cookies().get('session')?.value
  return encryptedSessionData ? JSON.parse(decrypt(encryptedSessionData)) : null
}
```

```jsx filename="app/page.jsx" switcher
import { cookies } from 'next/headers'

export async function getSessionData(req) {
  const encryptedSessionData = cookies().get('session')?.value
  return encryptedSessionData ? JSON.parse(decrypt(encryptedSessionData)) : null
}
```

</AppOnly>

### ุฌูุณุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุชุชุถูู ุฅุฏุงุฑุฉ ุฌูุณุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุฎุฒูู ุจูุงูุงุช ุงูุฌูุณุฉ ุนูู ุงูุฎุงุฏูุ ูุน ุงุณุชูุงู ูุชุตูุญ ุงููุณุชุฎุฏู ููุท ููุนุฑู ุงูุฌูุณุฉ. ูุดูุฑ ูุฐุง ุงููุนุฑู ุฅูู ุจูุงูุงุช ุงูุฌูุณุฉ ุงููุฎุฒูุฉ ุนูู ุฌุงูุจ ุงูุฎุงุฏูุ ุฏูู ุงุญุชูุงุฆู ุนูู ุงูุจูุงูุงุช ููุณูุง. ุชุนุฒุฒ ูุฐู ุงูุทุฑููุฉ ุงูุฃูุงูุ ุญูุซ ุชุญุชูุธ ุจุจูุงูุงุช ุงูุฌูุณุฉ ุงูุญุณุงุณุฉ ุจุนูุฏูุง ุนู ุจูุฆุฉ ุฌุงูุจ ุงูุนูููุ ููุง ูููู ูู ุฎุทุฑ ุงูุชุนุฑุถ ููุฌูุงุช ุฌุงูุจ ุงูุนููู. ููุง ุฃู ุฌูุณุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃูุซุฑ ูุงุจููุฉ ููุชูุณุนุ ุญูุซ ุชุณุชูุนุจ ุงุญุชูุงุฌุงุช ุชุฎุฒูู ุจูุงูุงุช ุฃูุจุฑ.

ููุน ุฐููุ ููุฐุง ุงูููุฌ ููุงูุถุงุชู. ูููู ุฃู ูุฒูุฏ ูู ุงูุญูู ุนูู ุงูุฃุฏุงุก ุจุณุจุจ ุงูุญุงุฌุฉ ุฅูู ุนูููุงุช ุจุญุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ูู ุชูุงุนู ูููุณุชุฎุฏู. ูููู ูุงุณุชุฑุงุชูุฌูุงุช ูุซู ุชุฎุฒูู ุจูุงูุงุช ุงูุฌูุณุฉ ูุคูุชูุง ุงููุณุงุนุฏุฉ ูู ุงูุชุฎููู ูู ุฐูู. ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ูุนูู ุงูุงุนุชูุงุฏ ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุชููู ููุซููุฉ ูุซู ุฃุฏุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชููุฑูุง.

ุฅููู ูุซุงููุง ูุจุณุทูุง ูุชูููุฐ ุฌูุณุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุชุทุจูู Next.js:

**ุฅูุดุงุก ุฌูุณุฉ ุนูู ุงูุฎุงุฏู**:

<PagesOnly>

```ts filename="pages/api/create-session.ts" switcher
import db from '../../lib/db'
import { NextApiRequest, NextApiResponse } from 'next'

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  try {
    const user = req.body
    const sessionId = generateSessionId()
    await db.insertSession({
      sessionId,
      userId: user.id,
      createdAt: new Date(),
    })

    res.status(200).json({ sessionId })
  } catch (error) {
    res.status(500).json({ error: 'Internal Server Error' })
  }
}
```

```js filename="pages/api/create-session.js" switcher
import db from '../../lib/db'

export default async function handler(req, res) {
  try {
    const user = req.body
    const sessionId = generateSessionId()
    await db.insertSession({
      sessionId,
      userId: user.id,
      createdAt: new Date(),
    })

    res.status(200).json({ sessionId })
  } catch (error) {
    res.status(500).json({ error: 'Internal Server Error' })
  }
}
```

</PagesOnly>

<AppOnly>

```js
import db from './lib/db'

export async function createSession(user) {
  const sessionId = generateSessionId() // ุฅูุดุงุก ูุนุฑู ุฌูุณุฉ ูุฑูุฏ
  await db.insertSession({ sessionId, userId: user.id, createdAt: new Date() })
  return sessionId
}
```

**ุงุณุชุฑุฏุงุฏ ุฌูุณุฉ ูู Middleware ุฃู ููุทู ุฌุงูุจ ุงูุฎุงุฏู**:

```js
import { cookies } from 'next/headers'
import db from './lib/db'

export async function getSession() {
  const sessionId = cookies().get('sessionId')?.value
  return sessionId ? await db.findSession(sessionId) : null
}
```

</AppOnly>

### ุงุฎุชูุงุฑ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ูู Next.js

ูุนุชูุฏ ุงูุงุฎุชูุงุฑ ุจูู ุฌูุณุงุช ุชุนุชูุฏ ุนูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท (cookies) ูุฌูุณุงุช ุชุนุชูุฏ ุนูู ููุงุนุฏ ุงูุจูุงูุงุช ูู Next.js ุนูู ุงุญุชูุงุฌุงุช ุชุทุจููู. ุฌูุณุงุช ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุฃุจุณุท ูุชูุงุณุจ ุงูุชุทุจููุงุช ุงูุตุบูุฑุฉ ุฐุงุช ุงูุญูู ุงูุฎููู ุนูู ุงูุฎุงุฏูุ ูููููุง ูุฏ ุชููุฑ ุญูุงูุฉ ุฃูู. ุจูููุง ุฌูุณุงุช ููุงุนุฏ ุงูุจูุงูุงุชุ ุฑุบู ุชุนููุฏูุงุ ุชููุฑ ุฃูุงููุง ุฃูุถู ููุงุจููุฉ ููุชูุณุนุ ููุง ูุฌุนููุง ูุซุงููุฉ ููุชุทุจููุงุช ุงููุจูุฑุฉ ุงูุญุณุงุณุฉ ููุจูุงูุงุช.

ูุน [ุญููู ุงููุตุงุฏูุฉ](#examples) ูุซู [NextAuth.js](https://authjs.dev/guides/upgrade-to-v5)ุ ุชุตุจุญ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุฃูุซุฑ ููุงุกุฉุ ุณูุงุก ุจุงุณุชุฎุฏุงู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุฃู ุชุฎุฒูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ูุฐุง ุงูุฃุชูุชุฉ ูุจุณุท ุนูููุฉ ุงูุชุทููุฑุ ูููู ูู ุงูููู ููู ุทุฑููุฉ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุงููุณุชุฎุฏูุฉ ูู ูุจู ุงูุญู ุงูุฐู ุชุฎุชุงุฑู. ุชุฃูุฏ ูู ุฃููุง ุชุชูุงุดู ูุน ูุชุทูุจุงุช ุงูุฃูุงู ูุงูุฃุฏุงุก ูุชุทุจููู.

ุจุบุถ ุงููุธุฑ ุนู ุงุฎุชูุงุฑูุ ุถุน ุงูุฃูุงู ูู ุฃููููุฉ ุงุณุชุฑุงุชูุฌูุฉ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช. ุจุงููุณุจุฉ ูุฌูุณุงุช ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุทุ ูุนุฏ ุงุณุชุฎุฏุงู ูููุงุช ุชุนุฑูู ุงุฑุชุจุงุท ุขููุฉ ููุฎุตุตุฉ ูุจุฑูุชูููู HTTP ููุท ุฃูุฑูุง ุจุงูุบ ุงูุฃูููุฉ ูุญูุงูุฉ ุจูุงูุงุช ุงูุฌูุณุฉ. ุฃูุง ุจุงููุณุจุฉ ูุฌูุณุงุช ููุงุนุฏ ุงูุจูุงูุงุชุ ูุฅู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูููุชุธู ูุงูุชุนุงูู ุงูุขูู ูุน ุจูุงูุงุช ุงูุฌูุณุฉ ุฃูุฑุงู ุฃุณุงุณูุงู. ุชูููุฐ ุขููุงุช ุงูุชูุงุก ุตูุงุญูุฉ ุงูุฌูุณุฉ ูุชูุธูููุง ุถุฑูุฑู ูู ููุง ุงูููุฌูู ูููุน ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู ูุงูุญูุงุธ ุนูู ุฃุฏุงุก ูููุซูููุฉ ุงูุชุทุจูู.

## ุฃูุซูุฉ

ูููุง ููู ุญููู ูุตุงุฏูุฉ ูุชูุงููุฉ ูุน Next.jsุ ูุฑุฌู ุงูุฑุฌูุน ุฅูู ุฃุฏูุฉ ุงูุจุฏุก ุงูุณุฑูุน ุฃุฏูุงู ููุนุฑูุฉ ููููุฉ ุชูููููุง ูู ุชุทุจูู Next.js ุงูุฎุงุต ุจู:

{/* TODO: Change link to authjs.dev when new documentation is ready */}

- [Auth0](https://auth0.com/docs/quickstart/webapp/nextjs/01-login)
- [Clerk](https://clerk.com/docs/quickstarts/nextjs)
- [Kinde](https://kinde.com/docs/developer-tools/nextjs-sdk)
- [Lucia](https://lucia-auth.com/getting-started/nextjs-app)
- [NextAuth.js](https://authjs.dev/guides/upgrade-to-v5)
- [Supabase](https://supabase.com/docs/guides/getting-started/quickstarts/nextjs)
- [Stytch](https://stytch.com/docs/guides/quickstarts/nextjs)
- [Iron Session](https://github.com/vvo/iron-session)

## ูุฑุงุกุฉ ุฅุถุงููุฉ

ูููุงุตูุฉ ุงูุชุนูู ุนู ุงููุตุงุฏูุฉ ูุงูุฃูุงูุ ุชุญูู ูู ุงูููุงุฑุฏ ุงูุชุงููุฉ:

- [ููู ูุฌูุงุช XSS](https://vercel.com/guides/understanding-xss-attacks)
- [ููู ูุฌูุงุช CSRF](https://vercel.com/guides/understanding-csrf-attacks)
