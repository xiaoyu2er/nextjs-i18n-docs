---
source-updated-at: 2025-05-16T04:52:11.000Z
translation-updated-at: 2025-06-06T17:07:19.289Z
title: Среда выполнения Edge и Node.js
description: Узнайте о переключаемых средах выполнения (Edge и Node.js) в Next.js.
---

{/* Содержание этого документа используется как в App Router, так и в Pages Router. Вы можете использовать компонент `<PagesOnly>Контент</PagesOnly>` для добавления контента, специфичного для Pages Router. Общий контент не должен быть обёрнут в компонент. */}

В контексте Next.js среда выполнения (runtime) — это набор библиотек, API и общих функций, доступных вашему коду во время выполнения.

На сервере есть две среды выполнения, в которых могут рендериться части вашего приложения:

- **Среда выполнения Node.js** (по умолчанию) имеет доступ ко всем API Node.js и совместимым пакетам из экосистемы.
- **Среда выполнения Edge** основана на [Web API](/docs/app/api-reference/edge).

## Различия сред выполнения

При выборе среды выполнения необходимо учитывать множество факторов. В этой таблице показаны основные различия. Для более детального анализа ознакомьтесь с разделами ниже.

|                                                                                                                                       | Node   | Serverless | Edge             |
| ------------------------------------------------------------------------------------------------------------------------------------- | ------ | ---------- | ---------------- |
| Холодный старт                                                                                                                       | /      | Обычный    | Низкий           |
| [HTTP-стриминг](/docs/app/building-your-application/routing/loading-ui-and-streaming)                                                | Да     | Да         | Да               |
| Ввод-вывод                                                                                                                           | Все    | Все        | `fetch`          |
| Масштабируемость                                                                                                                     | /      | Высокая    | Наивысшая        |
| Безопасность                                                                                                                         | Обычная| Высокая    | Высокая          |
| Задержка                                                                                                                             | Обычная| Низкая     | Наименьшая       |
| npm-пакеты                                                                                                                           | Все    | Все        | Ограниченный набор |
| [Статический рендеринг](/docs/app/building-your-application/rendering/server-components#static-rendering-default)                     | Да     | Да         | Нет              |
| [Динамический рендеринг](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)                           | Да     | Да         | Да               |
| [Ревалидация данных с `fetch`](/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#revalidating-data) | Да     | Да         | Да               |

### Среда выполнения Edge

В Next.js облегчённая среда выполнения Edge — это подмножество доступных API Node.js.

Среда выполнения Edge идеально подходит, если вам нужно доставлять динамический персонализированный контент с низкой задержкой с помощью небольших простых функций. Скорость среды выполнения Edge достигается за счёт минимального использования ресурсов, но это может быть ограничивающим фактором во многих сценариях.

Например, код, выполняемый в среде выполнения Edge [на Vercel, не может превышать от 1 МБ до 4 МБ](https://vercel.com/docs/concepts/limits/overview#edge-middleware-and-edge-functions-size). Этот лимит включает импортированные пакеты, шрифты и файлы и может варьироваться в зависимости от инфраструктуры развёртывания. Кроме того, среда выполнения Edge не поддерживает все API Node.js, что означает, что некоторые `npm`-пакеты могут не работать. Например, ошибки типа "Module not found: Can't resolve 'fs'" или подобные. Мы рекомендуем использовать среду выполнения Node.js, если вам нужны эти API или пакеты.

### Среда выполнения Node.js

Использование среды выполнения Node.js даёт доступ ко всем API Node.js и всем npm-пакетам, которые от них зависят. Однако её запуск не такой быстрый, как у маршрутов, использующих среду выполнения Edge.

Развёртывание приложения Next.js на сервере Node.js потребует управления, масштабирования и настройки инфраструктуры. В качестве альтернативы вы можете рассмотреть развёртывание приложения Next.js на бессерверной платформе, такой как Vercel, которая позаботится об этом за вас.

### Бессерверная среда Node.js

Бессерверное решение идеально, если вам нужен масштабируемый вариант, способный обрабатывать более сложные вычислительные нагрузки, чем среда выполнения Edge. Например, с бессерверными функциями на Vercel общий размер кода может составлять [50 МБ](https://vercel.com/docs/concepts/limits/overview#serverless-function-size), включая импортированные пакеты, шрифты и файлы.

Недостаток по сравнению с маршрутами, использующими [Edge](https://vercel.com/docs/concepts/functions/edge-functions), заключается в том, что бессерверным функциям могут потребоваться сотни миллисекунд для запуска перед обработкой запросов. В зависимости от трафика вашего сайта это может происходить часто, так как функции не всегда остаются "тёплыми".

<AppOnly>

## Примеры

### Настройка среды выполнения для сегмента

Вы можете указать среду выполнения для отдельных сегментов маршрутов в вашем приложении Next.js. Для этого [объявите переменную `runtime` и экспортируйте её](/docs/app/api-reference/file-conventions/route-segment-config). Переменная должна быть строкой и иметь значение `'nodejs'` или `'edge'`.

В следующем примере показан сегмент маршрута страницы, который экспортирует `runtime` со значением `'edge'`:

```tsx filename="app/page.tsx" switcher
export const runtime = 'edge' // 'nodejs' (по умолчанию) | 'edge'
```

```jsx filename="app/page.js" switcher
export const runtime = 'edge' // 'nodejs' (по умолчанию) | 'edge'
```

Вы также можете определить `runtime` на уровне layout, что приведёт к выполнению всех маршрутов под этим layout в среде выполнения Edge:

```tsx filename="app/layout.tsx" switcher
export const runtime = 'edge' // 'nodejs' (по умолчанию) | 'edge'
```

```jsx filename="app/layout.js" switcher
export const runtime = 'edge' // 'nodejs' (по умолчанию) | 'edge'
```

Если среда выполнения сегмента _не_ задана, будет использоваться среда выполнения `nodejs` по умолчанию. Вам не нужно использовать опцию `runtime`, если вы не планируете переходить со среды выполнения Node.js.

</AppOnly>

> Полный список доступных API см. в [документации Node.js](https://nodejs.org/docs/latest/api/) и [документации Edge](/docs/app/api-reference/edge). Обе среды выполнения также могут поддерживать [стриминг](/docs/app/building-your-application/routing/loading-ui-and-streaming) в зависимости от вашей инфраструктуры развёртывания.