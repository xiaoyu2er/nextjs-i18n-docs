---
source-updated-at: 2025-05-16T04:52:11.000Z
translation-updated-at: 2025-06-02T19:58:28.144Z
title: Turbopack
description: Turbopack — это инкрементальный бандлер, оптимизированный для JavaScript и TypeScript, написанный на Rust и встроенный в Next.js.
---

{/* Содержание этого документа используется как в App Router, так и в Pages Router. Для добавления контента, специфичного для Pages Router, используйте компонент `<PagesOnly>Content</PagesOnly>`. Общий контент не должен быть обёрнут в компонент. */}

Turbopack — это **инкрементальный бандлер**, оптимизированный для JavaScript и TypeScript, написанный на Rust и встроенный в **Next.js**. Вы можете использовать Turbopack как с Pages Router, так и с App Router для **значительно более быстрого** процесса локальной разработки.

## Почему Turbopack?

Мы создали Turbopack, чтобы повысить производительность Next.js, включая:

- **Единый граф:** Next.js поддерживает несколько окружений (например, клиент и сервер). Управление несколькими компиляторами и сборка бандлов может быть утомительной. Turbopack использует **единый граф** для всех окружений.
- **Бандлинг против нативного ESM:** Некоторые инструменты пропускают бандлинг в разработке и полагаются на нативный ESM в браузере. Это хорошо работает для небольших приложений, но может замедлить крупные из-за чрезмерного количества сетевых запросов. Turbopack **использует бандлинг** в dev-режиме, но делает это оптимальным образом для поддержания скорости в больших приложениях.
- **Инкрементальные вычисления:** Turbopack распределяет работу между ядрами и **кэширует** результаты на уровне функций. Как только часть работы выполнена, Turbopack не будет повторять её.
- **Ленивый бандлинг:** Turbopack собирает только то, что действительно запрошено dev-сервером. Такой ленивый подход может сократить время начальной компиляции и использование памяти.

## Начало работы

Чтобы включить Turbopack в вашем проекте Next.js, добавьте флаг `--turbopack` к скриптам `dev` и `build` в файле `package.json`:

```json filename="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build --turbopack",
    "start": "next start"
  }
}
```

В настоящее время Turbopack для `dev` стабилен, а для `build` находится в альфа-версии. Мы активно работаем над поддержкой production-сборок по мере приближения Turbopack к стабильности.

## Поддерживаемые возможности

Turbopack в Next.js работает **без конфигурации** для большинства стандартных случаев. Ниже приведён обзор поддерживаемых возможностей "из коробки", а также ссылки на настройки Turbopack, когда это необходимо.

### Языковые возможности

| Возможность                  | Статус                | Примечания                                                                                                                                                                                                   |
| ---------------------------- | --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **JavaScript & TypeScript**  | **Поддерживается**    | Использует SWC под капотом. Проверка типов не выполняется Turbopack (запустите `tsc --watch` или используйте проверку типов в вашей IDE).                                                                   |
| **ECMAScript (ESNext)**      | **Поддерживается**    | Turbopack поддерживает последние возможности ECMAScript в соответствии с покрытием SWC.                                                                                                                     |
| **CommonJS**                 | **Поддерживается**    | Синтаксис `require()` работает "из коробки".                                                                                                                                                                |
| **ESM**                      | **Поддерживается**    | Полностью поддерживаются статические и динамические `import`.                                                                                                                                               |
| **Babel**                    | Частично не поддерживается | Turbopack не включает Babel по умолчанию. Однако вы можете [настроить `babel-loader` через конфиг Turbopack](/docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders).           |

### Возможности фреймворка и React

| Возможность                          | Статус        | Примечания                                                                                                                  |
| ------------------------------------ | ------------- | -------------------------------------------------------------------------------------------------------------------------- |
| **JSX / TSX**                        | **Поддерживается** | SWC обрабатывает компиляцию JSX/TSX.                                                                                       |
| **Fast Refresh**                     | **Поддерживается** | Не требует настройки.                                                                                                      |
| **React Server Components (RSC)**    | **Поддерживается** | Для App Router в Next.js. Turbopack обеспечивает корректную сборку для сервера и клиента.                                  |
| **Создание корневого макета**        | Не поддерживается | Автоматическое создание корневого макета в App Router не поддерживается. Turbopack предложит создать его вручную.          |

### CSS и стили

| Возможность            | Статус                  | Примечания                                                                                                                                                                                                           |
| ---------------------- | ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Глобальный CSS**     | **Поддерживается**      | Импортируйте файлы `.css` напрямую в вашем приложении.                                                                                                                                                              |
| **CSS Modules**        | **Поддерживается**      | Файлы `.module.css` работают нативно (Lightning CSS).                                                                                                                                                                |
| **Вложенность CSS**    | **Поддерживается**      | Lightning CSS поддерживает [современную вложенность CSS](https://lightningcss.dev/).                                                                                                                                 |
| **Синтаксис @import**  | **Поддерживается**      | Объединение нескольких CSS-файлов.                                                                                                                                                                                  |
| **PostCSS**            | **Поддерживается**      | Автоматически обрабатывает `postcss.config.js` в пуле Node.js-воркеров. Полезно для Tailwind, Autoprefixer и т.д.                                                                                                    |
| **Sass / SCSS**        | **Поддерживается** (Next.js) | В Next.js Sass поддерживается "из коробки". В будущем для standalone-использования Turbopack, вероятно, потребуется настройка лоадера.                                                                              |
| **Less**               | Планируется через плагины | Пока не поддерживается по умолчанию. Вероятно, потребует настройки лоадера, когда пользовательские лоадеры станут стабильными.                                                                                      |
| **Lightning CSS**      | **Используется**        | Обрабатывает трансформации CSS. Некоторые редко используемые возможности CSS Modules (например, `:local/:global` как самостоятельные псевдоклассы) пока не поддерживаются. [Подробнее ниже.](#unsupported-and-unplanned-features) |

### Ассеты

| Возможность                          | Статус        | Примечания                                                                                                                      |
| ------------------------------------ | ------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| **Статические ассеты** (изображения, шрифты) | **Поддерживается** | Импорт `import img from './img.png'` работает "из коробки". В Next.js возвращает объект для компонента `<Image />`.             |
| **Импорт JSON**                      | **Поддерживается** | Поддерживаются именованные и дефолтные импорты из `.json`.                                                                     |

### Разрешение модулей

| Возможность               | Статус              | Примечания                                                                                                                                                           |
| ------------------------- | ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Алиасы путей**          | **Поддерживается**  | Читает `paths` и `baseUrl` из `tsconfig.json`, соответствуя поведению Next.js.                                                                                      |
| **Ручные алиасы**         | **Поддерживается**  | [Настройте `resolveAlias` в `next.config.js`](/docs/app/api-reference/config/next-config-js/turbopack#resolving-aliases) (аналогично `webpack.resolve.alias`).       |
| **Пользовательские расширения** | **Поддерживается**  | [Настройте `resolveExtensions` в `next.config.js`](/docs/app/api-reference/config/next-config-js/turbopack#resolving-custom-extensions).                             |
| **AMD**                   | Частично поддерживается | Базовые трансформации работают; продвинутое использование AMD ограничено.                                                                                           |

### Производительность и Fast Refresh

| Возможность                  | Статус        | Примечания                                                                                    |
| ---------------------------- | ------------- | -------------------------------------------------------------------------------------------- |
| **Fast Refresh**             | **Поддерживается** | Обновляет JavaScript, TypeScript и CSS без полного перезагрузки.                             |
| **Инкрементальный бандлинг** | **Поддерживается** | Turbopack лениво собирает только то, что запрошено dev-сервером, ускоряя работу больших приложений. |

## Неподдерживаемые и незапланированные возможности

Некоторые возможности пока не реализованы или не планируются:

- **Устаревшие возможности CSS Modules**
  - Отдельные псевдоклассы `:local` и `:global` (поддерживается только вариант-функция `:global(...)`).
  - Правило `@value` (заменено CSS-переменными).
  - Правила ICSS `:import` и `:export`.
- **Конфигурация `webpack()` в `next.config.js`**
  Turbopack заменяет webpack, поэтому конфиги `webpack()` не распознаются. Используйте [конфиг `turbopack`](/docs/app/api-reference/config/next-config-js/turbopack) вместо этого.
- **AMP**
  Не планируется поддержка в Turbopack для Next.js.
- **Yarn PnP**
  Не планируется поддержка в Turbopack для Next.js.
- **`experimental.urlImports`**
  Не планируется поддержка в Turbopack.
- **`experimental.esmExternals`**
  Не планируется. Turbopack не поддерживает устаревшую конфигурацию `esmExternals` в Next.js.
- **Некоторые экспериментальные флаги Next.js**
  - `experimental.typedRoutes`
  - `experimental.nextScriptWorkers`
  - `experimental.sri.algorithm`
  - `experimental.fallbackNodePolyfills`
    Мы планируем реализовать их в будущем.

Для полного и детального обзора каждого флага и его статуса см. [Справочник по API Turbopack](/docs/app/api-reference/config/next-config-js/turbopack).

## Конфигурация

Turbopack можно настроить через `next.config.js` (или `next.config.ts`) под ключом `turbopack`. Доступные опции конфигурации:

- **`rules`**
  Определение дополнительных [webpack-лоадеров](/docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders) для трансформации файлов.
- **`resolveAlias`**
  Создание ручных алиасов (аналогично `resolve.alias` в webpack).
- **`resolveExtensions`**
  Изменение или расширение списка расширений файлов для разрешения модулей.
- **`moduleIds`**
  Настройка генерации ID модулей (`'named'` или `'deterministic'`).
- **`treeShaking`**
  Включение или отключение tree shaking в dev-режиме и будущих production-сборках.
- **`memoryLimit`**
  Установка лимита памяти (в байтах) для Turbopack.

```js filename="next.config.js"
module.exports = {
  turbopack: {
    // Пример: добавление алиаса и пользовательского расширения файла
    resolveAlias: {
      underscore: 'lodash',
    },
    resolveExtensions: ['.mdx', '.tsx', '.ts', '.jsx', '.js', '.json'],
  },
}
```

Для более детальных примеров конфигурации см. [документацию по конфигу Turbopack](/docs/app/api-reference/config/next-config-js/turbopack).

## Генерация trace-файлов для отладки производительности

Если вы столкнулись с проблемами производительности или памяти и хотите помочь команде Next.js в их диагностике, вы можете сгенерировать trace-файл, добавив `NEXT_TURBOPACK_TRACING=1` к вашей dev-команде:

```bash
NEXT_TURBOPACK_TRACING=1 next dev --turbopack
```

Это создаст файл `.next/trace-turbopack`. Прикрепите этот файл при создании issue в [репозитории Next.js](https://github.com/vercel/next.js), чтобы помочь нам в расследовании.

## Итог

Turbopack — это **основанный на Rust**, **инкрементальный** бандлер, разработанный для ускорения локальной разработки и сборки, особенно для больших приложений. Он интегрирован в Next.js и предоставляет поддержку CSS, React и TypeScript без конфигурации.

Следите за обновлениями, пока мы продолжаем улучшать Turbopack и добавлять поддержку production-сборок. А пока попробуйте его с `next dev --turbopack` и поделитесь вашими отзывами.

## Изменения версий

| Версия    | Изменения                          |
| --------- | ---------------------------------- |
| `v15.3.0` | Экспериментальная поддержка `build` |
| `v15.0.0` | Turbopack для `dev` стабилен       |