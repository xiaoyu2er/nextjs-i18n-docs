---
source-updated-at: 2025-05-19T22:31:51.000Z
translation-updated-at: 2025-05-19T23:06:15.558Z
title: å¦‚ä½•ä½¿ç”¨éƒ¨åˆ†é¢„æ¸²æŸ“ (Partial Prerendering)
nav_title: éƒ¨åˆ†é¢„æ¸²æŸ“ (PPR)
description: å­¦ä¹ å¦‚ä½•é€šè¿‡éƒ¨åˆ†é¢„æ¸²æŸ“ (Partial Prerendering) ç»“åˆé™æ€æ¸²æŸ“ä¸åŠ¨æ€æ¸²æŸ“çš„ä¼˜åŠ¿ã€‚
version: experimental
related:
  title: åç»­æ­¥éª¤
  description: äº†è§£æ›´å¤šå…³äºéƒ¨åˆ†é¢„æ¸²æŸ“ (PPR) çš„é…ç½®é€‰é¡¹ã€‚
  links:
    - app/api-reference/config/next-config-js/ppr
---

éƒ¨åˆ†é¢„æ¸²æŸ“ (Partial Prerendering, PPR) æ˜¯ä¸€ç§æ¸²æŸ“ç­–ç•¥ï¼Œå…è®¸ä½ åœ¨åŒä¸€è·¯ç”±ä¸­ç»“åˆé™æ€ä¸åŠ¨æ€å†…å®¹ã€‚è¿™æ—¢èƒ½æå‡åˆå§‹é¡µé¢æ€§èƒ½ï¼Œåˆèƒ½æ”¯æŒä¸ªæ€§åŒ–çš„åŠ¨æ€æ•°æ®ã€‚

<Image
  alt="éƒ¨åˆ†é¢„æ¸²æŸ“çš„äº§å“é¡µé¢å±•ç¤ºé™æ€å¯¼èˆªæ å’Œäº§å“ä¿¡æ¯ï¼Œä»¥åŠåŠ¨æ€è´­ç‰©è½¦å’Œæ¨èå•†å“"
  srcLight="/learn/light/thinking-in-ppr.png"
  srcDark="/learn/dark/thinking-in-ppr.png"
  width="1600"
  height="632"
/>

å½“ç”¨æˆ·è®¿é—®è·¯ç”±æ—¶ï¼š

- æœåŠ¡å™¨å‘é€åŒ…å«é™æ€å†…å®¹çš„ **å¤–å£³ (shell)**ï¼Œç¡®ä¿å¿«é€Ÿåˆå§‹åŠ è½½ã€‚
- å¤–å£³ä¸ºåŠ¨æ€å†…å®¹é¢„ç•™ **ç©ºç¼º (holes)**ï¼Œè¿™äº›å†…å®¹å°†å¼‚æ­¥åŠ è½½ã€‚
- åŠ¨æ€ç©ºç¼ºä¼š **å¹¶è¡Œæµå¼ä¼ è¾“ (streamed in parallel)**ï¼Œå‡å°‘é¡µé¢çš„æ•´ä½“åŠ è½½æ—¶é—´ã€‚

> **ğŸ¥ è§‚çœ‹è§†é¢‘ï¼š** ä¸ºä»€ä¹ˆéœ€è¦ PPR åŠå…¶å·¥ä½œåŸç† â†’ [YouTube (10 åˆ†é’Ÿ)](https://www.youtube.com/watch?v=MTcPrTIBkpA)ã€‚

## éƒ¨åˆ†é¢„æ¸²æŸ“å¦‚ä½•å·¥ä½œï¼Ÿ

è¦ç†è§£éƒ¨åˆ†é¢„æ¸²æŸ“ï¼Œéœ€è¦å…ˆç†Ÿæ‚‰ Next.js æä¾›çš„æ¸²æŸ“ç­–ç•¥ã€‚

### é™æ€æ¸²æŸ“ (Static Rendering)

é™æ€æ¸²æŸ“ä¼šæå‰ç”Ÿæˆ HTML â€”â€” å¯ä»¥åœ¨æ„å»ºæ—¶æˆ–é€šè¿‡ [é‡æ–°éªŒè¯ (revalidation)](/docs/app/building-your-application/data-fetching/incremental-static-regeneration) å®Œæˆã€‚ç»“æœä¼šè¢«ç¼“å­˜å¹¶åœ¨ç”¨æˆ·å’Œè¯·æ±‚é—´å…±äº«ã€‚

åœ¨éƒ¨åˆ†é¢„æ¸²æŸ“ä¸­ï¼ŒNext.js ä¼šä¸ºè·¯ç”±é¢„æ¸²æŸ“ä¸€ä¸ª **é™æ€å¤–å£³ (static shell)**ï¼ŒåŒ…å«å¸ƒå±€å’Œä»»ä½•ä¸ä¾èµ–è¯·æ±‚æ—¶æ•°æ®çš„ç»„ä»¶ã€‚

### åŠ¨æ€æ¸²æŸ“ (Dynamic Rendering)

åŠ¨æ€æ¸²æŸ“ä¼šåœ¨ **è¯·æ±‚æ—¶ (request time)** ç”Ÿæˆ HTMLï¼Œä»è€Œæ ¹æ®è¯·æ±‚æ—¶çš„æ•°æ®æä¾›ä¸ªæ€§åŒ–å†…å®¹ã€‚

ç»„ä»¶åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä¼šå˜ä¸ºåŠ¨æ€ï¼š

- ä½¿ç”¨ [`cookies`](/docs/app/api-reference/functions/cookies)
- ä½¿ç”¨ [`headers`](/docs/app/api-reference/functions/headers)
- ä½¿ç”¨ [`connection`](/docs/app/api-reference/functions/connection)
- ä½¿ç”¨ [`draftMode`](/docs/app/api-reference/functions/draft-mode)
- ä½¿ç”¨ [`searchParams` å±æ€§](/docs/app/api-reference/file-conventions/page#searchparams-optional)
- ä½¿ç”¨ [`unstable_noStore`](/docs/app/api-reference/functions/unstable_noStore)
- ä½¿ç”¨ `{ cache: 'no-store' }` çš„ [`fetch`](/docs/app/api-reference/functions/fetch)

åœ¨éƒ¨åˆ†é¢„æ¸²æŸ“ä¸­ï¼Œä½¿ç”¨è¿™äº› API ä¼šæŠ›å‡ºç‰¹æ®Šçš„ React é”™è¯¯ï¼Œæç¤º Next.js è¯¥ç»„ä»¶æ— æ³•é™æ€æ¸²æŸ“ï¼Œå¯¼è‡´æ„å»ºé”™è¯¯ã€‚ä½ å¯ä»¥ä½¿ç”¨ [Suspense](#suspense) å°†æ¸²æŸ“æ¨è¿Ÿåˆ°è¿è¡Œæ—¶ã€‚

### Suspense

React çš„ [Suspense](https://react.dev/reference/react/Suspense) ç”¨äºå»¶è¿Ÿæ¸²æŸ“éƒ¨åˆ†åº”ç”¨ï¼Œç›´åˆ°æ»¡è¶³æŸäº›æ¡ä»¶ã€‚

åœ¨éƒ¨åˆ†é¢„æ¸²æŸ“ä¸­ï¼ŒSuspense ç”¨äºæ ‡è®°ç»„ä»¶æ ‘ä¸­çš„ **åŠ¨æ€è¾¹ç•Œ (dynamic boundaries)**ã€‚

æ„å»ºæ—¶ï¼ŒNext.js ä¼šé¢„æ¸²æŸ“é™æ€å†…å®¹å’Œ `fallback` UIã€‚åŠ¨æ€å†…å®¹ä¼š **æ¨è¿Ÿ (postponed)** åˆ°ç”¨æˆ·è¯·æ±‚è·¯ç”±æ—¶åŠ è½½ã€‚

ç”¨ Suspense åŒ…è£¹ç»„ä»¶ä¸ä¼šä½¿ç»„ä»¶æœ¬èº«å˜ä¸ºåŠ¨æ€ï¼ˆåŠ¨æ€æ€§ç”± API ä½¿ç”¨å†³å®šï¼‰ï¼Œè€Œæ˜¯ä½œä¸ºå°è£…åŠ¨æ€å†…å®¹çš„è¾¹ç•Œï¼Œå¹¶å¯ç”¨ [æµå¼ä¼ è¾“ (streaming)](#streaming)ã€‚

```jsx filename="app/page.js"
import { Suspense } from 'react'
import StaticComponent from './StaticComponent'
import DynamicComponent from './DynamicComponent'
import Fallback from './Fallback'

export const experimental_ppr = true

export default function Page() {
  return (
    <>
      <StaticComponent />
      <Suspense fallback={<Fallback />}>
        <DynamicComponent />
      </Suspense>
    </>
  )
}
```

### æµå¼ä¼ è¾“ (Streaming)

æµå¼ä¼ è¾“å°†è·¯ç”±æ‹†åˆ†ä¸ºå¤šä¸ªå—ï¼Œå¹¶åœ¨å‡†å¤‡å°±ç»ªæ—¶é€æ­¥ä¼ è¾“åˆ°å®¢æˆ·ç«¯ã€‚è¿™æ ·ç”¨æˆ·å¯ä»¥åœ¨æ•´ä¸ªå†…å®¹å®Œæˆæ¸²æŸ“å‰ç«‹å³çœ‹åˆ°éƒ¨åˆ†é¡µé¢ã€‚

<Image
  alt="å›¾è¡¨å±•ç¤ºå®¢æˆ·ç«¯éƒ¨åˆ†æ¸²æŸ“çš„é¡µé¢ï¼Œä»¥åŠæ­£åœ¨æµå¼ä¼ è¾“çš„åŒºå—åŠ è½½ UIã€‚"
  srcLight="/docs/light/server-rendering-with-streaming.png"
  srcDark="/docs/dark/server-rendering-with-streaming.png"
  width="1600"
  height="785"
/>

åœ¨éƒ¨åˆ†é¢„æ¸²æŸ“ä¸­ï¼ŒåŒ…è£¹åœ¨ Suspense ä¸­çš„åŠ¨æ€ç»„ä»¶ä¼šä»æœåŠ¡å™¨å¹¶è¡Œæµå¼ä¼ è¾“ã€‚

<Image
  alt="å›¾è¡¨å±•ç¤ºæµå¼ä¼ è¾“æœŸé—´è·¯ç”±æ®µçš„å¹¶è¡ŒåŒ–ï¼Œæ˜¾ç¤ºå„ä¸ªåŒºå—çš„æ•°æ®è·å–ã€æ¸²æŸ“å’Œæ°´åˆã€‚"
  srcLight="/docs/light/sequential-parallel-data-fetching.png"
  srcDark="/docs/dark/sequential-parallel-data-fetching.png"
  width="1600"
  height="525"
/>

ä¸ºäº†å‡å°‘ç½‘ç»œå¼€é”€ï¼Œå®Œæ•´å“åº”ï¼ˆåŒ…æ‹¬é™æ€ HTML å’Œæµå¼ä¼ è¾“çš„åŠ¨æ€éƒ¨åˆ†ï¼‰ä¼šåœ¨ **å•ä¸ª HTTP è¯·æ±‚** ä¸­å‘é€ã€‚è¿™é¿å…äº†é¢å¤–çš„å¾€è¿”ï¼Œæå‡äº†åˆå§‹åŠ è½½å’Œæ•´ä½“æ€§èƒ½ã€‚

## å¯ç”¨éƒ¨åˆ†é¢„æ¸²æŸ“

ä½ å¯ä»¥é€šè¿‡åœ¨ `next.config.ts` æ–‡ä»¶ä¸­æ·»åŠ  [`ppr`](https://rc.nextjs.org/docs/app/api-reference/next-config-js/ppr) é€‰é¡¹æ¥å¯ç”¨ PPRï¼š

```ts filename="next.config.ts" highlight={5} switcher
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  experimental: {
    ppr: 'incremental',
  },
}

export default nextConfig
```

```js filename="next.config.js" highlight={4} switcher
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    ppr: 'incremental',
  },
}
```

`'incremental'` å€¼å…è®¸ä½ ä¸ºç‰¹å®šè·¯ç”±å¯ç”¨ PPRï¼š

```tsx filename="/app/dashboard/layout.tsx"
export const experimental_ppr = true

export default function Layout({ children }: { children: React.ReactNode }) {
  // ...
}
```

```jsx filename="/app/dashboard/layout.js"
export const experimental_ppr = true

export default function Layout({ children }) {
  // ...
}
```

æœªè®¾ç½® `experimental_ppr` çš„è·¯ç”±ä¼šé»˜è®¤ä¸º `false`ï¼Œä¸ä¼šä½¿ç”¨ PPR é¢„æ¸²æŸ“ã€‚ä½ éœ€è¦ä¸ºæ¯ä¸ªè·¯ç”±æ˜¾å¼å¯ç”¨ PPRã€‚

> **é¡»çŸ¥ï¼š**
>
> - `experimental_ppr` ä¼šåº”ç”¨åˆ°è·¯ç”±æ®µçš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬åµŒå¥—å¸ƒå±€å’Œé¡µé¢ã€‚ä½ æ— éœ€åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ï¼Œåªéœ€åœ¨è·¯ç”±çš„é¡¶å±‚æ®µè®¾ç½®ã€‚
> - è¦ä¸ºå­æ®µç¦ç”¨ PPRï¼Œå¯ä»¥åœ¨å­æ®µä¸­å°† `experimental_ppr` è®¾ä¸º `false`ã€‚

## ç¤ºä¾‹

### åŠ¨æ€ API

å½“ä½¿ç”¨éœ€è¦æŸ¥çœ‹è¯·æ±‚çš„åŠ¨æ€ API æ—¶ï¼ŒNext.js ä¼šä¸ºè¯¥è·¯ç”±å¯ç”¨åŠ¨æ€æ¸²æŸ“ã€‚è¦ç»§ç»­ä½¿ç”¨ PPRï¼Œè¯·ç”¨ Suspense åŒ…è£¹ç»„ä»¶ã€‚ä¾‹å¦‚ï¼Œ`<User />` ç»„ä»¶å› ä½¿ç”¨ `cookies` API è€Œå˜ä¸ºåŠ¨æ€ï¼š

```jsx filename="app/user.js" switcher
import { cookies } from 'next/headers'

export async function User() {
  const session = (await cookies()).get('session')?.value
  return '...'
}
```

```tsx filename="app/user.tsx" switcher
import { cookies } from 'next/headers'

export async function User() {
  const session = (await cookies()).get('session')?.value
  return '...'
}
```

`<User />` ç»„ä»¶ä¼šæµå¼ä¼ è¾“ï¼Œè€Œ `<Page />` ä¸­çš„å…¶ä»–å†…å®¹ä¼šè¢«é¢„æ¸²æŸ“å¹¶æˆä¸ºé™æ€å¤–å£³çš„ä¸€éƒ¨åˆ†ã€‚

```tsx filename="app/page.tsx" switcher
import { Suspense } from 'react'
import { User, AvatarSkeleton } from './user'

export const experimental_ppr = true

export default function Page() {
  return (
    <section>
      <h1>è¿™éƒ¨åˆ†ä¼šè¢«é¢„æ¸²æŸ“</h1>
      <Suspense fallback={<AvatarSkeleton />}>
        <User />
      </Suspense>
    </section>
  )
}
```

```jsx filename="app/page.js" switcher
import { Suspense } from 'react'
import { User, AvatarSkeleton } from './user'

export const experimental_ppr = true

export default function Page() {
  return (
    <section>
      <h1>è¿™éƒ¨åˆ†ä¼šè¢«é¢„æ¸²æŸ“</h1>
      <Suspense fallback={<AvatarSkeleton />}>
        <User />
      </Suspense>
    </section>
  )
}
```

### ä¼ é€’åŠ¨æ€å±æ€§

ç»„ä»¶ä»…åœ¨è®¿é—®å€¼æ—¶æ‰ä¼šå¯ç”¨åŠ¨æ€æ¸²æŸ“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä» `<Page />` ç»„ä»¶è¯»å– `searchParams`ï¼Œå¯ä»¥å°†å…¶ä½œä¸ºå±æ€§ä¼ é€’ç»™å…¶ä»–ç»„ä»¶ï¼š

```tsx filename="app/page.tsx" switcher
import { Table, TableSkeleton } from './table'
import { Suspense } from 'react'

export default function Page({
  searchParams,
}: {
  searchParams: Promise<{ sort: string }>
}) {
  return (
    <section>
      <h1>è¿™éƒ¨åˆ†ä¼šè¢«é¢„æ¸²æŸ“</h1>
      <Suspense fallback={<TableSkeleton />}>
        <Table searchParams={searchParams} />
      </Suspense>
    </section>
  )
}
```

```jsx filename="app/page.js" switcher
import { Table, TableSkeleton } from './table'
import { Suspense } from 'react'

export default function Page({ searchParams }) {
  return (
    <section>
      <h1>è¿™éƒ¨åˆ†ä¼šè¢«é¢„æ¸²æŸ“</h1>
      <Suspense fallback={<TableSkeleton />}>
        <Table searchParams={searchParams} />
      </Suspense>
    </section>
  )
}
```

åœ¨è¡¨æ ¼ç»„ä»¶å†…éƒ¨ï¼Œè®¿é—® `searchParams` çš„å€¼ä¼šä½¿è¯¥ç»„ä»¶å˜ä¸ºåŠ¨æ€ï¼Œè€Œé¡µé¢çš„å…¶ä½™éƒ¨åˆ†ä¼šè¢«é¢„æ¸²æŸ“ã€‚

```tsx filename="app/table.tsx" switcher
export async function Table({
  searchParams,
}: {
  searchParams: Promise<{ sort: string }>
}) {
  const sort = (await searchParams).sort === 'true'
  return '...'
}
```

```jsx filename="app/table.js" switcher
export async function Table({ searchParams }) {
  const sort = (await searchParams).sort === 'true'
  return '...'
}
```