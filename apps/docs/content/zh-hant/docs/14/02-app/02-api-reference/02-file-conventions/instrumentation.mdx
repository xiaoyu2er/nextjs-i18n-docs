---
source-updated-at: 2025-05-16T04:52:11.000Z
translation-updated-at: 2025-05-25T21:16:18.318Z
title: instrumentation.js
description: 關於 instrumentation.js 檔案的 API 參考文件。
related:
  title: 深入了解 Instrumentation
  links:
    - app/building-your-application/optimizing/instrumentation
---

`instrumentation.js|ts` 檔案用於整合監控與記錄工具到您的應用程式中。這讓您可以追蹤應用程式的效能與行為，並在生產環境中偵錯問題。

要使用它，請將檔案放置在應用程式的**根目錄**，或如果您有使用 [`src` 資料夾](/docs/app/building-your-application/configuring/src-directory) 的話，放在該資料夾內。

## 設定選項

Instrumentation 目前是實驗性功能，要使用 `instrumentation` 檔案，您必須在 `next.config.js` 中明確啟用 [`experimental.instrumentationHook = true;`](/docs/app/api-reference/next-config-js/instrumentationHook)：

```js filename="next.config.js"
module.exports = {
  experimental: {
    instrumentationHook: true,
  },
}
```

## 匯出項目

### `register` (必要)

該檔案需匯出一個 `register` 函式，此函式會在初始化新的 Next.js 伺服器實例時被呼叫**一次**。`register` 可以是非同步函式。

```ts filename="instrumentation.ts" switcher
import { registerOTel } from '@vercel/otel'

export function register() {
  registerOTel('next-app')
}
```

```js filename="instrumentation.js" switcher
import { registerOTel } from '@vercel/otel'

export function register() {
  registerOTel('next-app')
}
```

## 版本歷史

| 版本       | 變更內容                                                 |
| ---------- | ------------------------------------------------------- |
| `v14.0.4` | 新增對 `instrumentation` 的 Turbopack 支援                 |
| `v13.2.0` | 以實驗性功能形式引入 `instrumentation` |