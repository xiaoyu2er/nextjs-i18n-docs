---
source-updated-at: 2025-05-21T18:33:43.000Z
translation-updated-at: 2025-05-25T21:08:30.749Z
title: å¦‚ä½•å¾ Pages Router é·ç§»è‡³ App Router
nav_title: App Router
description: å­¸ç¿’å¦‚ä½•å°‡ç¾æœ‰çš„ Next.js æ‡‰ç”¨ç¨‹å¼å¾ Pages Router å‡ç´šè‡³ App Routerã€‚
---

æœ¬æŒ‡å—å°‡å”åŠ©æ‚¨ï¼š

- [å°‡ Next.js æ‡‰ç”¨ç¨‹å¼å¾ç‰ˆæœ¬ 12 æ›´æ–°è‡³ç‰ˆæœ¬ 13](#nextjs-version)
- [å‡ç´šåŒæ™‚é©ç”¨æ–¼ `pages` å’Œ `app` ç›®éŒ„çš„åŠŸèƒ½](#upgrading-new-features)
- [é€æ­¥å°‡ç¾æœ‰æ‡‰ç”¨ç¨‹å¼å¾ `pages` é·ç§»è‡³ `app`](#migrating-from-pages-to-app)

## å‡ç´šæ­¥é©Ÿ

### Node.js ç‰ˆæœ¬

æœ€ä½ Node.js ç‰ˆæœ¬ç¾åœ¨è¦æ±‚ **v18.17**ã€‚è©³æƒ…è«‹åƒé–± [Node.js æ–‡ä»¶](https://nodejs.org/docs/latest-v18.x/api/)ã€‚

### Next.js ç‰ˆæœ¬

è¦æ›´æ–°è‡³ Next.js ç‰ˆæœ¬ 13ï¼Œè«‹ä½¿ç”¨æ‚¨åå¥½çš„å¥—ä»¶ç®¡ç†å·¥å…·åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š

```bash filename="çµ‚ç«¯æ©Ÿ"
npm install next@latest react@latest react-dom@latest
```

### ESLint ç‰ˆæœ¬

å¦‚æœæ‚¨ä½¿ç”¨ ESLintï¼Œéœ€è¦å‡ç´š ESLint ç‰ˆæœ¬ï¼š

```bash filename="çµ‚ç«¯æ©Ÿ"
npm install -D eslint-config-next@latest
```

> **å°æç¤º**ï¼šæ‚¨å¯èƒ½éœ€è¦é‡å•Ÿ VS Code ä¸­çš„ ESLint ä¼ºæœå™¨æ‰èƒ½ä½¿è®Šæ›´ç”Ÿæ•ˆã€‚é–‹å•Ÿå‘½ä»¤é¢æ¿ï¼ˆMac æŒ‰ `cmd+shift+p`ï¼›Windows æŒ‰ `ctrl+shift+p`ï¼‰ä¸¦æœå°‹ `ESLint: Restart ESLint Server`ã€‚

## å¾ŒçºŒæ­¥é©Ÿ

æ›´æ–°å®Œæˆå¾Œï¼Œè«‹åƒé–±ä»¥ä¸‹ç« ç¯€é€²è¡Œå¾ŒçºŒæ“ä½œï¼š

- [å‡ç´šæ–°åŠŸèƒ½](#upgrading-new-features)ï¼šå¹«åŠ©æ‚¨å‡ç´šè‡³æ–°åŠŸèƒ½çš„æŒ‡å—ï¼Œä¾‹å¦‚æ”¹é€²çš„ Image å’Œ Link å…ƒä»¶ã€‚
- [å¾ `pages` ç›®éŒ„é·ç§»è‡³ `app` ç›®éŒ„](#migrating-from-pages-to-app)ï¼šé€æ­¥æŒ‡å—ï¼Œå”åŠ©æ‚¨é€æ­¥å¾ `pages` é·ç§»è‡³ `app` ç›®éŒ„ã€‚

## å‡ç´šæ–°åŠŸèƒ½

Next.js 13 å¼•å…¥äº†æ–°çš„ [App Router](/docs/app/building-your-application/routing)ï¼Œå¸¶ä¾†æ–°åŠŸèƒ½å’Œç´„å®šã€‚æ–° Router ä½æ–¼ `app` ç›®éŒ„ä¸­ï¼Œä¸¦èˆ‡ `pages` ç›®éŒ„å…±å­˜ã€‚

å‡ç´šè‡³ Next.js 13 **ä¸**å¼·åˆ¶è¦æ±‚ä½¿ç”¨ App Routerã€‚æ‚¨å¯ä»¥ç¹¼çºŒä½¿ç”¨ `pages` ç›®éŒ„ï¼ŒåŒæ™‚äº«å—é©ç”¨æ–¼å…©å€‹ç›®éŒ„çš„æ–°åŠŸèƒ½ï¼Œä¾‹å¦‚æ›´æ–°çš„ [Image å…ƒä»¶](#image-component)ã€[Link å…ƒä»¶](#link-component)ã€[Script å…ƒä»¶](#script-component) å’Œ [å­—é«”å„ªåŒ–](#font-optimization)ã€‚

### `<Image/>` å…ƒä»¶

Next.js 12 é€éè‡¨æ™‚å°å…¥ `next/future/image` å° Image å…ƒä»¶é€²è¡Œäº†æ”¹é€²ã€‚é€™äº›æ”¹é€²åŒ…æ‹¬æ¸›å°‘å®¢æˆ¶ç«¯ JavaScriptã€æ›´ç°¡å–®çš„åœ–ç‰‡æ“´å±•å’Œæ¨£å¼è¨­å®šã€æ›´å¥½çš„ç„¡éšœç¤™æ€§ä»¥åŠåŸç”Ÿç€è¦½å™¨æ‡¶åŠ è¼‰ã€‚

åœ¨ç‰ˆæœ¬ 13 ä¸­ï¼Œé€™äº›æ–°è¡Œç‚ºç¾åœ¨æ˜¯ `next/image` çš„é è¨­è¨­å®šã€‚

æœ‰å…©å€‹ç¨‹å¼ç¢¼è½‰æ›å·¥å…·å¯å”åŠ©æ‚¨é·ç§»è‡³æ–°çš„ Image å…ƒä»¶ï¼š

- [**`next-image-to-legacy-image` ç¨‹å¼ç¢¼è½‰æ›**](/docs/app/guides/upgrading/codemods#next-image-to-legacy-image)ï¼šå®‰å…¨ä¸”è‡ªå‹•åœ°å°‡ `next/image` å°å…¥é‡å‘½åç‚º `next/legacy/image`ã€‚ç¾æœ‰å…ƒä»¶å°‡ä¿æŒç›¸åŒè¡Œç‚ºã€‚
- [**`next-image-experimental` ç¨‹å¼ç¢¼è½‰æ›**](/docs/app/guides/upgrading/codemods#next-image-experimental)ï¼šå±éšªåœ°æ·»åŠ è¡Œå…§æ¨£å¼ä¸¦ç§»é™¤æœªä½¿ç”¨çš„å±¬æ€§ã€‚é€™å°‡è®Šæ›´ç¾æœ‰å…ƒä»¶çš„è¡Œç‚ºä»¥ç¬¦åˆæ–°é è¨­å€¼ã€‚ä½¿ç”¨æ­¤ç¨‹å¼ç¢¼è½‰æ›å‰ï¼Œéœ€å…ˆåŸ·è¡Œ `next-image-to-legacy-image` ç¨‹å¼ç¢¼è½‰æ›ã€‚

### `<Link>` å…ƒä»¶

[`<Link>` å…ƒä»¶](/docs/app/building-your-application/routing/linking-and-navigating#link-component) ä¸å†éœ€è¦æ‰‹å‹•æ·»åŠ  `<a>` æ¨™ç±¤ä½œç‚ºå­å…ƒç´ ã€‚æ­¤è¡Œç‚ºåœ¨ [ç‰ˆæœ¬ 12.2](https://nextjs.org/blog/next-12-2) ä¸­ä½œç‚ºå¯¦é©—æ€§é¸é …åŠ å…¥ï¼Œç¾åœ¨æˆç‚ºé è¨­è¨­å®šã€‚åœ¨ Next.js 13 ä¸­ï¼Œ`<Link>` ç¸½æ˜¯æ¸²æŸ“ `<a>` ä¸¦å…è¨±æ‚¨å°‡å±¬æ€§å‚³éçµ¦åº•å±¤æ¨™ç±¤ã€‚

ä¾‹å¦‚ï¼š

```jsx
import Link from 'next/link'

// Next.js 12: `<a>` å¿…é ˆåµŒå¥—ï¼Œå¦å‰‡æœƒè¢«æ’é™¤
<Link href="/about">
  <a>About</a>
</Link>

// Next.js 13: `<Link>` ç¸½æ˜¯æœƒåœ¨åº•å±¤æ¸²æŸ“ `<a>`
<Link href="/about">
  About
</Link>
```

è¦å°‡æ‚¨çš„é€£çµå‡ç´šè‡³ Next.js 13ï¼Œå¯ä»¥ä½¿ç”¨ [`new-link` ç¨‹å¼ç¢¼è½‰æ›](/docs/app/guides/upgrading/codemods#new-link)ã€‚

### `<Script>` å…ƒä»¶

[`next/script`](/docs/app/api-reference/components/script) çš„è¡Œç‚ºå·²æ›´æ–°ä»¥æ”¯æ´ `pages` å’Œ `app`ï¼Œä½†éœ€è¦é€²è¡Œä¸€äº›è®Šæ›´ä»¥ç¢ºä¿é †åˆ©é·ç§»ï¼š

- å°‡ä¹‹å‰åŒ…å«åœ¨ `_document.js` ä¸­çš„ä»»ä½• `beforeInteractive` è…³æœ¬ç§»è‡³æ ¹ä½ˆå±€æª”æ¡ˆ (`app/layout.tsx`)ã€‚
- å¯¦é©—æ€§çš„ `worker` ç­–ç•¥å°šä¸èƒ½åœ¨ `app` ä¸­ä½¿ç”¨ï¼Œæ¨™è¨˜æ­¤ç­–ç•¥çš„è…³æœ¬éœ€ç§»é™¤æˆ–ä¿®æ”¹ç‚ºä½¿ç”¨å…¶ä»–ç­–ç•¥ï¼ˆä¾‹å¦‚ `lazyOnload`ï¼‰ã€‚
- `onLoad`ã€`onReady` å’Œ `onError` è™•ç†ç¨‹åºåœ¨ä¼ºæœå™¨å…ƒä»¶ä¸­ä¸èµ·ä½œç”¨ï¼Œè«‹ç¢ºä¿å°‡å®ƒå€‘ç§»è‡³ [å®¢æˆ¶ç«¯å…ƒä»¶](/docs/app/getting-started/server-and-client-components) æˆ–å®Œå…¨ç§»é™¤ã€‚

### å­—é«”å„ªåŒ–

å…ˆå‰ï¼ŒNext.js é€é [è¡Œå…§å­—é«” CSS](/docs/app/api-reference/components/font) å¹«åŠ©æ‚¨å„ªåŒ–å­—é«”ã€‚ç‰ˆæœ¬ 13 å¼•å…¥äº†æ–°çš„ [`next/font`](/docs/app/api-reference/components/font) æ¨¡çµ„ï¼Œè®“æ‚¨èƒ½è‡ªè¨‚å­—é«”åŠ è¼‰é«”é©—ï¼ŒåŒæ™‚ç¢ºä¿å‡ºè‰²çš„æ•ˆèƒ½å’Œéš±ç§ã€‚`next/font` åŒæ™‚æ”¯æ´ `pages` å’Œ `app` ç›®éŒ„ã€‚

é›–ç„¶ [è¡Œå…§ CSS](/docs/app/api-reference/components/font) åœ¨ `pages` ä¸­ä»ç„¶æœ‰æ•ˆï¼Œä½†åœ¨ `app` ä¸­ä¸èµ·ä½œç”¨ã€‚æ‚¨æ‡‰æ”¹ç”¨ [`next/font`](/docs/app/api-reference/components/font)ã€‚

è«‹åƒé–± [å­—é«”å„ªåŒ–](/docs/app/api-reference/components/font) é é¢äº†è§£å¦‚ä½•ä½¿ç”¨ `next/font`ã€‚

## å¾ `pages` é·ç§»è‡³ `app`

> **ğŸ¥ è§€çœ‹å½±ç‰‡**ï¼šå­¸ç¿’å¦‚ä½•é€æ­¥æ¡ç”¨ App Router â†’ [YouTube (16 åˆ†é˜)](https://www.youtube.com/watch?v=YQMSietiFm0)ã€‚

é·ç§»è‡³ App Router å¯èƒ½æ˜¯é¦–æ¬¡ä½¿ç”¨ Next.js åŸºæ–¼ React çš„åŠŸèƒ½ï¼Œå¦‚ä¼ºæœå™¨å…ƒä»¶ã€Suspense ç­‰ã€‚çµåˆ Next.js çš„æ–°åŠŸèƒ½å¦‚ [ç‰¹æ®Šæª”æ¡ˆ](/docs/app/api-reference/file-conventions) å’Œ [ä½ˆå±€](/docs/app/api-reference/file-conventions/layout)ï¼Œé·ç§»æ„å‘³è‘—éœ€è¦å­¸ç¿’æ–°æ¦‚å¿µã€æ€ç¶­æ¨¡å‹å’Œè¡Œç‚ºè®Šæ›´ã€‚

æˆ‘å€‘å»ºè­°å°‡é·ç§»åˆ†è§£ç‚ºè¼ƒå°çš„æ­¥é©Ÿï¼Œä»¥é™ä½é€™äº›æ›´æ–°çš„ç¶œåˆè¤‡é›œæ€§ã€‚`app` ç›®éŒ„çš„è¨­è¨ˆåˆè¡·æ˜¯èˆ‡ `pages` ç›®éŒ„åŒæ™‚å·¥ä½œï¼Œå…è¨±é€é é·ç§»ã€‚

- `app` ç›®éŒ„æ”¯æ´åµŒå¥—è·¯ç”± _å’Œ_ ä½ˆå±€ã€‚[äº†è§£æ›´å¤š](/docs/app/building-your-application/routing)ã€‚
- ä½¿ç”¨åµŒå¥—è³‡æ–™å¤¾å®šç¾©è·¯ç”±ï¼Œä¸¦ä½¿ç”¨ç‰¹æ®Šçš„ `page.js` æª”æ¡ˆä½¿è·¯ç”±æ®µå…¬é–‹å¯è¨ªå•ã€‚[äº†è§£æ›´å¤š](#step-4-migrating-pages)ã€‚
- [ç‰¹æ®Šæª”æ¡ˆç´„å®š](/docs/app/api-reference/file-conventions) ç”¨æ–¼ç‚ºæ¯å€‹è·¯ç”±æ®µå»ºç«‹ UIã€‚æœ€å¸¸è¦‹çš„ç‰¹æ®Šæª”æ¡ˆæ˜¯ `page.js` å’Œ `layout.js`ã€‚
  - ä½¿ç”¨ `page.js` å®šç¾©è·¯ç”±ç‰¹æœ‰çš„ UIã€‚
  - ä½¿ç”¨ `layout.js` å®šç¾©è·¨å¤šå€‹è·¯ç”±å…±äº«çš„ UIã€‚
  - ç‰¹æ®Šæª”æ¡ˆå¯ä½¿ç”¨ `.js`ã€`.jsx` æˆ– `.tsx` å‰¯æª”åã€‚
- æ‚¨å¯ä»¥åœ¨ `app` ç›®éŒ„ä¸­ä¸¦ç½®å…¶ä»–æª”æ¡ˆï¼Œå¦‚å…ƒä»¶ã€æ¨£å¼ã€æ¸¬è©¦ç­‰ã€‚[äº†è§£æ›´å¤š](/docs/app/building-your-application/routing)ã€‚
- è³‡æ–™ç²å–å‡½æ•¸å¦‚ `getServerSideProps` å’Œ `getStaticProps` å·²è¢« `app` ä¸­çš„ [æ–° API](/docs/app/building-your-application/data-fetching) å–ä»£ã€‚`getStaticPaths` å·²è¢« [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) å–ä»£ã€‚
- `pages/_app.js` å’Œ `pages/_document.js` å·²è¢«å–®ä¸€çš„ `app/layout.js` æ ¹ä½ˆå±€å–ä»£ã€‚[äº†è§£æ›´å¤š](/docs/app/building-your-application/routing/layouts-and-templates#root-layout-required)ã€‚
- `pages/_error.js` å·²è¢«æ›´ç´°ç·»çš„ `error.js` ç‰¹æ®Šæª”æ¡ˆå–ä»£ã€‚[äº†è§£æ›´å¤š](/docs/app/building-your-application/routing/error-handling)ã€‚
- `pages/404.js` å·²è¢« [`not-found.js`](/docs/app/api-reference/file-conventions/not-found) æª”æ¡ˆå–ä»£ã€‚
- `pages/api/*` API è·¯ç”±å·²è¢« [`route.js`](/docs/app/api-reference/file-conventions/route) (è·¯ç”±è™•ç†ç¨‹åº) ç‰¹æ®Šæª”æ¡ˆå–ä»£ã€‚

### æ­¥é©Ÿ 1ï¼šå»ºç«‹ `app` ç›®éŒ„

æ›´æ–°è‡³æœ€æ–° Next.js ç‰ˆæœ¬ï¼ˆéœ€è¦ 13.4 æˆ–æ›´é«˜ï¼‰ï¼š

```bash
npm install next@latest
```

ç„¶å¾Œï¼Œåœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼ˆæˆ– `src/` ç›®éŒ„ï¼‰å»ºç«‹æ–°çš„ `app` ç›®éŒ„ã€‚

### æ­¥é©Ÿ 2ï¼šå»ºç«‹æ ¹ä½ˆå±€

åœ¨ `app` ç›®éŒ„ä¸­å»ºç«‹æ–°çš„ `app/layout.tsx` æª”æ¡ˆã€‚é€™æ˜¯ [æ ¹ä½ˆå±€](/docs/app/building-your-application/routing/layouts-and-templates#root-layout-required)ï¼Œå°‡æ‡‰ç”¨æ–¼ `app` å…§çš„æ‰€æœ‰è·¯ç”±ã€‚

```tsx filename="app/layout.tsx" switcher
export default function RootLayout({
  // ä½ˆå±€å¿…é ˆæ¥å— children å±¬æ€§ã€‚
  // é€™å°‡è¢«åµŒå¥—ä½ˆå±€æˆ–é é¢å¡«å……
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

```jsx filename="app/layout.js" switcher
export default function RootLayout({
  // ä½ˆå±€å¿…é ˆæ¥å— children å±¬æ€§ã€‚
  // é€™å°‡è¢«åµŒå¥—ä½ˆå±€æˆ–é é¢å¡«å……
  children,
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

- `app` ç›®éŒ„ **å¿…é ˆ** åŒ…å«æ ¹ä½ˆå±€ã€‚
- æ ¹ä½ˆå±€å¿…é ˆå®šç¾© `<html>` å’Œ `<body>` æ¨™ç±¤ï¼Œå› ç‚º Next.js ä¸æœƒè‡ªå‹•å»ºç«‹å®ƒå€‘ã€‚
- æ ¹ä½ˆå±€å–ä»£äº† `pages/_app.tsx` å’Œ `pages/_document.tsx` æª”æ¡ˆã€‚
- ä½ˆå±€æª”æ¡ˆå¯ä½¿ç”¨ `.js`ã€`.jsx` æˆ– `.tsx` å‰¯æª”åã€‚

è¦ç®¡ç† `<head>` HTML å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ [å…§å»ºçš„ SEO æ”¯æ´](/docs/app/getting-started/metadata-and-og-images)ï¼š

```tsx filename="app/layout.tsx" switcher
import type { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'Home',
  description: 'Welcome to Next.js',
}
```

```jsx filename="app/layout.js" switcher
export const metadata = {
  title: 'Home',
  description: 'Welcome to Next.js',
}
```

#### é·ç§» `_document.js` å’Œ `_app.js`

å¦‚æœæ‚¨æœ‰ç¾æœ‰çš„ `_app` æˆ– `_document` æª”æ¡ˆï¼Œå¯ä»¥å°‡å…¶å…§å®¹ï¼ˆä¾‹å¦‚å…¨åŸŸæ¨£å¼ï¼‰è¤‡è£½åˆ°æ ¹ä½ˆå±€ (`app/layout.tsx`)ã€‚`app/layout.tsx` ä¸­çš„æ¨£å¼ **ä¸æœƒ** æ‡‰ç”¨æ–¼ `pages/*`ã€‚æ‚¨æ‡‰ä¿ç•™ `_app`/`_document` ä»¥åœ¨é·ç§»éç¨‹ä¸­é˜²æ­¢ `pages/*` è·¯ç”±æå£ã€‚å®Œå…¨é·ç§»å¾Œï¼Œå³å¯å®‰å…¨åˆªé™¤å®ƒå€‘ã€‚

å¦‚æœæ‚¨ä½¿ç”¨ä»»ä½• React Context æä¾›è€…ï¼Œéœ€è¦å°‡å®ƒå€‘ç§»è‡³ [å®¢æˆ¶ç«¯å…ƒä»¶](/docs/app/getting-started/server-and-client-components)ã€‚

#### å°‡ `getLayout()` æ¨¡å¼é·ç§»è‡³ä½ˆå±€ï¼ˆå¯é¸ï¼‰

Next.js å»ºè­°åœ¨ `pages` ç›®éŒ„ä¸­ç‚ºé é¢å…ƒä»¶ [æ·»åŠ å±¬æ€§](/docs/pages/building-your-application/routing/pages-and-layouts#layout-pattern#per-page-layouts) ä»¥å¯¦ç¾æ¯é ä½ˆå±€ã€‚æ­¤æ¨¡å¼å¯è¢« `app` ç›®éŒ„ä¸­å° [åµŒå¥—ä½ˆå±€](/docs/app/building-your-application/routing/layouts-and-templates#layouts) çš„åŸç”Ÿæ”¯æ´å–ä»£ã€‚

<details>
  <summary>æŸ¥çœ‹å‰å¾Œç¯„ä¾‹</summary>

**ä¹‹å‰**

```jsx filename="components/DashboardLayout.js"
export default function DashboardLayout({ children }) {
  return (
    <div>
      <h2>My Dashboard</h2>
      {children}
    </div>
  )
}
```

```jsx filename="pages/dashboard/index.js"
import DashboardLayout from '../components/DashboardLayout'

export default function Page() {
  return <p>My Page</p>
}

Page.getLayout = function getLayout(page) {
  return <DashboardLayout>{page}</DashboardLayout>
}
```

**ä¹‹å¾Œ**

- å¾ `pages/dashboard/index.js` ä¸­ç§»é™¤ `Page.getLayout` å±¬æ€§ï¼Œä¸¦æŒ‰ç…§ [é·ç§»é é¢çš„æ­¥é©Ÿ](#step-4-migrating-pages) å°‡é é¢ç§»è‡³ `app` ç›®éŒ„ã€‚

  ```jsx filename="app/dashboard/page.js"
  export default function Page() {
    return <p>My Page</p>
  }
  ```

- å°‡ `DashboardLayout` çš„å…§å®¹ç§»è‡³æ–°çš„ [å®¢æˆ¶ç«¯å…ƒä»¶](/docs/app/getting-started/server-and-client-components) ä»¥ä¿ç•™ `pages` ç›®éŒ„çš„è¡Œç‚ºã€‚

  ```jsx filename="app/dashboard/DashboardLayout.js"
  'use client' // æ­¤æŒ‡ä»¤æ‡‰ä½æ–¼æª”æ¡ˆé ‚éƒ¨ï¼Œä»»ä½•å°å…¥ä¹‹å‰ã€‚

  // é€™æ˜¯å®¢æˆ¶ç«¯å…ƒä»¶
  export default function DashboardLayout({ children }) {
    return (
      <div>
        <h2>My Dashboard</h2>
        {children}
      </div>
    )
  }
  ```

- å°‡ `DashboardLayout` å°å…¥åˆ° `app` ç›®éŒ„ä¸­çš„æ–° `layout.js` æª”æ¡ˆã€‚

  ```jsx filename="app/dashboard/layout.js"
  import DashboardLayout from './DashboardLayout'

  // é€™æ˜¯ä¼ºæœå™¨å…ƒä»¶
  export default function Layout({ children }) {
    return <DashboardLayout>{children}</DashboardLayout>
  }
  ```

- æ‚¨å¯ä»¥é€æ­¥å°‡ `DashboardLayout.js` (å®¢æˆ¶ç«¯å…ƒä»¶) ä¸­çš„éäº’å‹•éƒ¨åˆ†ç§»è‡³ `layout.js` (ä¼ºæœå™¨å…ƒä»¶)ï¼Œä»¥æ¸›å°‘ç™¼é€è‡³å®¢æˆ¶ç«¯çš„å…ƒä»¶ JavaScript é‡ã€‚

</details>

### æ­¥é©Ÿ 3ï¼šé·ç§» `next/head`

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œ`next/head` React å…ƒä»¶ç”¨æ–¼ç®¡ç† `<head>` HTML å…ƒç´ ï¼Œå¦‚ `title` å’Œ `meta`ã€‚åœ¨ `app` ç›®éŒ„ä¸­ï¼Œ`next/head` è¢«æ–°çš„ [å…§å»º SEO æ”¯æ´](/docs/app/getting-started/metadata-and-og-images) å–ä»£ã€‚

**ä¹‹å‰ï¼š**

```tsx filename="pages/index.tsx" switcher
import Head from 'next/head'

export default function Page() {
  return (
    <>
      <Head>
        <title>My page title</title>
      </Head>
    </>
  )
}
```

```jsx filename="pages/index.js" switcher
import Head from 'next/head'

export default function Page() {
  return (
    <>
      <Head>
        <title>My page title</title>
      </Head>
    </>
  )
}
```

**ä¹‹å¾Œï¼š**

```tsx filename="app/page.tsx" switcher
import type { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'My Page Title',
}

export default function Page() {
  return '...'
}
```

```jsx filename="app/page.js" switcher
export const metadata = {
  title: 'My Page Title',
}

export default function Page() {
  return '...'
}
```

[æŸ¥çœ‹æ‰€æœ‰ metadata é¸é …](/docs/app/api-reference/functions/generate-metadata)ã€‚

### æ­¥é©Ÿ 4ï¼šé·ç§»é é¢

- åœ¨ [`app` ç›®éŒ„](/docs/app/building-your-application/routing) ä¸­çš„é é¢é è¨­ç‚º [ä¼ºæœå™¨å…ƒä»¶ (Server Components)](/docs/app/getting-started/server-and-client-components)ã€‚é€™èˆ‡ `pages` ç›®éŒ„ä¸åŒï¼Œå¾Œè€…çš„é é¢æ˜¯ [å®¢æˆ¶ç«¯å…ƒä»¶ (Client Components)](/docs/app/getting-started/server-and-client-components)ã€‚
- `app` ç›®éŒ„ä¸­çš„ [è³‡æ–™ç²å– (Data fetching)](/docs/app/building-your-application/data-fetching) å·²è®Šæ›´ã€‚`getServerSideProps`ã€`getStaticProps` å’Œ `getInitialProps` å·²è¢«æ›´ç°¡å–®çš„ API å–ä»£ã€‚
- `app` ç›®éŒ„ä½¿ç”¨å·¢ç‹€è³‡æ–™å¤¾ä¾†å®šç¾©è·¯ç”±ï¼Œä¸¦ä½¿ç”¨ç‰¹æ®Šçš„ `page.js` æª”æ¡ˆä¾†å…¬é–‹è·¯ç”±å€æ®µã€‚
- | `pages` ç›®éŒ„       | `app` ç›®éŒ„            | è·¯ç”±           |
  | ------------------ | --------------------- | -------------- |
  | `index.js`        | `page.js`             | `/`            |
  | `about.js`        | `about/page.js`       | `/about`       |
  | `blog/[slug].js`  | `blog/[slug]/page.js` | `/blog/post-1` |

æˆ‘å€‘å»ºè­°å°‡é é¢é·ç§»åˆ†ç‚ºå…©å€‹ä¸»è¦æ­¥é©Ÿï¼š

- æ­¥é©Ÿ 1ï¼šå°‡é è¨­åŒ¯å‡ºçš„é é¢å…ƒä»¶ç§»è‡³æ–°çš„å®¢æˆ¶ç«¯å…ƒä»¶ä¸­ã€‚
- æ­¥é©Ÿ 2ï¼šå°‡æ–°çš„å®¢æˆ¶ç«¯å…ƒä»¶åŒ¯å…¥åˆ° `app` ç›®éŒ„ä¸­çš„æ–° `page.js` æª”æ¡ˆã€‚

> **å°æç¤º**ï¼šé€™æ˜¯æœ€ç°¡å–®çš„é·ç§»è·¯å¾‘ï¼Œå› ç‚ºå®ƒçš„è¡Œç‚ºèˆ‡ `pages` ç›®éŒ„æœ€ç›¸ä¼¼ã€‚

**æ­¥é©Ÿ 1ï¼šå»ºç«‹æ–°çš„å®¢æˆ¶ç«¯å…ƒä»¶**

- åœ¨ `app` ç›®éŒ„ä¸­å»ºç«‹ä¸€å€‹æ–°çš„ç¨ç«‹æª”æ¡ˆï¼ˆä¾‹å¦‚ `app/home-page.tsx` æˆ–é¡ä¼¼æª”æ¡ˆï¼‰ï¼Œä¸¦åŒ¯å‡ºä¸€å€‹å®¢æˆ¶ç«¯å…ƒä»¶ã€‚è¦å®šç¾©å®¢æˆ¶ç«¯å…ƒä»¶ï¼Œè«‹åœ¨æª”æ¡ˆé ‚éƒ¨ï¼ˆåœ¨ä»»ä½•åŒ¯å…¥ä¹‹å‰ï¼‰æ·»åŠ  `'use client'` æŒ‡ä»¤ã€‚
  - èˆ‡ Pages Router é¡ä¼¼ï¼Œæœ‰ä¸€å€‹ [å„ªåŒ–æ­¥é©Ÿ](/docs/app/getting-started/server-and-client-components#on-the-client-first-load) å¯ä»¥åœ¨åˆå§‹é é¢è¼‰å…¥æ™‚å°‡å®¢æˆ¶ç«¯å…ƒä»¶é æ¸²æŸ“ç‚ºéœæ…‹ HTMLã€‚
- å°‡ `pages/index.js` ä¸­çš„é è¨­åŒ¯å‡ºé é¢å…ƒä»¶ç§»è‡³ `app/home-page.tsx`ã€‚

```tsx filename="app/home-page.tsx" switcher
'use client'

// é€™æ˜¯ä¸€å€‹å®¢æˆ¶ç«¯å…ƒä»¶ï¼ˆèˆ‡ `pages` ç›®éŒ„ä¸­çš„å…ƒä»¶ç›¸åŒï¼‰
// å®ƒæ¥æ”¶è³‡æ–™ä½œç‚º propsï¼Œå¯ä»¥å­˜å–ç‹€æ…‹å’Œæ•ˆæœï¼Œä¸¦ä¸”
// åœ¨åˆå§‹é é¢è¼‰å…¥æ™‚æœƒåœ¨ä¼ºæœå™¨ä¸Šé æ¸²æŸ“ã€‚
export default function HomePage({ recentPosts }) {
  return (
    <div>
      {recentPosts.map((post) => (
        <div key={post.id}>{post.title}</div>
      ))}
    </div>
  )
}
```

```jsx filename="app/home-page.js" switcher
'use client'

// é€™æ˜¯ä¸€å€‹å®¢æˆ¶ç«¯å…ƒä»¶ã€‚å®ƒæ¥æ”¶è³‡æ–™ä½œç‚º propsï¼Œ
// ä¸¦ä¸”å¯ä»¥å­˜å–ç‹€æ…‹å’Œæ•ˆæœï¼Œå°±åƒ `pages` ç›®éŒ„ä¸­çš„é é¢å…ƒä»¶ä¸€æ¨£ã€‚
export default function HomePage({ recentPosts }) {
  return (
    <div>
      {recentPosts.map((post) => (
        <div key={post.id}>{post.title}</div>
      ))}
    </div>
  )
}
```

**æ­¥é©Ÿ 2ï¼šå»ºç«‹æ–°é é¢**

- åœ¨ `app` ç›®éŒ„ä¸­å»ºç«‹ä¸€å€‹æ–°çš„ `app/page.tsx` æª”æ¡ˆã€‚é€™é è¨­æ˜¯ä¸€å€‹ä¼ºæœå™¨å…ƒä»¶ã€‚
- å°‡ `home-page.tsx` å®¢æˆ¶ç«¯å…ƒä»¶åŒ¯å…¥é é¢ã€‚
- å¦‚æœæ‚¨åœ¨ `pages/index.js` ä¸­ç²å–è³‡æ–™ï¼Œè«‹å°‡è³‡æ–™ç²å–é‚è¼¯ç›´æ¥ç§»è‡³ä¼ºæœå™¨å…ƒä»¶ä¸­ï¼Œä½¿ç”¨æ–°çš„ [è³‡æ–™ç²å– API](/docs/app/building-your-application/data-fetching/fetching)ã€‚è©³æƒ…è«‹åƒé–± [è³‡æ–™ç²å–å‡ç´šæŒ‡å—](#step-6-migrating-data-fetching-methods)ã€‚

  ```tsx filename="app/page.tsx" switcher
  // åŒ¯å…¥æ‚¨çš„å®¢æˆ¶ç«¯å…ƒä»¶
  import HomePage from './home-page'

  async function getPosts() {
    const res = await fetch('https://...')
    const posts = await res.json()
    return posts
  }

  export default async function Page() {
    // ç›´æ¥åœ¨ä¼ºæœå™¨å…ƒä»¶ä¸­ç²å–è³‡æ–™
    const recentPosts = await getPosts()
    // å°‡ç²å–çš„è³‡æ–™å‚³éçµ¦æ‚¨çš„å®¢æˆ¶ç«¯å…ƒä»¶
    return <HomePage recentPosts={recentPosts} />
  }
  ```

  ```jsx filename="app/page.js" switcher
  // åŒ¯å…¥æ‚¨çš„å®¢æˆ¶ç«¯å…ƒä»¶
  import HomePage from './home-page'

  async function getPosts() {
    const res = await fetch('https://...')
    const posts = await res.json()
    return posts
  }

  export default async function Page() {
    // ç›´æ¥åœ¨ä¼ºæœå™¨å…ƒä»¶ä¸­ç²å–è³‡æ–™
    const recentPosts = await getPosts()
    // å°‡ç²å–çš„è³‡æ–™å‚³éçµ¦æ‚¨çš„å®¢æˆ¶ç«¯å…ƒä»¶
    return <HomePage recentPosts={recentPosts} />
  }
  ```

- å¦‚æœæ‚¨çš„èˆŠé é¢ä½¿ç”¨äº† `useRouter`ï¼Œå‰‡éœ€è¦æ›´æ–°ç‚ºæ–°çš„è·¯ç”±é‰¤å­ã€‚[äº†è§£æ›´å¤š](/docs/app/api-reference/functions/use-router)ã€‚
- å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ä¸¦è¨ªå• [`http://localhost:3000`](http://localhost:3000)ã€‚æ‚¨æ‡‰è©²æœƒçœ‹åˆ°ç¾æœ‰çš„ç´¢å¼•è·¯ç”±ï¼Œç¾åœ¨æ˜¯é€é `app` ç›®éŒ„æä¾›çš„ã€‚

### æ­¥é©Ÿ 5ï¼šé·ç§»è·¯ç”±é‰¤å­

æ–°å¢äº†ä¸€å€‹æ–°çš„è·¯ç”±å™¨ä¾†æ”¯æ´ `app` ç›®éŒ„ä¸­çš„æ–°è¡Œç‚ºã€‚

åœ¨ `app` ç›®éŒ„ä¸­ï¼Œæ‚¨æ‡‰è©²ä½¿ç”¨å¾ `next/navigation` åŒ¯å…¥çš„ä¸‰å€‹æ–°é‰¤å­ï¼š[`useRouter()`](/docs/app/api-reference/functions/use-router)ã€[`usePathname()`](/docs/app/api-reference/functions/use-pathname) å’Œ [`useSearchParams()`](/docs/app/api-reference/functions/use-search-params)ã€‚

- æ–°çš„ `useRouter` é‰¤å­æ˜¯å¾ `next/navigation` åŒ¯å…¥çš„ï¼Œå…¶è¡Œç‚ºèˆ‡ `pages` ç›®éŒ„ä¸­å¾ `next/router` åŒ¯å…¥çš„ `useRouter` é‰¤å­ä¸åŒã€‚
  - [å¾ `next/router` åŒ¯å…¥çš„ `useRouter` é‰¤å­](/docs/pages/api-reference/functions/use-router) åœ¨ `app` ç›®éŒ„ä¸­ä¸å—æ”¯æ´ï¼Œä½†å¯ä»¥ç¹¼çºŒåœ¨ `pages` ç›®éŒ„ä¸­ä½¿ç”¨ã€‚
- æ–°çš„ `useRouter` ä¸æœƒè¿”å› `pathname` å­—ä¸²ã€‚è«‹æ”¹ç”¨ç¨ç«‹çš„ `usePathname` é‰¤å­ã€‚
- æ–°çš„ `useRouter` ä¸æœƒè¿”å› `query` ç‰©ä»¶ã€‚æœå°‹åƒæ•¸å’Œå‹•æ…‹è·¯ç”±åƒæ•¸ç¾åœ¨æ˜¯åˆ†é–‹çš„ã€‚è«‹æ”¹ç”¨ `useSearchParams` å’Œ `useParams` é‰¤å­ã€‚
- æ‚¨å¯ä»¥åŒæ™‚ä½¿ç”¨ `useSearchParams` å’Œ `usePathname` ä¾†ç›£è½é é¢è®Šæ›´ã€‚è©³æƒ…è«‹åƒé–± [è·¯ç”±äº‹ä»¶](/docs/app/api-reference/functions/use-router#router-events) éƒ¨åˆ†ã€‚
- é€™äº›æ–°é‰¤å­åƒ…æ”¯æ´åœ¨å®¢æˆ¶ç«¯å…ƒä»¶ä¸­ä½¿ç”¨ã€‚å®ƒå€‘ä¸èƒ½åœ¨ä¼ºæœå™¨å…ƒä»¶ä¸­ä½¿ç”¨ã€‚

```tsx filename="app/example-client-component.tsx" switcher
'use client'

import { useRouter, usePathname, useSearchParams } from 'next/navigation'

export default function ExampleClientComponent() {
  const router = useRouter()
  const pathname = usePathname()
  const searchParams = useSearchParams()

  // ...
}
```

```jsx filename="app/example-client-component.js" switcher
'use client'

import { useRouter, usePathname, useSearchParams } from 'next/navigation'

export default function ExampleClientComponent() {
  const router = useRouter()
  const pathname = usePathname()
  const searchParams = useSearchParams()

  // ...
}
```

æ­¤å¤–ï¼Œæ–°çš„ `useRouter` é‰¤å­é‚„æœ‰ä»¥ä¸‹è®Šæ›´ï¼š

- `isFallback` å·²è¢«ç§»é™¤ï¼Œå› ç‚º `fallback` å·² [è¢«å–ä»£](#replacing-fallback)ã€‚
- `locale`ã€`locales`ã€`defaultLocales`ã€`domainLocales` å€¼å·²è¢«ç§»é™¤ï¼Œå› ç‚º `app` ç›®éŒ„ä¸­ä¸å†éœ€è¦ Next.js çš„å…§å»º i18n åŠŸèƒ½ã€‚[äº†è§£æ›´å¤šé—œæ–¼ i18n](/docs/app/guides/internationalization)ã€‚
- `basePath` å·²è¢«ç§»é™¤ã€‚æ›¿ä»£æ–¹æ¡ˆä¸æœƒæ˜¯ `useRouter` çš„ä¸€éƒ¨åˆ†ã€‚ç›®å‰å°šæœªå¯¦ä½œã€‚
- `asPath` å·²è¢«ç§»é™¤ï¼Œå› ç‚ºæ–°è·¯ç”±å™¨ä¸­å·²ç§»é™¤ `as` çš„æ¦‚å¿µã€‚
- `isReady` å·²è¢«ç§»é™¤ï¼Œå› ç‚ºä¸å†éœ€è¦ã€‚åœ¨ [éœæ…‹æ¸²æŸ“ (static rendering)](/docs/app/getting-started/partial-prerendering#static-rendering) æœŸé–“ï¼Œä»»ä½•ä½¿ç”¨ [`useSearchParams()`](/docs/app/api-reference/functions/use-search-params) é‰¤å­çš„å…ƒä»¶å°‡è·³éé æ¸²æŸ“æ­¥é©Ÿï¼Œæ”¹ç‚ºåœ¨é‹è¡Œæ™‚åœ¨å®¢æˆ¶ç«¯æ¸²æŸ“ã€‚
- `route` å·²è¢«ç§»é™¤ã€‚`usePathname` æˆ– `useSelectedLayoutSegments()` æä¾›äº†æ›¿ä»£æ–¹æ¡ˆã€‚

[æŸ¥çœ‹ `useRouter()` API åƒè€ƒ](/docs/app/api-reference/functions/use-router)ã€‚

#### åœ¨ `pages` å’Œ `app` ä¹‹é–“å…±ç”¨å…ƒä»¶

ç‚ºäº†ä¿æŒå…ƒä»¶åœ¨ `pages` å’Œ `app` è·¯ç”±å™¨ä¹‹é–“çš„ç›¸å®¹æ€§ï¼Œè«‹åƒè€ƒ [å¾ `next/compat/router` åŒ¯å…¥çš„ `useRouter` é‰¤å­](/docs/pages/api-reference/functions/use-router#the-nextcompatrouter-export)ã€‚
é€™æ˜¯ `pages` ç›®éŒ„ä¸­çš„ `useRouter` é‰¤å­ï¼Œä½†æ—¨åœ¨ç”¨æ–¼åœ¨è·¯ç”±å™¨ä¹‹é–“å…±ç”¨å…ƒä»¶ã€‚ç•¶æ‚¨æº–å‚™å¥½åƒ…åœ¨ `app` è·¯ç”±å™¨ä¸­ä½¿ç”¨æ™‚ï¼Œè«‹æ›´æ–°ç‚ºæ–°çš„ [å¾ `next/navigation` åŒ¯å…¥çš„ `useRouter`](/docs/app/api-reference/functions/use-router)ã€‚

### æ­¥é©Ÿ 6ï¼šé·ç§»è³‡æ–™ç²å–æ–¹æ³•

`pages` ç›®éŒ„ä½¿ç”¨ `getServerSideProps` å’Œ `getStaticProps` ä¾†ç‚ºé é¢ç²å–è³‡æ–™ã€‚åœ¨ `app` ç›®éŒ„ä¸­ï¼Œé€™äº›èˆŠçš„è³‡æ–™ç²å–å‡½æ•¸å·²è¢«åŸºæ–¼ `fetch()` å’Œ `async` React ä¼ºæœå™¨å…ƒä»¶çš„ [æ›´ç°¡å–® API](/docs/app/building-your-application/data-fetching) å–ä»£ã€‚

```tsx filename="app/page.tsx" switcher
export default async function Page() {
  // æ­¤è«‹æ±‚æ‡‰å¿«å–ç›´åˆ°æ‰‹å‹•å¤±æ•ˆã€‚
  // é¡ä¼¼æ–¼ `getStaticProps`ã€‚
  // `force-cache` æ˜¯é è¨­å€¼ï¼Œå¯ä»¥çœç•¥ã€‚
  const staticData = await fetch(`https://...`, { cache: 'force-cache' })

  // æ­¤è«‹æ±‚æ‡‰åœ¨æ¯æ¬¡è«‹æ±‚æ™‚é‡æ–°ç²å–ã€‚
  // é¡ä¼¼æ–¼ `getServerSideProps`ã€‚
  const dynamicData = await fetch(`https://...`, { cache: 'no-store' })

  // æ­¤è«‹æ±‚æ‡‰å¿«å– 10 ç§’ã€‚
  // é¡ä¼¼æ–¼ `getStaticProps` çš„ `revalidate` é¸é …ã€‚
  const revalidatedData = await fetch(`https://...`, {
    next: { revalidate: 10 },
  })

  return <div>...</div>
}
```

```jsx filename="app/page.js" switcher
export default async function Page() {
  // æ­¤è«‹æ±‚æ‡‰å¿«å–ç›´åˆ°æ‰‹å‹•å¤±æ•ˆã€‚
  // é¡ä¼¼æ–¼ `getStaticProps`ã€‚
  // `force-cache` æ˜¯é è¨­å€¼ï¼Œå¯ä»¥çœç•¥ã€‚
  const staticData = await fetch(`https://...`, { cache: 'force-cache' })

  // æ­¤è«‹æ±‚æ‡‰åœ¨æ¯æ¬¡è«‹æ±‚æ™‚é‡æ–°ç²å–ã€‚
  // é¡ä¼¼æ–¼ `getServerSideProps`ã€‚
  const dynamicData = await fetch(`https://...`, { cache: 'no-store' })

  // æ­¤è«‹æ±‚æ‡‰å¿«å– 10 ç§’ã€‚
  // é¡ä¼¼æ–¼ `getStaticProps` çš„ `revalidate` é¸é …ã€‚
  const revalidatedData = await fetch(`https://...`, {
    next: { revalidate: 10 },
  })

  return <div>...</div>
}
```

#### ä¼ºæœå™¨ç«¯æ¸²æŸ“ (`getServerSideProps`)

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œ`getServerSideProps` ç”¨æ–¼åœ¨ä¼ºæœå™¨ä¸Šç²å–è³‡æ–™ä¸¦å°‡ props å‚³éçµ¦æª”æ¡ˆä¸­çš„é è¨­åŒ¯å‡º React å…ƒä»¶ã€‚é é¢çš„åˆå§‹ HTML å¾ä¼ºæœå™¨é æ¸²æŸ“ï¼Œç„¶å¾Œåœ¨ç€è¦½å™¨ä¸­ã€Œæ°´åˆã€(hydrating) é é¢ï¼ˆä½¿å…¶å…·æœ‰äº’å‹•æ€§ï¼‰ã€‚

```jsx filename="pages/dashboard.js"
// `pages` ç›®éŒ„

export async function getServerSideProps() {
  const res = await fetch(`https://...`)
  const projects = await res.json()

  return { props: { projects } }
}

export default function Dashboard({ projects }) {
  return (
    <ul>
      {projects.map((project) => (
        <li key={project.id}>{project.name}</li>
      ))}
    </ul>
  )
}
```

åœ¨ App Router ä¸­ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ [ä¼ºæœå™¨å…ƒä»¶ (Server Components)](/docs/app/getting-started/server-and-client-components) å°‡è³‡æ–™ç²å–é‚è¼¯æ”¾åœ¨ React å…ƒä»¶ä¸­ã€‚é€™ä½¿æˆ‘å€‘å¯ä»¥å‘å®¢æˆ¶ç«¯ç™¼é€æ›´å°‘çš„ JavaScriptï¼ŒåŒæ™‚ä¿ç•™ä¼ºæœå™¨æ¸²æŸ“çš„ HTMLã€‚

é€šéå°‡ `cache` é¸é …è¨­ç½®ç‚º `no-store`ï¼Œæˆ‘å€‘å¯ä»¥è¡¨ç¤ºç²å–çš„è³‡æ–™æ‡‰ [æ°¸ä¸å¿«å–](/docs/app/building-your-application/data-fetching/fetching)ã€‚é€™èˆ‡ `pages` ç›®éŒ„ä¸­çš„ `getServerSideProps` é¡ä¼¼ã€‚

```tsx filename="app/dashboard/page.tsx" switcher
// `app` ç›®éŒ„

// æ­¤å‡½æ•¸å¯ä»¥ä»»æ„å‘½å
async function getProjects() {
  const res = await fetch(`https://...`, { cache: 'no-store' })
  const projects = await res.json()

  return projects
}

export default async function Dashboard() {
  const projects = await getProjects()

  return (
    <ul>
      {projects.map((project) => (
        <li key={project.id}>{project.name}</li>
      ))}
    </ul>
  )
}
```

```jsx filename="app/dashboard/page.js" switcher
// `app` ç›®éŒ„

// æ­¤å‡½æ•¸å¯ä»¥ä»»æ„å‘½å
async function getProjects() {
  const res = await fetch(`https://...`, { cache: 'no-store' })
  const projects = await res.json()

  return projects
}

export default async function Dashboard() {
  const projects = await getProjects()

  return (
    <ul>
      {projects.map((project) => (
        <li key={project.id}>{project.name}</li>
      ))}
    </ul>
  )
}
```

#### å­˜å–è«‹æ±‚ç‰©ä»¶

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œæ‚¨å¯ä»¥åŸºæ–¼ Node.js HTTP API ç²å–åŸºæ–¼è«‹æ±‚çš„è³‡æ–™ã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å¾ `getServerSideProps` ç²å– `req` ç‰©ä»¶ï¼Œä¸¦ä½¿ç”¨å®ƒä¾†ç²å–è«‹æ±‚çš„ cookies å’Œ headersã€‚

```jsx filename="pages/index.js"
// `pages` ç›®éŒ„

export async function getServerSideProps({ req, query }) {
  const authHeader = req.getHeaders()['authorization'];
  const theme = req.cookies['theme'];

  return { props: { ... }}
}

export default function Page(props) {
  return ...
}
```

`app` ç›®éŒ„å…¬é–‹äº†æ–°çš„å”¯è®€å‡½æ•¸ä¾†ç²å–è«‹æ±‚è³‡æ–™ï¼š

- [`headers`](/docs/app/api-reference/functions/headers)ï¼šåŸºæ–¼ Web Headers APIï¼Œå¯ä»¥åœ¨ [ä¼ºæœå™¨å…ƒä»¶ (Server Components)](/docs/app/getting-started/server-and-client-components) ä¸­ä½¿ç”¨ä¾†ç²å–è«‹æ±‚ headersã€‚
- [`cookies`](/docs/app/api-reference/functions/cookies)ï¼šåŸºæ–¼ Web Cookies APIï¼Œå¯ä»¥åœ¨ [ä¼ºæœå™¨å…ƒä»¶ (Server Components)](/docs/app/getting-started/server-and-client-components) ä¸­ä½¿ç”¨ä¾†ç²å– cookiesã€‚

```tsx filename="app/page.tsx" switcher
// `app` ç›®éŒ„
import { cookies, headers } from 'next/headers'

async function getData() {
  const authHeader = (await headers()).get('authorization')

  return '...'
}

export default async function Page() {
  // æ‚¨å¯ä»¥ç›´æ¥åœ¨ä¼ºæœå™¨å…ƒä»¶ä¸­ä½¿ç”¨ `cookies` æˆ– `headers`ï¼Œ
  // æˆ–åœ¨è³‡æ–™ç²å–å‡½æ•¸ä¸­ä½¿ç”¨
  const theme = (await cookies()).get('theme')
  const data = await getData()
  return '...'
}
```

```jsx filename="app/page.js" switcher
// `app` ç›®éŒ„
import { cookies, headers } from 'next/headers'

async function getData() {
  const authHeader = (await headers()).get('authorization')

  return '...'
}

export default async function Page() {
  // æ‚¨å¯ä»¥ç›´æ¥åœ¨ä¼ºæœå™¨å…ƒä»¶ä¸­ä½¿ç”¨ `cookies` æˆ– `headers`ï¼Œ
  // æˆ–åœ¨è³‡æ–™ç²å–å‡½æ•¸ä¸­ä½¿ç”¨
  const theme = (await cookies()).get('theme')
  const data = await getData()
  return '...'
}
```

#### éœæ…‹ç¶²ç«™ç”Ÿæˆ (`getStaticProps`)

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œ`getStaticProps` å‡½æ•¸ç”¨æ–¼åœ¨æ§‹å»ºæ™‚é æ¸²æŸ“é é¢ã€‚æ­¤å‡½æ•¸å¯ç”¨æ–¼å¾å¤–éƒ¨ API æˆ–ç›´æ¥å¾è³‡æ–™åº«ç²å–è³‡æ–™ï¼Œä¸¦åœ¨å»ºæ§‹éç¨‹ä¸­å°‡æ­¤è³‡æ–™å‚³éçµ¦æ•´å€‹é é¢ã€‚

```jsx filename="pages/index.js"
// `pages` ç›®éŒ„

export async function getStaticProps() {
  const res = await fetch(`https://...`)
  const projects = await res.json()

  return { props: { projects } }
}

export default function Index({ projects }) {
  return projects.map((project) => <div>{project.name}</div>)
}
```

åœ¨ `app` ç›®éŒ„ä¸­ï¼Œä½¿ç”¨ [`fetch()`](/docs/app/api-reference/functions/fetch) ç²å–è³‡æ–™æ™‚ï¼Œé è¨­ç‚º `cache: 'force-cache'`ï¼Œé€™å°‡å¿«å–è«‹æ±‚è³‡æ–™ç›´åˆ°æ‰‹å‹•å¤±æ•ˆã€‚é€™èˆ‡ `pages` ç›®éŒ„ä¸­çš„ `getStaticProps` é¡ä¼¼ã€‚

```jsx filename="app/page.js"
// `app` ç›®éŒ„

// æ­¤å‡½æ•¸å¯ä»¥ä»»æ„å‘½å
async function getProjects() {
  const res = await fetch(`https://...`)
  const projects = await res.json()

  return projects
}

export default async function Index() {
  const projects = await getProjects()

  return projects.map((project) => <div>{project.name}</div>)
}
```

#### å‹•æ…‹è·¯å¾‘ (`getStaticPaths`)

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œ`getStaticPaths` å‡½å¼ç”¨æ–¼å®šç¾©åœ¨å»ºç½®æ™‚æ‡‰é å…ˆæ¸²æŸ“çš„å‹•æ…‹è·¯å¾‘ã€‚

```jsx filename="pages/posts/[id].js"
// `pages` ç›®éŒ„
import PostLayout from '@/components/post-layout'

export async function getStaticPaths() {
  return {
    paths: [{ params: { id: '1' } }, { params: { id: '2' } }],
  }
}

export async function getStaticProps({ params }) {
  const res = await fetch(`https://.../posts/${params.id}`)
  const post = await res.json()

  return { props: { post } }
}

export default function Post({ post }) {
  return <PostLayout post={post} />
}
```

åœ¨ `app` ç›®éŒ„ä¸­ï¼Œ`getStaticPaths` è¢« [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) å–ä»£ã€‚

[`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) çš„è¡Œç‚ºèˆ‡ `getStaticPaths` é¡ä¼¼ï¼Œä½†æä¾›äº†ä¸€å€‹ç°¡åŒ–çš„ API ä¾†è¿”å›è·¯ç”±åƒæ•¸ï¼Œä¸¦ä¸”å¯ä»¥åœ¨ [layouts](/docs/app/building-your-application/routing/layouts-and-templates) å…§éƒ¨ä½¿ç”¨ã€‚`generateStaticParams` çš„è¿”å›å½¢å¼æ˜¯ä¸€å€‹ç‰‡æ®µé™£åˆ—ï¼Œè€Œä¸æ˜¯åµŒå¥—çš„ `param` ç‰©ä»¶é™£åˆ—æˆ–è§£æå¾Œçš„è·¯å¾‘å­—ä¸²ã€‚

```jsx filename="app/posts/[id]/page.js"
// `app` ç›®éŒ„
import PostLayout from '@/components/post-layout'

export async function generateStaticParams() {
  return [{ id: '1' }, { id: '2' }]
}

async function getPost(params) {
  const res = await fetch(`https://.../posts/${(await params).id}`)
  const post = await res.json()

  return post
}

export default async function Post({ params }) {
  const post = await getPost(params)

  return <PostLayout post={post} />
}
```

åœ¨ `app` ç›®éŒ„çš„æ–°æ¨¡å‹ä¸­ï¼Œä½¿ç”¨ `generateStaticParams` é€™å€‹åç¨±æ¯” `getStaticPaths` æ›´åˆé©ã€‚`get` å‰ç¶´è¢«æ›´å…·æè¿°æ€§çš„ `generate` å–ä»£ï¼Œé€™åœ¨ `getStaticProps` å’Œ `getServerSideProps` ä¸å†å¿…è¦çš„æƒ…æ³ä¸‹æ›´ç‚ºè²¼åˆ‡ã€‚`Paths` å¾Œç¶´è¢« `Params` å–ä»£ï¼Œé€™å°æ–¼å…·æœ‰å¤šå€‹å‹•æ…‹ç‰‡æ®µçš„è·¯ç”±æ›´ç‚ºåˆé©ã€‚

---

#### å–ä»£ `fallback`

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œå¾ `getStaticPaths` è¿”å›çš„ `fallback` å±¬æ€§ç”¨æ–¼å®šç¾©æœªåœ¨å»ºç½®æ™‚é å…ˆæ¸²æŸ“çš„é é¢è¡Œç‚ºã€‚æ­¤å±¬æ€§å¯ä»¥è¨­ç½®ç‚º `true` ä»¥åœ¨é é¢ç”Ÿæˆæ™‚é¡¯ç¤ºå›é€€é é¢ï¼Œè¨­ç½®ç‚º `false` ä»¥é¡¯ç¤º 404 é é¢ï¼Œæˆ–è¨­ç½®ç‚º `blocking` ä»¥åœ¨è«‹æ±‚æ™‚ç”Ÿæˆé é¢ã€‚

```jsx filename="pages/posts/[id].js"
// `pages` ç›®éŒ„

export async function getStaticPaths() {
  return {
    paths: [],
    fallback: 'blocking'
  };
}

export async function getStaticProps({ params }) {
  ...
}

export default function Post({ post }) {
  return ...
}
```

åœ¨ `app` ç›®éŒ„ä¸­ï¼Œ[`config.dynamicParams` å±¬æ€§](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams) æ§åˆ¶å¦‚ä½•è™•ç† [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) ä¹‹å¤–çš„åƒæ•¸ï¼š

- **`true`**: (é è¨­å€¼) æœªåŒ…å«åœ¨ `generateStaticParams` ä¸­çš„å‹•æ…‹ç‰‡æ®µæœƒæŒ‰éœ€ç”Ÿæˆã€‚
- **`false`**: æœªåŒ…å«åœ¨ `generateStaticParams` ä¸­çš„å‹•æ…‹ç‰‡æ®µå°‡è¿”å› 404ã€‚

é€™å–ä»£äº† `pages` ç›®éŒ„ä¸­ `getStaticPaths` çš„ `fallback: true | false | 'blocking'` é¸é …ã€‚`fallback: 'blocking'` é¸é …æœªåŒ…å«åœ¨ `dynamicParams` ä¸­ï¼Œå› ç‚ºåœ¨ä¸²æµçš„æƒ…æ³ä¸‹ï¼Œ`'blocking'` å’Œ `true` ä¹‹é–“çš„å·®ç•°å¯ä»¥å¿½ç•¥ä¸è¨ˆã€‚

```jsx filename="app/posts/[id]/page.js"
// `app` ç›®éŒ„

export const dynamicParams = true;

export async function generateStaticParams() {
  return [...]
}

async function getPost(params) {
  ...
}

export default async function Post({ params }) {
  const post = await getPost(params);

  return ...
}
```

ç•¶ [`dynamicParams`](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams) è¨­ç½®ç‚º `true` (é è¨­å€¼) æ™‚ï¼Œç•¶è«‹æ±‚å°šæœªç”Ÿæˆçš„è·¯ç”±ç‰‡æ®µæ™‚ï¼Œå®ƒå°‡è¢«ä¼ºæœå™¨æ¸²æŸ“ä¸¦ç·©å­˜ã€‚

#### å¢é‡éœæ…‹å†ç”Ÿ (`getStaticProps` èˆ‡ `revalidate`)

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œ`getStaticProps` å‡½å¼å…è¨±ä½ æ·»åŠ  `revalidate` å­—æ®µï¼Œä»¥åœ¨æŒ‡å®šæ™‚é–“å¾Œè‡ªå‹•é‡æ–°ç”Ÿæˆé é¢ã€‚

```jsx filename="pages/index.js"
// `pages` ç›®éŒ„

export async function getStaticProps() {
  const res = await fetch(`https://.../posts`)
  const posts = await res.json()

  return {
    props: { posts },
    revalidate: 60,
  }
}

export default function Index({ posts }) {
  return (
    <Layout>
      <PostList posts={posts} />
    </Layout>
  )
}
```

åœ¨ `app` ç›®éŒ„ä¸­ï¼Œä½¿ç”¨ [`fetch()`](/docs/app/api-reference/functions/fetch) é€²è¡Œæ•¸æ“šç²å–æ™‚å¯ä»¥ä½¿ç”¨ `revalidate`ï¼Œé€™å°‡ç·©å­˜è«‹æ±‚æŒ‡å®šçš„ç§’æ•¸ã€‚

```jsx filename="app/page.js"
// `app` ç›®éŒ„

async function getPosts() {
  const res = await fetch(`https://.../posts`, { next: { revalidate: 60 } })
  const data = await res.json()

  return data.posts
}

export default async function PostList() {
  const posts = await getPosts()

  return posts.map((post) => <div>{post.name}</div>)
}
```

#### API è·¯ç”±

API è·¯ç”±åœ¨ `pages/api` ç›®éŒ„ä¸­ç¹¼çºŒæ­£å¸¸å·¥ä½œï¼Œç„¡éœ€ä»»ä½•æ›´æ”¹ã€‚ç„¶è€Œï¼Œå®ƒå€‘åœ¨ `app` ç›®éŒ„ä¸­è¢« [è·¯ç”±è™•ç†å™¨ (Route Handlers)](/docs/app/building-your-application/routing/route-handlers) å–ä»£ã€‚

è·¯ç”±è™•ç†å™¨å…è¨±ä½ ä½¿ç”¨ Web çš„ [Request](https://developer.mozilla.org/docs/Web/API/Request) å’Œ [Response](https://developer.mozilla.org/docs/Web/API/Response) API ç‚ºæŒ‡å®šè·¯ç”±å‰µå»ºè‡ªå®šç¾©è«‹æ±‚è™•ç†å™¨ã€‚

```ts filename="app/api/route.ts" switcher
export async function GET(request: Request) {}
```

```js filename="app/api/route.js" switcher
export async function GET(request) {}
```

> **é ˆçŸ¥**: å¦‚æœä½ ä¹‹å‰ä½¿ç”¨ API è·¯ç”±å¾å®¢æˆ¶ç«¯èª¿ç”¨å¤–éƒ¨ APIï¼Œç¾åœ¨å¯ä»¥ä½¿ç”¨ [ä¼ºæœå™¨çµ„ä»¶ (Server Components)](/docs/app/getting-started/server-and-client-components) ä¾†å®‰å…¨åœ°ç²å–æ•¸æ“šã€‚äº†è§£æ›´å¤šé—œæ–¼ [æ•¸æ“šç²å–](/docs/app/building-your-application/data-fetching/fetching) çš„å…§å®¹ã€‚

#### å–®é æ‡‰ç”¨ç¨‹å¼ (SPA)

å¦‚æœä½ åŒæ™‚å¾å–®é æ‡‰ç”¨ç¨‹å¼ (SPA) é·ç§»åˆ° Next.jsï¼Œè«‹åƒé–±æˆ‘å€‘çš„ [æ–‡æª”](/docs/app/guides/single-page-applications) ä»¥äº†è§£æ›´å¤šã€‚

### æ­¥é©Ÿ 7: æ¨£å¼

åœ¨ `pages` ç›®éŒ„ä¸­ï¼Œå…¨å±€æ¨£å¼è¡¨åƒ…é™æ–¼ `pages/_app.js`ã€‚åœ¨ `app` ç›®éŒ„ä¸­ï¼Œæ­¤é™åˆ¶å·²è¢«å–æ¶ˆã€‚å…¨å±€æ¨£å¼å¯ä»¥æ·»åŠ åˆ°ä»»ä½•å¸ƒå±€ã€é é¢æˆ–çµ„ä»¶ä¸­ã€‚

- [CSS æ¨¡çµ„](/docs/app/getting-started/css#css-modules)
- [Tailwind CSS](/docs/app/guides/tailwind-css)
- [å…¨å±€æ¨£å¼](/docs/app/getting-started/css#global-css)
- [CSS-in-JS](/docs/app/guides/css-in-js)
- [å¤–éƒ¨æ¨£å¼è¡¨](/docs/app/getting-started/css#external-stylesheets)
- [Sass](/docs/app/guides/sass)

#### Tailwind CSS

å¦‚æœä½ ä½¿ç”¨ Tailwind CSSï¼Œä½ éœ€è¦åœ¨ `tailwind.config.js` æ–‡ä»¶ä¸­æ·»åŠ  `app` ç›®éŒ„ï¼š

```js filename="tailwind.config.js"
module.exports = {
  content: [
    './app/**/*.{js,ts,jsx,tsx,mdx}', // <-- æ·»åŠ æ­¤è¡Œ
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
  ],
}
```

ä½ é‚„éœ€è¦åœ¨ `app/layout.js` æ–‡ä»¶ä¸­å°å…¥å…¨å±€æ¨£å¼ï¼š

```jsx filename="app/layout.js"
import '../styles/globals.css'

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

äº†è§£æ›´å¤šé—œæ–¼ [ä½¿ç”¨ Tailwind CSS é€²è¡Œæ¨£å¼è¨­è¨ˆ](/docs/app/guides/tailwind-css)

## åŒæ™‚ä½¿ç”¨ App Router å’Œ Pages Router

ç•¶åœ¨ä¸åŒ Next.js è·¯ç”±å™¨ä¹‹é–“å°èˆªæ™‚ï¼Œæœƒç™¼ç”Ÿç¡¬å°èˆªã€‚ä½¿ç”¨ `next/link` çš„è‡ªå‹•éˆæ¥é å–ä¸æœƒè·¨è·¯ç”±å™¨é å–ã€‚

ç›¸åï¼Œä½ å¯ä»¥ [å„ªåŒ–å°èˆª](https://vercel.com/guides/optimizing-hard-navigations) åœ¨ App Router å’Œ Pages Router ä¹‹é–“ï¼Œä»¥ä¿ç•™é å–å’Œå¿«é€Ÿçš„é é¢éæ¸¡ã€‚[äº†è§£æ›´å¤š](https://vercel.com/guides/optimizing-hard-navigations)ã€‚

## Codemods

Next.js æä¾›äº† Codemod è½‰æ›ä¾†å¹«åŠ©ä½ åœ¨åŠŸèƒ½è¢«æ£„ç”¨æ™‚å‡ç´šä»£ç¢¼åº«ã€‚è©³è¦‹ [Codemods](/docs/app/guides/upgrading/codemods)ã€‚
