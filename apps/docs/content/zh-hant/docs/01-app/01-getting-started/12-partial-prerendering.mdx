---
source-updated-at: '2025-06-01T01:10:54.000Z'
translation-updated-at: '2025-06-01T01:10:54.000Z'
title: å¦‚ä½•ä½¿ç”¨éƒ¨åˆ†é æ¸²æŸ“ (Partial Prerendering)
nav_title: éƒ¨åˆ†é æ¸²æŸ“
description: äº†è§£å¦‚ä½•é€ééƒ¨åˆ†é æ¸²æŸ“ (Partial Prerendering) çµåˆéœæ…‹èˆ‡å‹•æ…‹æ¸²æŸ“çš„å„ªå‹¢ã€‚
version: experimental
related:
  title: å¾ŒçºŒæ­¥é©Ÿ
  description: æ·±å…¥äº†è§£éƒ¨åˆ†é æ¸²æŸ“ (Partial Prerendering) çš„é…ç½®é¸é …ã€‚
  links:
    - app/api-reference/config/next-config-js/ppr
---

éƒ¨åˆ†é æ¸²æŸ“ (Partial Prerendering, PPR) æ˜¯ä¸€ç¨®æ¸²æŸ“ç­–ç•¥ï¼Œå…è¨±æ‚¨åœ¨åŒä¸€è·¯ç”±ä¸­çµåˆéœæ…‹èˆ‡å‹•æ…‹å…§å®¹ã€‚é€™èƒ½æå‡åˆå§‹é é¢æ•ˆèƒ½ï¼ŒåŒæ™‚ä»æ”¯æ´å€‹äººåŒ–çš„å‹•æ…‹è³‡æ–™ã€‚

<Image
  alt="éƒ¨åˆ†é æ¸²æŸ“çš„ç”¢å“é é¢ï¼Œé¡¯ç¤ºéœæ…‹å°è¦½åˆ—èˆ‡ç”¢å“è³‡è¨Šï¼Œä»¥åŠå‹•æ…‹è³¼ç‰©è»Šèˆ‡æ¨è–¦å•†å“"
  srcLight="/learn/light/thinking-in-ppr.png"
  srcDark="/learn/dark/thinking-in-ppr.png"
  width="1600"
  height="632"
/>

ç•¶ä½¿ç”¨è€…é€ è¨ªè·¯ç”±æ™‚ï¼š

- ä¼ºæœå™¨æœƒå‚³é€åŒ…å«éœæ…‹å…§å®¹çš„ **å¤–æ®¼ (shell)**ï¼Œç¢ºä¿å¿«é€Ÿçš„åˆå§‹è¼‰å…¥ã€‚
- å¤–æ®¼æœƒç‚ºå‹•æ…‹å…§å®¹é ç•™ **ç©ºæ´ (holes)**ï¼Œé€™äº›å…§å®¹å°‡éåŒæ­¥è¼‰å…¥ã€‚
- å‹•æ…‹ç©ºæ´æœƒ **ä¸¦è¡Œä¸²æµ (streamed in parallel)**ï¼Œæ¸›å°‘é é¢çš„æ•´é«”è¼‰å…¥æ™‚é–“ã€‚

> **ğŸ¥ è§€çœ‹å½±ç‰‡ï¼š** ç‚ºä»€éº¼éœ€è¦ PPR åŠå…¶é‹ä½œåŸç† â†’ [YouTube (10 åˆ†é˜)](https://www.youtube.com/watch?v=MTcPrTIBkpA)ã€‚

## éƒ¨åˆ†é æ¸²æŸ“å¦‚ä½•é‹ä½œï¼Ÿ

è¦ç†è§£éƒ¨åˆ†é æ¸²æŸ“ï¼Œéœ€å…ˆç†Ÿæ‚‰ Next.js æä¾›çš„æ¸²æŸ“ç­–ç•¥ã€‚

### éœæ…‹æ¸²æŸ“ (Static Rendering)

éœæ…‹æ¸²æŸ“æœƒé å…ˆç”Ÿæˆ HTML â€” ç„¡è«–æ˜¯åœ¨å»ºç½®æ™‚æˆ–é€é [é‡æ–°é©—è­‰ (revalidation)](/docs/app/guides/incremental-static-regeneration)ã€‚çµæœæœƒè¢«å¿«å–ä¸¦åœ¨æ‰€æœ‰ä½¿ç”¨è€…å’Œè«‹æ±‚é–“å…±äº«ã€‚

åœ¨éƒ¨åˆ†é æ¸²æŸ“ä¸­ï¼ŒNext.js æœƒç‚ºè·¯ç”±é å…ˆæ¸²æŸ“ä¸€å€‹ **éœæ…‹å¤–æ®¼ (static shell)**ã€‚é€™å¯åŒ…å«ç‰ˆé¢é…ç½® (layout) å’Œä»»ä½•ä¸ä¾è³´è«‹æ±‚æ™‚è³‡æ–™çš„å…ƒä»¶ã€‚

### å‹•æ…‹æ¸²æŸ“ (Dynamic Rendering)

å‹•æ…‹æ¸²æŸ“æœƒåœ¨ **è«‹æ±‚æ™‚ (request time)** ç”Ÿæˆ HTMLã€‚é€™è®“æ‚¨èƒ½æ ¹æ“šè«‹æ±‚æ™‚è³‡æ–™æä¾›å€‹äººåŒ–å…§å®¹ã€‚

å…ƒä»¶åœ¨ä»¥ä¸‹æƒ…æ³æœƒè®Šç‚ºå‹•æ…‹ï¼š

- ä½¿ç”¨ [`cookies`](/docs/app/api-reference/functions/cookies)
- ä½¿ç”¨ [`headers`](/docs/app/api-reference/functions/headers)
- ä½¿ç”¨ [`connection`](/docs/app/api-reference/functions/connection)
- ä½¿ç”¨ [`draftMode`](/docs/app/api-reference/functions/draft-mode)
- ä½¿ç”¨ [`searchParams` å±¬æ€§](/docs/app/api-reference/file-conventions/page#searchparams-optional)
- ä½¿ç”¨ [`unstable_noStore`](/docs/app/api-reference/functions/unstable_noStore)
- ä½¿ç”¨ [`fetch`](/docs/app/api-reference/functions/fetch) ä¸¦è¨­å®š `{ cache: 'no-store' }`

åœ¨éƒ¨åˆ†é æ¸²æŸ“ä¸­ï¼Œä½¿ç”¨é€™äº› API æœƒæ‹‹å‡ºç‰¹æ®Šçš„ React éŒ¯èª¤ï¼Œå‘ŠçŸ¥ Next.js è©²å…ƒä»¶ç„¡æ³•éœæ…‹æ¸²æŸ“ï¼Œå°è‡´å»ºç½®éŒ¯èª¤ã€‚æ‚¨å¯ä½¿ç”¨ [Suspense](#suspense) é‚Šç•ŒåŒ…è£å…ƒä»¶ï¼Œå»¶é²æ¸²æŸ“è‡³åŸ·è¡Œéšæ®µã€‚

### Suspense

React [Suspense](https://react.dev/reference/react/Suspense) ç”¨æ–¼å»¶é²æ‡‰ç”¨ç¨‹å¼éƒ¨åˆ†çš„æ¸²æŸ“ï¼Œç›´åˆ°æ»¿è¶³æŸäº›æ¢ä»¶ã€‚

åœ¨éƒ¨åˆ†é æ¸²æŸ“ä¸­ï¼ŒSuspense ç”¨æ–¼æ¨™è¨˜å…ƒä»¶æ¨¹ä¸­çš„ **å‹•æ…‹é‚Šç•Œ (dynamic boundaries)**ã€‚

åœ¨å»ºç½®æ™‚ï¼ŒNext.js æœƒé å…ˆæ¸²æŸ“éœæ…‹å…§å®¹å’Œ `fallback` UIã€‚å‹•æ…‹å…§å®¹æœƒ **å»¶å¾Œ (postponed)** è‡³ä½¿ç”¨è€…è«‹æ±‚è·¯ç”±æ™‚æ‰è™•ç†ã€‚

ç”¨ Suspense åŒ…è£å…ƒä»¶ä¸æœƒä½¿å…ƒä»¶æœ¬èº«è®Šç‚ºå‹•æ…‹ï¼ˆå–æ±ºæ–¼æ‚¨çš„ API ä½¿ç”¨æ–¹å¼ï¼‰ï¼Œè€Œæ˜¯å°‡ Suspense ä½œç‚ºå°è£å‹•æ…‹å…§å®¹çš„é‚Šç•Œï¼Œä¸¦å•Ÿç”¨ [ä¸²æµ (streaming)](#streaming)ã€‚

```jsx filename="app/page.js"
import { Suspense } from 'react'
import StaticComponent from './StaticComponent'
import DynamicComponent from './DynamicComponent'
import Fallback from './Fallback'

export const experimental_ppr = true

export default function Page() {
  return (
    <>
      <StaticComponent />
      <Suspense fallback={<Fallback />}>
        <DynamicComponent />
      </Suspense>
    </>
  )
}
```

### ä¸²æµ (Streaming)

ä¸²æµå°‡è·¯ç”±æ‹†åˆ†ç‚ºå¤šå€‹å€å¡Š (chunks)ï¼Œä¸¦åœ¨æº–å‚™å®Œæˆæ™‚é€æ­¥ä¸²æµè‡³å®¢æˆ¶ç«¯ã€‚é€™è®“ä½¿ç”¨è€…èƒ½ç«‹å³çœ‹åˆ°éƒ¨åˆ†é é¢å…§å®¹ï¼Œè€Œç„¡éœ€ç­‰å¾…æ•´å€‹å…§å®¹å®Œæˆæ¸²æŸ“ã€‚

<Image
  alt="åœ–è¡¨é¡¯ç¤ºå®¢æˆ¶ç«¯ä¸Šçš„éƒ¨åˆ†æ¸²æŸ“é é¢ï¼Œä»¥åŠæ­£åœ¨ä¸²æµå€å¡Šçš„è¼‰å…¥ UIã€‚"
  srcLight="/docs/light/server-rendering-with-streaming.png"
  srcDark="/docs/dark/server-rendering-with-streaming.png"
  width="1600"
  height="785"
/>

åœ¨éƒ¨åˆ†é æ¸²æŸ“ä¸­ï¼Œä»¥ Suspense åŒ…è£çš„å‹•æ…‹å…ƒä»¶æœƒå¾ä¼ºæœå™¨ä¸¦è¡Œä¸²æµã€‚

<Image
  alt="åœ–è¡¨é¡¯ç¤ºä¸²æµæœŸé–“è·¯ç”±å€æ®µçš„ä¸¦è¡ŒåŒ–ï¼Œå±•ç¤ºå€‹åˆ¥å€å¡Šçš„è³‡æ–™ç²å–ã€æ¸²æŸ“å’Œæ°´åˆ (hydration)ã€‚"
  srcLight="/docs/light/sequential-parallel-data-fetching.png"
  srcDark="/docs/dark/sequential-parallel-data-fetching.png"
  width="1600"
  height="525"
/>

ç‚ºæ¸›å°‘ç¶²è·¯é–‹éŠ·ï¼Œå®Œæ•´å›æ‡‰ â€” åŒ…å«éœæ…‹ HTML å’Œä¸²æµçš„å‹•æ…‹éƒ¨åˆ† â€” æœƒåœ¨ **å–®ä¸€ HTTP è«‹æ±‚** ä¸­å‚³é€ã€‚é€™é¿å…äº†é¡å¤–çš„å¾€è¿”ï¼Œæå‡åˆå§‹è¼‰å…¥å’Œæ•´é«”æ•ˆèƒ½ã€‚

## å•Ÿç”¨éƒ¨åˆ†é æ¸²æŸ“

æ‚¨å¯é€éåœ¨ `next.config.ts` æª”æ¡ˆä¸­æ–°å¢ [`ppr`](https://rc.nextjs.org/docs/app/api-reference/next-config-js/ppr) é¸é …ä¾†å•Ÿç”¨ PPRï¼š

```ts filename="next.config.ts" highlight={5} switcher
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  experimental: {
    ppr: 'incremental',
  },
}

export default nextConfig
```

```js filename="next.config.js" highlight={4} switcher
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    ppr: 'incremental',
  },
}
```

`'incremental'` å€¼å…è¨±æ‚¨ç‚ºç‰¹å®šè·¯ç”±æ¡ç”¨ PPRï¼š

```tsx filename="/app/dashboard/layout.tsx"
export const experimental_ppr = true

export default function Layout({ children }: { children: React.ReactNode }) {
  // ...
}
```

```jsx filename="/app/dashboard/layout.js"
export const experimental_ppr = true

export default function Layout({ children }) {
  // ...
}
```

æœªè¨­å®š `experimental_ppr` çš„è·¯ç”±é è¨­ç‚º `false`ï¼Œä¸æœƒä½¿ç”¨ PPR é€²è¡Œé æ¸²æŸ“ã€‚æ‚¨éœ€è¦ç‚ºæ¯å€‹è·¯ç”±æ˜ç¢ºå•Ÿç”¨ PPRã€‚

> **é ˆçŸ¥äº‹é …**ï¼š
>
> - `experimental_ppr` æœƒå¥—ç”¨è‡³è·¯ç”±å€æ®µçš„æ‰€æœ‰å­é …ç›®ï¼ŒåŒ…å«å·¢ç‹€ç‰ˆé¢é…ç½®å’Œé é¢ã€‚æ‚¨ç„¡éœ€åœ¨æ¯å€‹æª”æ¡ˆä¸­æ–°å¢ï¼Œåƒ…éœ€åœ¨è·¯ç”±çš„é ‚å±¤å€æ®µè¨­å®šã€‚
> - è‹¥è¦ç‚ºå­å€æ®µåœç”¨ PPRï¼Œå¯åœ¨å­å€æ®µä¸­å°‡ `experimental_ppr` è¨­ç‚º `false`ã€‚

## ç¯„ä¾‹

### å‹•æ…‹ API

ç•¶ä½¿ç”¨éœ€æª¢è¦–å‚³å…¥è«‹æ±‚çš„å‹•æ…‹ API æ™‚ï¼ŒNext.js æœƒç‚ºè·¯ç”±å•Ÿç”¨å‹•æ…‹æ¸²æŸ“ã€‚è‹¥è¦ç¹¼çºŒä½¿ç”¨ PPRï¼Œè«‹ä»¥ Suspense åŒ…è£å…ƒä»¶ã€‚ä¾‹å¦‚ï¼Œ`<User />` å…ƒä»¶å› ä½¿ç”¨ `cookies` API è€Œè®Šç‚ºå‹•æ…‹ï¼š

```jsx filename="app/user.js" switcher
import { cookies } from 'next/headers'

export async function User() {
  const session = (await cookies()).get('session')?.value
  return '...'
}
```

```tsx filename="app/user.tsx" switcher
import { cookies } from 'next/headers'

export async function User() {
  const session = (await cookies()).get('session')?.value
  return '...'
}
```

`<User />` å…ƒä»¶æœƒä»¥ä¸²æµæ–¹å¼è¼‰å…¥ï¼Œè€Œ `<Page />` å…§çš„ä»»ä½•å…¶ä»–å…§å®¹æœƒè¢«é å…ˆæ¸²æŸ“ä¸¦æˆç‚ºéœæ…‹å¤–æ®¼çš„ä¸€éƒ¨åˆ†ã€‚

```tsx filename="app/page.tsx" switcher
import { Suspense } from 'react'
import { User, AvatarSkeleton } from './user'

export const experimental_ppr = true

export default function Page() {
  return (
    <section>
      <h1>æ­¤å…§å®¹å°‡è¢«é å…ˆæ¸²æŸ“</h1>
      <Suspense fallback={<AvatarSkeleton />}>
        <User />
      </Suspense>
    </section>
  )
}
```

```jsx filename="app/page.js" switcher
import { Suspense } from 'react'
import { User, AvatarSkeleton } from './user'

export const experimental_ppr = true

export default function Page() {
  return (
    <section>
      <h1>æ­¤å…§å®¹å°‡è¢«é å…ˆæ¸²æŸ“</h1>
      <Suspense fallback={<AvatarSkeleton />}>
        <User />
      </Suspense>
    </section>
  )
}
```

### å‚³éå‹•æ…‹å±¬æ€§ (props)

å…ƒä»¶åƒ…åœ¨å­˜å–å€¼æ™‚æ‰æœƒå•Ÿç”¨å‹•æ…‹æ¸²æŸ“ã€‚ä¾‹å¦‚ï¼Œè‹¥æ‚¨å¾ `<Page />` å…ƒä»¶è®€å– `searchParams`ï¼Œå¯å°‡æ­¤å€¼ä½œç‚ºå±¬æ€§å‚³éè‡³å…¶ä»–å…ƒä»¶ï¼š

```tsx filename="app/page.tsx" switcher
import { Table, TableSkeleton } from './table'
import { Suspense } from 'react'

export default function Page({
  searchParams,
}: {
  searchParams: Promise<{ sort: string }>
}) {
  return (
    <section>
      <h1>æ­¤å…§å®¹å°‡è¢«é å…ˆæ¸²æŸ“</h1>
      <Suspense fallback={<TableSkeleton />}>
        <Table searchParams={searchParams} />
      </Suspense>
    </section>
  )
}
```

```jsx filename="app/page.js" switcher
import { Table, TableSkeleton } from './table'
import { Suspense } from 'react'

export default function Page({ searchParams }) {
  return (
    <section>
      <h1>æ­¤å…§å®¹å°‡è¢«é å…ˆæ¸²æŸ“</h1>
      <Suspense fallback={<TableSkeleton />}>
        <Table searchParams={searchParams} />
      </Suspense>
    </section>
  )
}
```

åœ¨è¡¨æ ¼å…ƒä»¶å…§éƒ¨ï¼Œå­˜å– `searchParams` çš„å€¼æœƒä½¿å…ƒä»¶è®Šç‚ºå‹•æ…‹ï¼Œè€Œé é¢å…¶ä»–éƒ¨åˆ†æœƒè¢«é å…ˆæ¸²æŸ“ã€‚

```tsx filename="app/table.tsx" switcher
export async function Table({
  searchParams,
}: {
  searchParams: Promise<{ sort: string }>
}) {
  const sort = (await searchParams).sort === 'true'
  return '...'
}
```

```jsx filename="app/table.js" switcher
export async function Table({ searchParams }) {
  const sort = (await searchParams).sort === 'true'
  return '...'
}
```