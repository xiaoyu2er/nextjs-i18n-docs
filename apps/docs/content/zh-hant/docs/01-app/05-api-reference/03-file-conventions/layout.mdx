---
source-updated-at: 2025-05-19T22:31:51.000Z
translation-updated-at: 2025-05-25T20:52:48.524Z
title: layout.js
description: 關於 layout.js 檔案的 API 參考文件。
---

`layout` 檔案用於在您的 Next.js 應用程式中定義版面配置。

```tsx filename="app/dashboard/layout.tsx" switcher
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return <section>{children}</section>
}
```

```jsx filename="app/dashboard/layout.js" switcher
export default function DashboardLayout({ children }) {
  return <section>{children}</section>
}
```

**根版面配置 (root layout)** 是根目錄 `app` 中最頂層的版面配置。它用於定義 `<html>` 和 `<body>` 標籤以及其他全域共用的使用者介面。

```tsx filename="app/layout.tsx" switcher
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

```jsx filename="app/layout.js" switcher
export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

## 參考

### 屬性

#### `children` (必填)

版面配置元件應接受並使用 `children` 屬性。在渲染過程中，`children` 將被填入該版面配置所包裝的路由區段。這些主要會是子 [Layout](/docs/app/api-reference/file-conventions/page) (如果存在) 或 [Page](/docs/app/api-reference/file-conventions/page) 的元件，但也可能是其他特殊檔案，如適用的 [Loading](/docs/app/building-your-application/routing/loading-ui-and-streaming) 或 [Error](/docs/app/building-your-application/routing/error-handling)。

#### `params` (選填)

一個解析為包含從根區段到該版面配置的 [動態路由參數 (dynamic route parameters)](/docs/app/building-your-application/routing/dynamic-routes) 物件的 Promise。

```tsx filename="app/dashboard/[team]/layout.tsx" switcher
export default async function Layout({
  params,
}: {
  params: Promise<{ team: string }>
}) {
  const { team } = await params
}
```

```jsx filename="app/dashboard/[team]/layout.js" switcher
export default async function Layout({ params }) {
  const { team } = await params
}
```

| 範例路由                      | URL            | `params`                           |
| ----------------------------- | -------------- | ---------------------------------- |
| `app/dashboard/[team]/layout.js`  | `/dashboard/1` | `Promise<{ team: '1' }>`           |
| `app/shop/[tag]/[item]/layout.js` | `/shop/1/2`    | `Promise<{ tag: '1', item: '2' }>` |
| `app/blog/[...slug]/layout.js`    | `/blog/1/2`    | `Promise<{ slug: ['1', '2'] }>`    |

- 由於 `params` 屬性是一個 Promise，您必須使用 `async/await` 或 React 的 [`use`](https://react.dev/reference/react/use) 函式來存取其值。
  - 在版本 14 及更早版本中，`params` 是同步屬性。為了向後兼容，您仍然可以在 Next.js 15 中同步存取它，但此行為將在未來被棄用。

### 根版面配置

`app` 目錄 **必須** 包含一個根 `app/layout.js`。

```tsx filename="app/layout.tsx" switcher
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html>
      <body>{children}</body>
    </html>
  )
}
```

```jsx filename="app/layout.js" switcher
export default function RootLayout({ children }) {
  return (
    <html>
      <body>{children}</body>
    </html>
  )
}
```

- 根版面配置 **必須** 定義 `<html>` 和 `<body>` 標籤。
  - 您 **不應** 手動將 `<head>` 標籤 (如 `<title>` 和 `<meta>`) 添加到根版面配置中。相反，您應該使用 [Metadata API](/docs/app/getting-started/metadata-and-og-images)，它會自動處理進階需求，如串流和去重複 `<head>` 元素。
- 您可以使用 [路由群組 (route groups)](/docs/app/building-your-application/routing/route-groups) 來建立多個根版面配置。
  - 在 **多個根版面配置之間** 導航會導致 **完整頁面重新載入** (與客戶端導航相對)。例如，從使用 `app/(shop)/layout.js` 的 `/cart` 導航到使用 `app/(marketing)/layout.js` 的 `/blog` 將導致完整頁面重新載入。這 **僅** 適用於多個根版面配置。

## 注意事項

### 如何在版面配置中存取請求物件？

您無法在版面配置中存取原始請求物件。但是，您可以透過僅限伺服器的函式存取 [`headers`](/docs/app/api-reference/functions/headers) 和 [`cookies`](/docs/app/api-reference/functions/cookies)。

[版面配置 (Layouts)](/docs/app/building-your-application/routing/layouts-and-templates#layouts) 不會重新渲染。它們可以被快取並重複使用，以避免在頁面之間導航時進行不必要的計算。透過限制版面配置存取原始請求，Next.js 可以防止在版面配置中執行可能緩慢或昂貴的使用者程式碼，這可能會對效能產生負面影響。

這種設計還確保了不同頁面間版面配置行為的一致性和可預測性，從而簡化了開發和除錯。

### 版面配置不接收 `searchParams`

與 [Pages](/docs/app/api-reference/file-conventions/page) 不同，版面配置元件 **不會** 接收 `searchParams` 屬性。這是因為共享版面配置在 [導航期間不會重新渲染](/docs/app/building-your-application/routing/linking-and-navigating#4-partial-rendering)，這可能導致導航之間的 `searchParams` 過時。

在使用客戶端導航時，Next.js 會自動僅渲染兩個路由之間共同版面配置下方的頁面部分。

例如，在以下目錄結構中，`dashboard/layout.tsx` 是 `/dashboard/settings` 和 `/dashboard/analytics` 的共同版面配置：

<Image
  alt="檔案結構顯示 dashboard 資料夾嵌套 layout.tsx 檔案，以及 settings 和 analytics 資料夾及其各自的頁面"
  srcLight="/docs/light/shared-dashboard-layout.png"
  srcDark="/docs/dark/shared-dashboard-layout.png"
  width="1600"
  height="687"
/>

當從 `/dashboard/settings` 導航到 `/dashboard/analytics` 時，`/dashboard/analytics` 中的 `page.tsx` 將在伺服器上重新渲染，而 `dashboard/layout.tsx` **不會** 重新渲染，因為它是兩個路由之間共用的 UI。

這種效能優化使得共享版面配置的頁面之間的導航更快，因為只需執行頁面的資料獲取和渲染，而不是可能包含獲取自身資料的共享版面配置的整個路由。

由於 `dashboard/layout.tsx` 不會重新渲染，版面配置伺服器元件中的 `searchParams` 屬性在導航後可能會 **過時**。

相反，請使用頁面的 [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) 屬性或在版面配置中的客戶端元件中使用 [`useSearchParams`](/docs/app/api-reference/functions/use-search-params) 鉤子，該鉤子會在客戶端上使用最新的 `searchParams` 重新渲染。

### 版面配置無法存取 `pathname`

版面配置無法存取 `pathname`。這是因為版面配置預設為伺服器元件，並且 [在客戶端導航期間不會重新渲染](/docs/app/building-your-application/routing/linking-and-navigating#4-partial-rendering)，這可能導致 `pathname` 在導航之間過時。為了防止過時，Next.js 需要重新獲取路由的所有區段，從而失去客戶端快取的優勢。

相反，您可以將依賴於 pathname 的邏輯提取到客戶端元件中，並將其導入到您的版面配置中。由於客戶端元件在導航期間會重新渲染 (但不會重新獲取)，您可以使用 Next.js 鉤子，如 [`usePathname`](https://nextjs.org/docs/app/api-reference/functions/use-pathname) 來存取當前 pathname 並防止過時。

```tsx filename="app/dashboard/layout.tsx" switcher
import { ClientComponent } from '@/app/ui/ClientComponent'

export default function Layout({ children }: { children: React.ReactNode }) {
  return (
    <>
      <ClientComponent />
      {/* 其他版面配置 UI */}
      <main>{children}</main>
    </>
  )
}
```

```jsx filename="app/dashboard/layout.js" switcher
import { ClientComponent } from '@/app/ui/ClientComponent'

export default function Layout({ children }) {
  return (
    <>
      <ClientComponent />
      {/* 其他版面配置 UI */}
      <main>{children}</main>
    </>
  )
}
```

常見的 `pathname` 模式也可以使用 [`params`](#params-optional) 屬性來實現。

有關更多資訊，請參閱 [範例](/docs/app/building-your-application/routing/layouts-and-templates#examples) 部分。

## 範例

### 根據 `params` 顯示內容

使用 [動態路由區段 (dynamic route segments)](/docs/app/building-your-application/routing/dynamic-routes)，您可以根據 `params` 屬性顯示或獲取特定內容。

```tsx filename="app/dashboard/layout.tsx" switcher
export default async function DashboardLayout({
  children,
  params,
}: {
  children: React.ReactNode
  params: Promise<{ team: string }>
}) {
  const { team } = await params

  return (
    <section>
      <header>
        <h1>Welcome to {team}'s Dashboard</h1>
      </header>
      <main>{children}</main>
    </section>
  )
}
```

```jsx filename="app/dashboard/layout.js" switcher
export default async function DashboardLayout({ children, params }) {
  const { team } = await params

  return (
    <section>
      <header>
        <h1>Welcome to {team}'s Dashboard</h1>
      </header>
      <main>{children}</main>
    </section>
  )
}
```

### 在客戶端元件中讀取 `params`

要在客戶端元件 (不能是 `async`) 中使用 `params`，您可以使用 React 的 [`use`](https://react.dev/reference/react/use) 函式來讀取 Promise：

```tsx filename="app/page.tsx" switcher
'use client'

import { use } from 'react'

export default function Page({
  params,
}: {
  params: Promise<{ slug: string }>
}) {
  const { slug } = use(params)
}
```

```js filename="app/page.js" switcher
'use client'

import { use } from 'react'

export default function Page({ params }) {
  const { slug } = use(params)
}
```

## 版本歷史

| 版本      | 變更                                                                                       |
| ------------ | --------------------------------------------------------------------------------------------- |
| `v15.0.0-RC` | `params` 現在是一個 Promise。提供了一個 [代碼修改工具 (codemod)](/docs/app/guides/upgrading/codemods#150)。 |
| `v13.0.0`    | 引入 `layout`。                                                                          |