---
source-updated-at: 2025-05-16T04:52:11.000Z
translation-updated-at: 2025-05-25T21:41:27.283Z
title: ä¼ºæœå™¨å‹•ä½œ (Server Actions)
nav_title: ä¼ºæœå™¨å‹•ä½œ (Server Actions)
description: Next.js ä¼ºæœå™¨å‹•ä½œ (Server Actions) çš„ API åƒè€ƒæ–‡ä»¶ã€‚
related:
  title: å¾ŒçºŒæ­¥é©Ÿ
  description: å¦‚éœ€æ›´å¤šå¾ŒçºŒæ“ä½œçš„ç›¸é—œè³‡è¨Šï¼Œæˆ‘å€‘å»ºè­°åƒè€ƒä»¥ä¸‹ç« ç¯€
  links:
    - app/building-your-application/data-fetching/forms-and-mutations
---

{/* TODO: æ­¤é é¢éœ€é€£çµå›åº•éƒ¨æåˆ°çš„ React æ–‡ä»¶ */}

Next.js èˆ‡ React Actions æ•´åˆï¼Œæä¾›äº†å…§å»ºçš„[ä¼ºæœå™¨è®Šæ›´ (server mutations)](/docs/app/building-your-application/data-fetching/forms-and-mutations)è§£æ±ºæ–¹æ¡ˆã€‚

## æ…£ä¾‹

æ‚¨å¯ä»¥åœ¨ Next.js å°ˆæ¡ˆä¸­å•Ÿç”¨**å¯¦é©—æ€§**çš„ `serverActions` æ¨™è¨˜ä¾†ä½¿ç”¨ä¼ºæœå™¨å‹•ä½œ (Server Actions)ã€‚

```js filename="next.config.js"
module.exports = {
  experimental: {
    serverActions: true,
  },
}
```

ä¼ºæœå™¨å‹•ä½œ (Server Actions) å¯ä»¥åœ¨ä»¥ä¸‹å…©å€‹åœ°æ–¹å®šç¾©ï¼š

- åœ¨ä½¿ç”¨å®ƒçš„å…ƒä»¶å…§éƒ¨ï¼ˆåƒ…é™ä¼ºæœå™¨å…ƒä»¶ (Server Components)ï¼‰ã€‚
- åœ¨å–®ç¨çš„æª”æ¡ˆä¸­ï¼ˆå®¢æˆ¶ç«¯èˆ‡ä¼ºæœå™¨å…ƒä»¶ (Client and Server Components)ï¼‰ï¼Œä»¥ä¾¿é‡è¤‡ä½¿ç”¨ã€‚æ‚¨å¯ä»¥åœ¨å–®ä¸€æª”æ¡ˆä¸­å®šç¾©å¤šå€‹ä¼ºæœå™¨å‹•ä½œã€‚

### ä½¿ç”¨ä¼ºæœå™¨å…ƒä»¶ (Server Components)

é€éåœ¨å‡½å¼ä¸»é«”é ‚éƒ¨åŠ ä¸Š [`"use server"`](https://react.dev/reference/react/use-server) æŒ‡ä»¤ä¾†å»ºç«‹éåŒæ­¥å‡½å¼ï¼Œå³å¯å»ºç«‹ä¼ºæœå™¨å‹•ä½œ (Server Action)ã€‚`"use server"` ç¢ºä¿æ­¤å‡½å¼åƒ…åœ¨ä¼ºæœå™¨ä¸ŠåŸ·è¡Œã€‚

æ­¤å‡½å¼æ‡‰å…·æœ‰[å¯åºåˆ—åŒ–çš„åƒæ•¸](https://developer.mozilla.org/docs/Glossary/Serialization)å’Œ[å¯åºåˆ—åŒ–çš„å›å‚³å€¼](https://developer.mozilla.org/docs/Glossary/Serialization)ã€‚

```jsx filename="app/page.js" highlight={2}
export default function ServerComponent() {
  async function myAction() {
    'use server'
    // ...
  }
}
```

### ä½¿ç”¨å®¢æˆ¶ç«¯å…ƒä»¶ (Client Components)

#### åŒ¯å…¥

åœ¨å–®ç¨çš„æª”æ¡ˆä¸­å»ºç«‹ä¼ºæœå™¨å‹•ä½œ (Server Action)ï¼Œä¸¦åœ¨æª”æ¡ˆé ‚éƒ¨åŠ ä¸Š `"use server"` æŒ‡ä»¤ã€‚ç„¶å¾Œï¼Œå°‡ä¼ºæœå™¨å‹•ä½œåŒ¯å…¥åˆ°æ‚¨çš„å®¢æˆ¶ç«¯å…ƒä»¶ (Client Component)ï¼š

```js filename="app/actions.js" highlight={1}
'use server'

export async function myAction() {
  // ...
}
```

```jsx filename="app/client-component.jsx" highlight={1}
'use client'

import { myAction } from './actions'

export default function ClientComponent() {
  return (
    <form action={myAction}>
      <button type="submit">åŠ å…¥è³¼ç‰©è»Š</button>
    </form>
  )
}
```

> **é ˆçŸ¥**ï¼šç•¶ä½¿ç”¨é ‚å±¤ `"use server"` æŒ‡ä»¤æ™‚ï¼Œä¸‹æ–¹çš„æ‰€æœ‰åŒ¯å‡ºéƒ½æœƒè¢«è¦–ç‚ºä¼ºæœå™¨å‹•ä½œ (Server Actions)ã€‚æ‚¨å¯ä»¥åœ¨å–®ä¸€æª”æ¡ˆä¸­åŒ…å«å¤šå€‹ä¼ºæœå™¨å‹•ä½œã€‚

#### å±¬æ€§ (Props)

åœ¨æŸäº›æƒ…æ³ä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°‡ä¼ºæœå™¨å‹•ä½œ (Server Action) ä½œç‚ºå±¬æ€§ (prop) å‚³éçµ¦å®¢æˆ¶ç«¯å…ƒä»¶ (Client Component)ã€‚

```jsx
<ClientComponent updateItem={updateItem} />
```

```jsx filename="app/client-component.jsx"
'use client'

export default function ClientComponent({ myAction }) {
  return (
    <form action={myAction}>
      <input type="text" name="name" />
      <button type="submit">æ›´æ–°é …ç›®</button>
    </form>
  )
}
```

### ç¶å®šåƒæ•¸

æ‚¨å¯ä»¥ä½¿ç”¨ `bind` æ–¹æ³•å°‡åƒæ•¸ç¶å®šåˆ°ä¼ºæœå™¨å‹•ä½œ (Server Action)ã€‚é€™å…è¨±æ‚¨å»ºç«‹ä¸€å€‹å·²ç¶å®šéƒ¨åˆ†åƒæ•¸çš„æ–°ä¼ºæœå™¨å‹•ä½œã€‚ç•¶æ‚¨æƒ³å‚³éé¡å¤–åƒæ•¸çµ¦ä¼ºæœå™¨å‹•ä½œæ™‚ï¼Œé€™éå¸¸æœ‰ç”¨ã€‚

```jsx filename="app/client-component.jsx" highlight={6}
'use client'

import { updateUser } from './actions'

export function UserProfile({ userId }) {
  const updateUserWithId = updateUser.bind(null, userId)

  return (
    <form action={updateUserWithId}>
      <input type="text" name="name" />
      <button type="submit">æ›´æ–°ä½¿ç”¨è€…åç¨±</button>
    </form>
  )
}
```

ç„¶å¾Œï¼Œ`updateUser` ä¼ºæœå™¨å‹•ä½œ (Server Action) å°‡å§‹çµ‚æ¥æ”¶ `userId` åƒæ•¸ï¼Œä»¥åŠè¡¨å–®è³‡æ–™ï¼š

```js filename="app/actions.js"
'use server'

export async function updateUser(userId, formData) {
  // ...
}
```

> **é ˆçŸ¥**ï¼šä¼ºæœå™¨å‹•ä½œ (Server Action) çš„ `.bind` æ–¹æ³•åœ¨ä¼ºæœå™¨å’Œå®¢æˆ¶ç«¯å…ƒä»¶ (Server and Client Components) ä¸­å‡å¯ä½¿ç”¨ã€‚å®ƒä¹Ÿæ”¯æ´[æ¼¸é€²å¢å¼· (Progressive Enhancement)](#progressive-enhancement)ã€‚

## å‘¼å«æ–¹å¼

æ‚¨å¯ä»¥é€éä»¥ä¸‹æ–¹æ³•å‘¼å«ä¼ºæœå™¨å‹•ä½œ (Server Actions)ï¼š

- ä½¿ç”¨ `action`ï¼šReact çš„ `action` å±¬æ€§å…è¨±åœ¨ `<form>` å…ƒç´ ä¸Šå‘¼å«ä¼ºæœå™¨å‹•ä½œã€‚
- ä½¿ç”¨ `formAction`ï¼šReact çš„ `formAction` å±¬æ€§å…è¨±è™•ç† `<form>` ä¸­çš„ `<button>`ã€`<input type="submit">` å’Œ `<input type="image">` å…ƒç´ ã€‚
- ä½¿ç”¨ `startTransition` è‡ªè¨‚å‘¼å«ï¼šä¸ä½¿ç”¨ `action` æˆ– `formAction`ï¼Œè€Œæ˜¯ä½¿ç”¨ `startTransition` ä¾†å‘¼å«ä¼ºæœå™¨å‹•ä½œã€‚æ­¤æ–¹æ³•**æœƒåœç”¨[æ¼¸é€²å¢å¼· (Progressive Enhancement)](#progressive-enhancement)**ã€‚

## æ¼¸é€²å¢å¼· (Progressive Enhancement)

æ¼¸é€²å¢å¼·å…è¨± `<form>` åœ¨æ²’æœ‰ JavaScript æˆ– JavaScript è¢«åœç”¨çš„æƒ…æ³ä¸‹æ­£å¸¸é‹ä½œã€‚é€™ä½¿å¾—ä½¿ç”¨è€…å³ä½¿åœ¨è¡¨å–®çš„ JavaScript å°šæœªè¼‰å…¥æˆ–è¼‰å…¥å¤±æ•—æ™‚ï¼Œä»èƒ½èˆ‡è¡¨å–®äº’å‹•ä¸¦æäº¤è³‡æ–™ã€‚

React Actionsï¼ˆä¼ºæœå™¨å’Œå®¢æˆ¶ç«¯ï¼‰æ”¯æ´æ¼¸é€²å¢å¼·ï¼Œä½¿ç”¨ä»¥ä¸‹å…©ç¨®ç­–ç•¥ä¹‹ä¸€ï¼š

- å¦‚æœç›´æ¥å°‡**ä¼ºæœå™¨å‹•ä½œ (Server Action)**å‚³éçµ¦ `<form>`ï¼Œå³ä½¿ JavaScript è¢«åœç”¨ï¼Œè¡¨å–®ä»å¯äº’å‹•ã€‚
- å¦‚æœå°‡**å®¢æˆ¶ç«¯å‹•ä½œ (Client Action)**å‚³éçµ¦ `<form>`ï¼Œè¡¨å–®ä»å¯äº’å‹•ï¼Œä½†å‹•ä½œæœƒè¢«æ”¾å…¥ä½‡åˆ—ï¼Œç›´åˆ°è¡¨å–®å®Œæˆæ°´åˆ (hydrated)ã€‚React æœƒå„ªå…ˆè™•ç†è©²å‹•ä½œï¼Œå› æ­¤å®ƒä»æœƒå¿«é€ŸåŸ·è¡Œã€‚

åœ¨é€™å…©ç¨®æƒ…æ³ä¸‹ï¼Œè¡¨å–®åœ¨æ°´åˆ (hydration) ç™¼ç”Ÿå‰å³å¯äº’å‹•ã€‚å„˜ç®¡ä¼ºæœå™¨å‹•ä½œ (Server Actions) å…·æœ‰ä¸ä¾è³´å®¢æˆ¶ç«¯ JavaScript çš„é¡å¤–å„ªå‹¢ï¼Œæ‚¨ä»ç„¶å¯ä»¥åœ¨éœ€è¦æ™‚èˆ‡å®¢æˆ¶ç«¯å‹•ä½œ (Client Actions) çµ„åˆå…¶ä»–è¡Œç‚ºï¼Œè€Œä¸çŠ§ç‰²äº’å‹•æ€§ã€‚

## å¤§å°é™åˆ¶

é è¨­æƒ…æ³ä¸‹ï¼Œå‚³é€çµ¦ä¼ºæœå™¨å‹•ä½œ (Server Action) çš„è«‹æ±‚ä¸»é«” (request body) æœ€å¤§å¤§å°ç‚º 1MBï¼Œä»¥é˜²æ­¢è§£æå¤§é‡è³‡æ–™æ™‚æ¶ˆè€—éå¤šçš„ä¼ºæœå™¨è³‡æºã€‚

ç„¶è€Œï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `serverActionsBodySizeLimit` é¸é …ä¾†é…ç½®æ­¤é™åˆ¶ã€‚å®ƒå¯ä»¥æ¥å—ä½å…ƒçµ„æ•¸æˆ–ä»»ä½• bytes æ”¯æ´çš„å­—ä¸²æ ¼å¼ï¼Œä¾‹å¦‚ `1000`ã€`'500kb'` æˆ– `'3mb'`ã€‚

```js filename="next.config.js"
module.exports = {
  experimental: {
    serverActions: true,
    serverActionsBodySizeLimit: '2mb',
  },
}
```

## å…¶ä»–è³‡æº

ä»¥ä¸‹ React API é é¢ç›®å‰æ­£åœ¨æ’°å¯«æ–‡ä»¶ä¸­ï¼š

- [`"use server"`](https://react.dev/reference/react/use-server)
- `action` (ğŸš§)
- `formAction` (ğŸš§)
- `useFormStatus` (ğŸš§)
- `useFormState` (ğŸš§)
- `useOptimistic` (ğŸš§)