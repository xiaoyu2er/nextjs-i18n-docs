---
source-updated-at: 2025-05-16T04:52:11.000Z
translation-updated-at: 2025-06-06T17:04:26.912Z
title: ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ (Server Actions and Mutations)
nav_title: ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ (Server Actions and Mutations)
description: Next.jsã§ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã‚’å‡¦ç†ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚
related:
  description: Next.jsã§ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™
  links:
    - app/api-reference/next-config-js/serverActions
---

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (Server Actions) ã¯ã€ã‚µãƒ¼ãƒãƒ¼ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹**éåŒæœŸé–¢æ•°**ã§ã™ã€‚Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚„ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã«ã€ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸¡æ–¹ã§ä½¿ç”¨ã§ãã¾ã™ã€‚

> **ğŸ¥ å‹•ç”»ã§å­¦ã¶:** ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã£ãŸãƒ•ã‚©ãƒ¼ãƒ ã¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã«ã¤ã„ã¦ â†’ [YouTube (10åˆ†)](https://youtu.be/dDpZfOQBMaU?si=cJZHlUu_jFhCzHUg)

## è¦ç´„

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯Reactã®[`"use server"`](https://react.dev/reference/react/use-server)ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§å®šç¾©ã§ãã¾ã™ã€‚ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’`async`é–¢æ•°ã®å…ˆé ­ã«è¿½åŠ ã—ã¦é–¢æ•°ã‚’ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦ãƒãƒ¼ã‚¯ã™ã‚‹ã‹ã€åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«è¿½åŠ ã—ã¦ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã™ã¹ã¦ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦ãƒãƒ¼ã‚¯ã§ãã¾ã™ã€‚

### ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³é–¢æ•°ãƒ¬ãƒ™ãƒ«ã¾ãŸã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«ã®`"use server"`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§å®šç¾©ã™ã‚‹ã«ã¯ã€é–¢æ•°æœ¬ä½“ã®å…ˆé ­ã«`"use server"`ã‚’è¿½åŠ ã—ã¾ã™:

```tsx filename="app/page.tsx" switcher
// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
export default function Page() {
  // ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  async function create() {
    'use server'

    // ...
  }

  return (
    // ...
  )
}
```

```jsx filename="app/page.jsx" switcher
// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
export default function Page() {
  // ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  async function create() {
    'use server'

    // ...
  }

  return (
    // ...
  )
}
```

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«ã®`"use server"`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½¿ç”¨ã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã™ã«ã¯ã€æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ãã®å…ˆé ­ã«`"use server"`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’è¿½åŠ ã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ã™ã¹ã¦ã®é–¢æ•°ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸¡æ–¹ã§å†åˆ©ç”¨å¯èƒ½ãªã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦ãƒãƒ¼ã‚¯ã•ã‚Œã¾ã™:

```tsx filename="app/actions.ts" switcher
'use server'

export async function create() {
  // ...
}
```

```js filename="app/actions.js" switcher
'use server'

export async function create() {
  // ...
}
```

```tsx filename="app/ui/button.tsx" switcher
import { create } from '@/app/actions'

export function Button() {
  return (
    // ...
  )
}
```

```jsx filename="app/ui/button.js" switcher
import { create } from '@/app/actions'

export function Button() {
  return (
    // ...
  )
}
```

ã¾ãŸã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ—ãƒ­ãƒƒãƒ—ã¨ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ¸¡ã™ã“ã¨ã‚‚ã§ãã¾ã™:

```jsx
<ClientComponent updateItem={updateItem} />
```

```jsx filename="app/client-component.jsx"
'use client'

export default function ClientComponent({ updateItem }) {
  return <form action={updateItem}>{/* ... */}</form>
}
```

## å‹•ä½œç‰¹æ€§

- ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯[`<form>`è¦ç´ ](#forms)ã®`action`å±æ€§ã‚’ä½¿ç”¨ã—ã¦å‘¼ã³å‡ºã›ã¾ã™:
  - ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ã‚¨ãƒ³ãƒãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€JavaScriptãŒã¾ã ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ãªã„ã‹ç„¡åŠ¹ã«ãªã£ã¦ã„ã¦ã‚‚ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ã€JavaScriptãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ãªã„å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã™ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã¯ã‚­ãƒ¥ãƒ¼ã«å…¥ã‚Œã‚‰ã‚Œã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒã‚¤ãƒ‰ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå„ªå…ˆã•ã‚Œã¾ã™ã€‚
  - ãƒã‚¤ãƒ‰ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã€ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã•ã‚Œã¾ã›ã‚“ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯`<form>`ã«é™å®šã•ã‚Œãšã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã€`useEffect`ã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ãŠã‚ˆã³`<button>`ãªã©ã®ä»–ã®ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã‹ã‚‰å‘¼ã³å‡ºã›ã¾ã™ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯Next.jsã®[ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨å†æ¤œè¨¼](/docs/app/building-your-application/caching)ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨çµ±åˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã€Next.jsã¯æ›´æ–°ã•ã‚ŒãŸUIã¨æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’å˜ä¸€ã®ã‚µãƒ¼ãƒãƒ¼ãƒ©ã‚¦ãƒ³ãƒ‰ãƒˆãƒªãƒƒãƒ—ã§è¿”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚
- å†…éƒ¨çš„ã«ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯`POST`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€ã“ã®HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿ãŒã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã›ã¾ã™ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å¼•æ•°ã¨æˆ»ã‚Šå€¤ã¯Reactã«ã‚ˆã£ã¦ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½ãªå¼•æ•°ã¨å€¤ã®ãƒªã‚¹ãƒˆã«ã¤ã„ã¦ã¯[Reactã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://react.dev/reference/react/use-server#serializable-parameters-and-return-values)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯é–¢æ•°ã§ã™ã€‚ã¤ã¾ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã©ã“ã§ã‚‚å†åˆ©ç”¨ã§ãã¾ã™ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ä½¿ç”¨ã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸ã¾ãŸã¯ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‹ã‚‰[ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ](/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes)ã‚’ç¶™æ‰¿ã—ã¾ã™ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ä½¿ç”¨ã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸ã¾ãŸã¯ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‹ã‚‰[ãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆè¨­å®š](/docs/app/api-reference/file-conventions/route-segment-config)ã‚’ç¶™æ‰¿ã—ã€`maxDuration`ãªã©ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å«ã¿ã¾ã™ã€‚

## ä¾‹

### ãƒ•ã‚©ãƒ¼ãƒ 

Reactã¯HTMLã®[`<form>`](https://developer.mozilla.org/docs/Web/HTML/Element/form)è¦ç´ ã‚’æ‹¡å¼µã—ã€`action`ãƒ—ãƒ­ãƒƒãƒ—ã§ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

ãƒ•ã‚©ãƒ¼ãƒ ã§å‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯è‡ªå‹•çš„ã«[`FormData`](https://developer.mozilla.org/docs/Web/API/FormData/FormData)ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚Šã¾ã™ã€‚Reactã®`useState`ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ã¯ãªãã€ä»£ã‚ã‚Šã«ãƒã‚¤ãƒ†ã‚£ãƒ–ã®[`FormData`ãƒ¡ã‚½ãƒƒãƒ‰](https://developer.mozilla.org/en-US/docs/Web/API/FormData#instance_methods)ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã§ãã¾ã™:

```tsx filename="app/invoices/page.tsx" switcher
export default function Page() {
  async function createInvoice(formData: FormData) {
    'use server'

    const rawFormData = {
      customerId: formData.get('customerId'),
      amount: formData.get('amount'),
      status: formData.get('status'),
    }

    // ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å†æ¤œè¨¼
  }

  return <form action={createInvoice}>...</form>
}
```

```jsx filename="app/invoices/page.jsx" switcher
export default function Page() {
  async function createInvoice(formData) {
    'use server'

    const rawFormData = {
      customerId: formData.get('customerId'),
      amount: formData.get('amount'),
      status: formData.get('status'),
    }

    // ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å†æ¤œè¨¼
  }

  return <form action={createInvoice}>...</form>
}
```

> **çŸ¥ã£ã¦ãŠãã¨ä¾¿åˆ©:**
>
> - ä¾‹: [ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚’å«ã‚€ãƒ•ã‚©ãƒ¼ãƒ ](https://github.com/vercel/next.js/tree/canary/examples/next-forms)
> - å¤šãã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã¤ãƒ•ã‚©ãƒ¼ãƒ ã‚’æ‰±ã†å ´åˆã€JavaScriptã®[`Object.fromEntries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries)ã¨[`entries()`](https://developer.mozilla.org/en-US/docs/Web/API/FormData/entries)ãƒ¡ã‚½ãƒƒãƒ‰ã®ä½¿ç”¨ã‚’æ¤œè¨ã™ã‚‹ã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚ä¾‹: `const rawFormData = Object.fromEntries(formData)`ã€‚ãŸã ã—ã€`formData`ã«ã¯è¿½åŠ ã®`$ACTION_`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå«ã¾ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
> - è©³ç´°ã¯[Reactã®`<form>`ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://react.dev/reference/react-dom/components/form#handle-form-submission-with-a-server-action)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### è¿½åŠ ã®å¼•æ•°ã‚’æ¸¡ã™

JavaScriptã®`bind`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã®å¼•æ•°ã‚’æ¸¡ã›ã¾ã™ã€‚

```tsx filename="app/client-component.tsx" highlight={6} switcher
'use client'

import { updateUser } from './actions'

export function UserProfile({ userId }: { userId: string }) {
  const updateUserWithId = updateUser.bind(null, userId)

  return (
    <form action={updateUserWithId}>
      <input type="text" name="name" />
      <button type="submit">ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’æ›´æ–°</button>
    </form>
  )
}
```

```jsx filename="app/client-component.js" highlight={6} switcher
'use client'

import { updateUser } from './actions'

export function UserProfile({ userId }) {
  const updateUserWithId = updateUser.bind(null, userId)

  return (
    <form action={updateUserWithId}>
      <input type="text" name="name" />
      <button type="submit">ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’æ›´æ–°</button>
    </form>
  )
}
```

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã«åŠ ãˆã¦`userId`å¼•æ•°ã‚’å—ã‘å–ã‚Šã¾ã™:

```js filename="app/actions.js"
'use server'

export async function updateUser(userId, formData) {
  // ...
}
```

> **çŸ¥ã£ã¦ãŠãã¨ä¾¿åˆ©:**
>
> - åˆ¥ã®æ–¹æ³•ã¨ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ å†…ã«éš ã—å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦å¼•æ•°ã‚’æ¸¡ã™ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆä¾‹: `<input type="hidden" name="userId" value={userId} />`ï¼‰ã€‚ãŸã ã—ã€å€¤ã¯ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸHTMLã®ä¸€éƒ¨ã¨ãªã‚Šã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¾ã›ã‚“ã€‚
> - `.bind`ã¯ã‚µãƒ¼ãƒãƒ¼ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸¡æ–¹ã§å‹•ä½œã—ã¾ã™ã€‚ã¾ãŸã€ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ã‚¨ãƒ³ãƒãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

#### ä¿ç•™çŠ¶æ…‹

Reactã®[`useFormStatus`](https://react.dev/reference/react-dom/hooks/useFormStatus)ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ã•ã‚Œã¦ã„ã‚‹é–“ã®ä¿ç•™çŠ¶æ…‹ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚

- `useFormStatus`ã¯ç‰¹å®šã®`<form>`ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿”ã™ãŸã‚ã€**`<form>`è¦ç´ ã®å­ã¨ã—ã¦å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ã€‚
- `useFormStatus`ã¯Reactãƒ•ãƒƒã‚¯ã§ã‚ã‚‹ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```tsx filename="app/submit-button.tsx" switcher
'use client'

import { useFormStatus } from 'react-dom'

export function SubmitButton() {
  const { pending } = useFormStatus()

  return (
    <button type="submit" disabled={pending}>
      è¿½åŠ 
    </button>
  )
}
```

```jsx filename="app/submit-button.jsx" switcher
'use client'

import { useFormStatus } from 'react-dom'

export function SubmitButton() {
  const { pending } = useFormStatus()

  return (
    <button type="submit" disabled={pending}>
      è¿½åŠ 
    </button>
  )
}
```

`<SubmitButton />`ã¯ä»»æ„ã®ãƒ•ã‚©ãƒ¼ãƒ å†…ã«ãƒã‚¹ãƒˆã§ãã¾ã™:

```tsx filename="app/page.tsx" switcher
import { SubmitButton } from '@/app/submit-button'
import { createItem } from '@/app/actions'

// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
export default async function Home() {
  return (
    <form action={createItem}>
      <input type="text" name="field-name" />
      <SubmitButton />
    </form>
  )
}
```

```jsx filename="app/page.jsx" switcher
import { SubmitButton } from '@/app/submit-button'
import { createItem } from '@/app/actions'

// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
export default async function Home() {
  return (
    <form action={createItem}>
      <input type="text" name="field-name" />
      <SubmitButton />
    </form>
  )
}
```

#### ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰æ¤œè¨¼ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

åŸºæœ¬çš„ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ãƒ•ã‚©ãƒ¼ãƒ æ¤œè¨¼ã«ã¯ã€`required`ã‚„`type="email"`ãªã©ã®HTMLæ¤œè¨¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

ã‚ˆã‚Šé«˜åº¦ãªã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰æ¤œè¨¼ã«ã¯ã€[zod](https://zod.dev/)ãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã™ã‚‹å‰ã«ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ¤œè¨¼ã§ãã¾ã™:

```tsx filename="app/actions.ts" switcher
'use server'

import { z } from 'zod'

const schema = z.object({
  email: z.string({
    invalid_type_error: 'ç„¡åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
  }),
})

export default async function createUser(formData: FormData) {
  const validatedFields = schema.safeParse({
    email: formData.get('email'),
  })

  // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ãŒç„¡åŠ¹ãªå ´åˆã¯æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³
  if (!validatedFields.success) {
    return {
      errors: validatedFields.error.flatten().fieldErrors,
    }
  }

  // ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´
}
```

```jsx filename="app/actions.js" switcher
'use server'

import { z } from 'zod'

const schema = z.object({
  email: z.string({
    invalid_type_error: 'ç„¡åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
  }),
})

export default async function createsUser(formData) {
  const validatedFields = schema.safeParse({
    email: formData.get('email'),
  })

  // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ãŒç„¡åŠ¹ãªå ´åˆã¯æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³
  if (!validatedFields.success) {
    return {
      errors: validatedFields.error.flatten().fieldErrors,
    }
  }

  // ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´
}
```

ã‚µãƒ¼ãƒãƒ¼ã§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ¤œè¨¼ã•ã‚ŒãŸã‚‰ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…ã§ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã€Reactã®[`useFormState`](https://react.dev/reference/react-dom/hooks/useFormState)ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚

- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’`useFormState`ã«æ¸¡ã™ã¨ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®é–¢æ•°ã‚·ã‚°ãƒãƒãƒ£ãŒå¤‰æ›´ã•ã‚Œã€æœ€åˆã®å¼•æ•°ã¨ã—ã¦æ–°ã—ã„`prevState`ã¾ãŸã¯`initialState`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚
- `useFormState`ã¯Reactãƒ•ãƒƒã‚¯ã§ã‚ã‚‹ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```tsx filename="app/actions.ts" switcher
'use server'

export async function createUser(prevState: any, formData: FormData) {
  // ...
  return {
    message: 'æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
  }
}
```

```jsx filename="app/actions.js" switcher
'use server'

export async function createUser(prevState, formData) {
  // ...
  return {
    message: 'æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
  }
}
```

æ¬¡ã«ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’`useFormState`ãƒ•ãƒƒã‚¯ã«æ¸¡ã—ã€è¿”ã•ã‚ŒãŸ`state`ã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚

```tsx filename="app/ui/signup.tsx" switcher
'use client'

import { useFormState } from 'react-dom'
import { createUser } from '@/app/actions'

const initialState = {
  message: '',
}

export function Signup() {
  const [state, formAction] = useFormState(createUser, initialState)

  return (
    <form action={formAction}>
      <label htmlFor="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
      <input type="text" id="email" name="email" required />
      {/* ... */}
      <p aria-live="polite" className="sr-only">
        {state?.message}
      </p>
      <button>ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—</button>
    </form>
  )
}
```

```jsx filename="app/ui/signup.js" switcher
'use client'

import { useFormState } from 'react-dom'
import { createUser } from '@/app/actions'

const initialState = {
  message: '',
}

export function Signup() {
  const [state, formAction] = useFormState(createUser, initialState)

  return (
    <form action={formAction}>
      <label htmlFor="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
      <input type="text" id="email" name="email" required />
      {/* ... */}
      <p aria-live="polite" className="sr-only">
        {state?.message}
      </p>
      <button>ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—</button>
    </form>
  )
}
```

> **çŸ¥ã£ã¦ãŠãã¨ä¾¿åˆ©:**
>
> - ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã™ã‚‹å‰ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹æ¨©é™ãŒã‚ã‚‹ã“ã¨ã‚’å¸¸ã«ç¢ºèªã—ã¦ãã ã•ã„ã€‚[èªè¨¼ã¨èªå¯](#authentication-and-authorization)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### æ¥½è¦³çš„æ›´æ–°

Reactã®[`useOptimistic`](https://react.dev/reference/react/useOptimistic)ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå®Œäº†ã™ã‚‹ã®ã‚’å¾…ãŸãšã«ã€UIã‚’æ¥½è¦³çš„ã«æ›´æ–°ã§ãã¾ã™:

```tsx filename="app/page.tsx" switcher
'use client'

import { useOptimistic } from 'react'
import { send } from './actions'

type Message = {
  message: string
}

export function Thread({ messages }: { messages: Message[] }) {
  const [optimisticMessages, addOptimisticMessage] = useOptimistic<
    Message[],
    string
  >(messages, (state, newMessage) => [...state, { message: newMessage }])

  return (
    <div>
      {optimisticMessages.map((m, k) => (
        <div key={k}>{m.message}</div>
      ))}
      <form
        action={async (formData: FormData) => {
          const message = formData.get('message')
          addOptimisticMessage(message)
          await send(message)
        }}
      >
        <input type="text" name="message" />
        <button type="submit">é€ä¿¡</button>
      </form>
    </div>
  )
}
```

```jsx filename="app/page.jsx" switcher
'use client'

import { useOptimistic } from 'react'
import { send } from './actions'

export function Thread({ messages }) {
  const [optimisticMessages, addOptimisticMessage] = useOptimistic(
    messages,
    (state, newMessage) => [...state, { message: newMessage }]
  )

  return (
    <div>
      {optimisticMessages.map((m) => (
        <div>{m.message}</div>
      ))}
      <form
        action={async (formData) => {
          const message = formData.get('message')
          addOptimisticMessage(message)
          await send(message)
        }}
      >
        <input type="text" name="message" />
        <button type="submit">é€ä¿¡</button>
      </form>
    </div>
  )
}
```

#### ãƒã‚¹ãƒˆã•ã‚ŒãŸè¦ç´ 

`<button>`ã€`<input type="submit">`ã€`<input type="image">`ãªã©ã€`<form>`å†…ã«ãƒã‚¹ãƒˆã•ã‚ŒãŸè¦ç´ ã§ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã›ã¾ã™ã€‚ã“ã‚Œã‚‰ã®è¦ç´ ã¯`formAction`ãƒ—ãƒ­ãƒƒãƒ—ã¾ãŸã¯[ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼](#event-handlers)ã‚’å—ã‘å…¥ã‚Œã¾ã™ã€‚

ã“ã‚Œã¯ã€ãƒ•ã‚©ãƒ¼ãƒ å†…ã§è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã—ãŸã„å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚ä¾‹ãˆã°ã€æŠ•ç¨¿ã‚’å…¬é–‹ã™ã‚‹ã ã‘ã§ãªãã€ä¸‹æ›¸ãã¨ã—ã¦ä¿å­˜ã™ã‚‹ãŸã‚ã®ç‰¹å®šã®`<button>`è¦ç´ ã‚’ä½œæˆã§ãã¾ã™ã€‚è©³ç´°ã¯[Reactã®`<form>`ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://react.dev/reference/react-dom/components/form#handling-multiple-submission-types)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ã‚ˆã‚‹ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡

[`requestSubmit()`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/requestSubmit)ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚’ãƒˆãƒªã‚¬ãƒ¼ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ`âŒ˜` + `Enter`ã‚’æŠ¼ã—ãŸã¨ãã«`onKeyDown`ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒªãƒƒã‚¹ãƒ³ã§ãã¾ã™:

```tsx filename="app/entry.tsx" switcher
'use client'

export function Entry() {
  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {
    if (
      (e.ctrlKey || e.metaKey) &&
      (e.key === 'Enter' || e.key === 'NumpadEnter')
    ) {
      e.preventDefault()
      e.currentTarget.form?.requestSubmit()
    }
  }

  return (
    <div>
      <textarea name="entry" rows={20} required onKeyDown={handleKeyDown} />
    </div>
  )
}
```

```jsx filename="app/entry.jsx" switcher
'use client'

export function Entry() {
  const handleKeyDown = (e) => {
    if (
      (e.ctrlKey || e.metaKey) &&
      (e.key === 'Enter' || e.key === 'NumpadEnter')
    ) {
      e.preventDefault()
      e.currentTarget.form?.requestSubmit()
    }
  }

  return (
    <div>
      <textarea name="entry" rows={20} required onKeyDown={handleKeyDown} />
    </div>
  )
}
```

ã“ã‚Œã«ã‚ˆã‚Šã€æœ€ã‚‚è¿‘ã„`<form>`ç¥–å…ˆè¦ç´ ã®é€ä¿¡ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚

### ãƒ•ã‚©ãƒ¼ãƒ ä»¥å¤–ã®è¦ç´ 

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯`<form>`è¦ç´ å†…ã§ä½¿ç”¨ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã§ã™ãŒã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚„`useEffect`ãªã©ã€ã‚³ãƒ¼ãƒ‰ã®ä»–ã®éƒ¨åˆ†ã‹ã‚‰ã‚‚å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

#### ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©

`onClick`ãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã›ã¾ã™ã€‚ä¾‹ãˆã°ã€ã„ã„ã­æ•°ã‚’å¢—ã‚„ã™å ´åˆ:

```tsx filename="app/like-button.tsx" switcher
'use client'

import { incrementLike } from './actions'
import { useState } from 'react'

export default function LikeButton({ initialLikes }: { initialLikes: number }) {
  const [likes, setLikes] = useState(initialLikes)

  return (
    <>
      <p>Total Likes: {likes}</p>
      <button
        onClick={async () => {
          const updatedLikes = await incrementLike()
          setLikes(updatedLikes)
        }}
      >
        Like
      </button>
    </>
  )
}
```

```jsx filename="app/like-button.js" switcher
'use client'

import { incrementLike } from './actions'
import { useState } from 'react'

export default function LikeButton({ initialLikes }) {
  const [likes, setLikes] = useState(initialLikes)

  return (
    <>
      <p>Total Likes: {likes}</p>
      <button
        onClick={async () => {
          const updatedLikes = await incrementLike()
          setLikes(updatedLikes)
        }}
      >
        Like
      </button>
    </>
  )
}
```

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã€[`useOptimistic`](https://react.dev/reference/react/useOptimistic)ã‚„[`useTransition`](https://react.dev/reference/react/useTransition)ãªã©ã®React APIã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œå®Œäº†å‰ã«UIã‚’æ›´æ–°ã—ãŸã‚Šã€ä¿ç•™çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã«ã‚‚ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’è¿½åŠ ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’`onChange`ã§ä¿å­˜ã™ã‚‹å ´åˆ:

```tsx filename="app/ui/edit-post.tsx"
'use client'

import { publishPost, saveDraft } from './actions'

export default function EditPost() {
  return (
    <form action={publishPost}>
      <textarea
        name="content"
        onChange={async (e) => {
          await saveDraft(e.target.value)
        }}
      />
      <button type="submit">Publish</button>
    </form>
  )
}
```

ã“ã®ã‚ˆã†ãªå ´åˆã€è¤‡æ•°ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒçŸ­æ™‚é–“ã«ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ä¸è¦ãªã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å‘¼ã³å‡ºã—ã‚’é˜²ããŸã‚ã«**ãƒ‡ãƒã‚¦ãƒ³ã‚¹**ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

#### `useEffect`

Reactã®[`useEffect`](https://react.dev/reference/react/useEffect)ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒã‚¦ãƒ³ãƒˆæ™‚ã‚„ä¾å­˜é–¢ä¿‚ã®å¤‰æ›´æ™‚ã«ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã›ã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã«ä¾å­˜ã™ã‚‹å¤‰æ›´ã‚„è‡ªå‹•çš„ã«ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚ä¾‹ãˆã°ã€ã‚¢ãƒ—ãƒªã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã®`onKeyDown`ã€ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®äº¤å·®ç›£è¦–ãƒ•ãƒƒã‚¯ã€ã¾ãŸã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆæ™‚ã®ãƒ“ãƒ¥ãƒ¼æ•°æ›´æ–°:

```tsx filename="app/view-count.tsx" switcher
'use client'

import { incrementViews } from './actions'
import { useState, useEffect } from 'react'

export default function ViewCount({ initialViews }: { initialViews: number }) {
  const [views, setViews] = useState(initialViews)

  useEffect(() => {
    const updateViews = async () => {
      const updatedViews = await incrementViews()
      setViews(updatedViews)
    }

    updateViews()
  }, [])

  return <p>Total Views: {views}</p>
}
```

```jsx filename="app/view-count.js" switcher
'use client'

import { incrementViews } from './actions'
import { useState, useEffect } from 'react'

export default function ViewCount({ initialViews }: { initialViews: number }) {
  const [views, setViews] = useState(initialViews)

  useEffect(() => {
    const updateViews = async () => {
      const updatedViews = await incrementViews()
      setViews(updatedViews)
    }

    updateViews()
  }, [])

  return <p>Total Views: {views}</p>
}
```

[`useEffect`ã®å‹•ä½œã¨æ³¨æ„ç‚¹](https://react.dev/reference/react/useEffect#caveats)ã‚’è€ƒæ…®ã—ã¦ãã ã•ã„ã€‚

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

ã‚¨ãƒ©ãƒ¼ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹ã¨ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§æœ€ã‚‚è¿‘ã„[`error.js`](/docs/app/building-your-application/routing/error-handling)ã¾ãŸã¯`<Suspense>`å¢ƒç•Œã§ã‚­ãƒ£ãƒƒãƒã•ã‚Œã¾ã™ã€‚UIã§å‡¦ç†ã™ã‚‹ãŸã‚ã«`try/catch`ã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

ä¾‹ãˆã°ã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ä½œæˆæ™‚ã®ã‚¨ãƒ©ãƒ¼ã‚’å‡¦ç†ã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™å ´åˆ:

```ts filename="app/actions.ts" switcher
'use server'

export async function createTodo(prevState: any, formData: FormData) {
  try {
    // ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´
  } catch (e) {
    throw new Error('ã‚¿ã‚¹ã‚¯ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ')
  }
}
```

```js filename="app/actions.js" switcher
'use server'

export async function createTodo(prevState, formData) {
  try {
    // ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´
  } catch (e) {
    throw new Error('ã‚¿ã‚¹ã‚¯ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ')
  }
}
```

> **çŸ¥ã£ã¦ãŠãã¨è‰¯ã„ã“ã¨:**
>
> - ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ä»¥å¤–ã«ã€`useFormState`ã§å‡¦ç†ã™ã‚‹ãŸã‚ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚[ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°](#server-side-validation-and-error-handling)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### ãƒ‡ãƒ¼ã‚¿ã®å†æ¤œè¨¼

[`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) APIã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…ã§[Next.jsã‚­ãƒ£ãƒƒã‚·ãƒ¥](/docs/app/building-your-application/caching)ã‚’å†æ¤œè¨¼ã§ãã¾ã™:

```ts filename="app/actions.ts" switcher
'use server'

import { revalidatePath } from 'next/cache'

export async function createPost() {
  try {
    // ...
  } catch (error) {
    // ...
  }

  revalidatePath('/posts')
}
```

```js filename="app/actions.js" switcher
'use server'

import { revalidatePath } from 'next/cache'

export async function createPost() {
  try {
    // ...
  } catch (error) {
    // ...
  }

  revalidatePath('/posts')
}
```

ã¾ãŸã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’ä½¿ç”¨ã—ã¦ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã«ã¯[`revalidateTag`](/docs/app/api-reference/functions/revalidateTag)ã‚’ä½¿ç”¨ã—ã¾ã™:

```ts filename="app/actions.ts" switcher
'use server'

import { revalidateTag } from 'next/cache'

export async function createPost() {
  try {
    // ...
  } catch (error) {
    // ...
  }

  revalidateTag('posts')
}
```

```js filename="app/actions.js" switcher
'use server'

import { revalidateTag } from 'next/cache'

export async function createPost() {
  try {
    // ...
  } catch (error) {
    // ...
  }

  revalidateTag('posts')
}
```

### ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Œäº†å¾Œã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ¥ã®ãƒ«ãƒ¼ãƒˆã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ãŸã„å ´åˆã€[`redirect`](/docs/app/api-reference/functions/redirect) APIã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚`redirect`ã¯`try/catch`ãƒ–ãƒ­ãƒƒã‚¯ã®å¤–ã§å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™:

```ts filename="app/actions.ts" switcher
'use server'

import { redirect } from 'next/navigation'
import { revalidateTag } from 'next/cache'

export async function createPost(id: string) {
  try {
    // ...
  } catch (error) {
    // ...
  }

  revalidateTag('posts') // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸæŠ•ç¨¿ã‚’æ›´æ–°
  redirect(`/post/${id}`) // æ–°ã—ã„æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã«ç§»å‹•
}
```

```js filename="app/actions.js" switcher
'use server'

import { redirect } from 'next/navigation'
import { revalidateTag } from 'next/cache'

export async function createPost(id) {
  try {
    // ...
  } catch (error) {
    // ...
  }

  revalidateTag('posts') // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸæŠ•ç¨¿ã‚’æ›´æ–°
  redirect(`/post/${id}`) // æ–°ã—ã„æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã«ç§»å‹•
}
```

### Cookie

[`cookies`](/docs/app/api-reference/functions/cookies) APIã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…ã§Cookieã‚’`å–å¾—`ã€`è¨­å®š`ã€`å‰Šé™¤`ã§ãã¾ã™:

```ts filename="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function exampleAction() {
  // Cookieã‚’å–å¾—
  const value = cookies().get('name')?.value

  // Cookieã‚’è¨­å®š
  cookies().set('name', 'Delba')

  // Cookieã‚’å‰Šé™¤
  cookies().delete('name')
}
```

```js filename="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function exampleAction() {
  // Cookieã‚’å–å¾—
  const value = cookies().get('name')?.value

  // Cookieã‚’è¨­å®š
  cookies().set('name', 'Delba')

  // Cookieã‚’å‰Šé™¤
  cookies().delete('name')
}
```

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ã®Cookieå‰Šé™¤ã®[è¿½åŠ ä¾‹](/docs/app/api-reference/functions/cookies#deleting-cookies)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### èªè¨¼ã¨èªå¯

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯å…¬é–‹APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦æ‰±ã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹æ¨©é™ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°:

```tsx filename="app/actions.ts"
'use server'

import { auth } from './lib'

export function addItem() {
  const { user } = auth()
  if (!user) {
    throw new Error('ã“ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãŒå¿…è¦ã§ã™')
  }

  // ...
}
```

### ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã¨æš—å·åŒ–

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã™ã‚‹ã¨ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå¤–å´ã®é–¢æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹[ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ä¾‹ãˆã°ã€`publish`ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯`publishVersion`å¤‰æ•°ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™:

```tsx filename="app/page.tsx" switcher
export default function Page() {
  const publishVersion = await getLatestVersion();

  async function publish(formData: FormData) {
    "use server";
    if (publishVersion !== await getLatestVersion()) {
      throw new Error('å…¬é–‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‹ã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ');
    }
    ...
  }

  return <button action={publish}>Publish</button>;
}
```

```jsx filename="app/page.js" switcher
export default function Page() {
  const publishVersion = await getLatestVersion();

  async function publish() {
    "use server";
    if (publishVersion !== await getLatestVersion()) {
      throw new Error('å…¬é–‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‹ã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ');
    }
    ...
  }

  return <button action={publish}>Publish</button>;
}
```

ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã¯ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆï¼ˆä¾‹ï¼š`publishVersion`ï¼‰ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¦ã€å¾Œã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã«ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

ãŸã ã—ã€ã“ã‚ŒãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã«ã¯ã€ã‚­ãƒ£ãƒ—ãƒãƒ£ã•ã‚ŒãŸå¤‰æ•°ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã•ã‚Œã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã«ã‚µãƒ¼ãƒãƒ¼ã«æˆ»ã•ã‚Œã¾ã™ã€‚æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å…¬é–‹ã•ã‚Œã‚‹ã®ã‚’é˜²ããŸã‚ã€Next.jsã¯ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£å¤‰æ•°ã‚’è‡ªå‹•çš„ã«æš—å·åŒ–ã—ã¾ã™ã€‚æ–°ã—ã„ç§˜å¯†éµã¯ã€Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ“ãƒ«ãƒ‰ã•ã‚Œã‚‹ãŸã³ã«å„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ç”Ÿæˆã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ç‰¹å®šã®ãƒ“ãƒ«ãƒ‰ã«å¯¾ã—ã¦ã®ã¿å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

> **çŸ¥ã£ã¦ãŠãã¨è‰¯ã„ã“ã¨:** æ©Ÿå¯†å€¤ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å…¬é–‹ã•ã‚Œã‚‹ã®ã‚’é˜²ããŸã‚ã«ã€æš—å·åŒ–ã ã‘ã«ä¾å­˜ã™ã‚‹ã“ã¨ã¯æ¨å¥¨ã—ã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€[Reactã®taint API](/docs/app/building-your-application/data-fetching/patterns#preventing-sensitive-data-from-being-exposed-to-the-client)ã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã•ã‚Œãªã„ã‚ˆã†ã«ç©æ¥µçš„ã«é˜²æ­¢ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### æš—å·åŒ–ã‚­ãƒ¼ã®ä¸Šæ›¸ãï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰

Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã«ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆã™ã‚‹å ´åˆã€å„ã‚µãƒ¼ãƒãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒç•°ãªã‚‹æš—å·åŒ–ã‚­ãƒ¼ã‚’æŒã¤å¯èƒ½æ€§ãŒã‚ã‚Šã€ä¸æ•´åˆãŒç”Ÿã˜ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã‚’ç·©å’Œã™ã‚‹ãŸã‚ã«ã€`process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY`ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦æš—å·åŒ–ã‚­ãƒ¼ã‚’ä¸Šæ›¸ãã§ãã¾ã™ã€‚ã“ã®å¤‰æ•°ã‚’æŒ‡å®šã™ã‚‹ã¨ã€æš—å·åŒ–ã‚­ãƒ¼ãŒãƒ“ãƒ«ãƒ‰é–“ã§æ°¸ç¶šåŒ–ã•ã‚Œã€ã™ã¹ã¦ã®ã‚µãƒ¼ãƒãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒåŒã˜ã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ã“ã‚Œã¯ã€è¤‡æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆé–“ã§ä¸€è²«ã—ãŸæš—å·åŒ–å‹•ä½œãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¨ã£ã¦é‡è¦ãªé«˜åº¦ãªä½¿ç”¨ä¾‹ã§ã™ã€‚ã‚­ãƒ¼ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ç½²åãªã©ã®æ¨™æº–çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

> **çŸ¥ã£ã¦ãŠãã¨è‰¯ã„ã“ã¨:** Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸNext.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã“ã‚Œã‚’è‡ªå‹•çš„ã«å‡¦ç†ã—ã¾ã™ã€‚

### è¨±å¯ã•ã‚ŒãŸã‚ªãƒªã‚¸ãƒ³ï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯`<form>`è¦ç´ ã§å‘¼ã³å‡ºã›ã‚‹ãŸã‚ã€[CSRFæ”»æ’ƒ](https://developer.mozilla.org/en-US/docs/Glossary/CSRF)ã«å¯¾ã—ã¦è„†å¼±ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

å†…éƒ¨çš„ã«ã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯`POST`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€ã“ã®HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿ãŒå‘¼ã³å‡ºã—ã‚’è¨±å¯ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç‰¹ã«[SameSite Cookie](https://web.dev/articles/samesite-cookies-explained)ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚ã‚‹ç¾ä»£ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ã€ã»ã¨ã‚“ã©ã®CSRFè„†å¼±æ€§ãŒé˜²æ­¢ã•ã‚Œã¾ã™ã€‚

è¿½åŠ ã®ä¿è­·ã¨ã—ã¦ã€Next.jsã®ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯[Originãƒ˜ãƒƒãƒ€ãƒ¼](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin)ã‚’[Hostãƒ˜ãƒƒãƒ€ãƒ¼](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Host)ï¼ˆã¾ãŸã¯`X-Forwarded-Host`ï¼‰ã¨æ¯”è¼ƒã—ã¾ã™ã€‚ã“ã‚Œã‚‰ãŒä¸€è‡´ã—ãªã„å ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ä¸­æ­¢ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ãã‚Œã‚’ãƒ›ã‚¹ãƒˆã™ã‚‹ãƒšãƒ¼ã‚¸ã¨åŒã˜ãƒ›ã‚¹ãƒˆã§ã®ã¿å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚„å¤šå±¤ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆã‚µãƒ¼ãƒãƒ¼APIãŒæœ¬ç•ªãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ç•°ãªã‚‹ï¼‰ã‚’ä½¿ç”¨ã™ã‚‹å¤§è¦æ¨¡ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€[`serverActions.allowedOrigins`](/docs/app/api-reference/next-config-js/serverActions)ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦å®‰å…¨ãªã‚ªãƒªã‚¸ãƒ³ã®ãƒªã‚¹ãƒˆã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ–‡å­—åˆ—ã®é…åˆ—ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚

```js filename="next.config.js"
/** @type {import('next').NextConfig} */
module.exports = {
  experimental: {
    serverActions: {
      allowedOrigins: ['my-proxy.com', '*.my-proxy.com'],
    },
  },
}
```

[ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³](https://nextjs.org/blog/security-nextjs-server-components-actions)ã«ã¤ã„ã¦è©³ã—ãå­¦ã‚“ã§ãã ã•ã„ã€‚

## è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«é–¢ã™ã‚‹è©³ç´°ã¯ã€ä»¥ä¸‹ã®Reactãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„:

- [`"use server"`](https://react.dev/reference/react/use-server)
- [`<form>`](https://react.dev/reference/react-dom/components/form)
- [`useFormStatus`](https://react.dev/reference/react-dom/hooks/useFormStatus)
- [`useFormState`](https://react.dev/reference/react-dom/hooks/useFormState)
- [`useOptimistic`](https://react.dev/reference/react/useOptimistic)
